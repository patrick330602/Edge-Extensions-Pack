;window.browser!==undefined&&function(){function a(){var a=Object.defineProperties({},{browserAction:{value:browser.browserAction,configurable:!0,enumerable:!0},contextMenus:{value:browser.contextMenus,configurable:!0,enumerable:!0},extension:{value:browser.extension,configurable:!0,enumerable:!0},i18n:{value:browser.i18n,configurable:!0,enumerable:!0},pageAction:{value:browser.pageAction,configurable:!0,enumerable:!0},pageEntities:{value:browser.pageEntities,configurable:!0,enumerable:!0},runtime:{value:browser.runtime,configurable:!0,enumerable:!0},storage:{value:browser.storage,configurable:!0,enumerable:!0},tabs:{value:browser.tabs,configurable:!0,enumerable:!0},windows:{value:browser.windows,configurable:!0,enumerable:!0},webNavigation:{value:browser.webNavigation,configurable:!0,enumerable:!0},webRequest:{value:browser.webRequest,configurable:!0,enumerable:!0}});return Object.defineProperty(window,"chrome",{value:a,configurable:!0,enumerable:!0}),a}Object.defineProperty(window,"chrome",{get:a,configurable:!0,enumerable:!0})}()
;function typeOf(a){var b=typeof a;return b==="object"&&(a?Object.prototype.toString.call(a)=="[object Array]"&&(b="array"):b="null"),b}String.isNullOrWhiteSpace=String.isNullOrWhiteSpace||function(a){return a===undefined||a===null||typeof a!="string"||a.trim().length===0},String.htmlEscape=String.htmlEscape||function(a){if(!a)return"";var b=document.createElement("span");return b.innerText=a,b.innerHTML};var Logger=function(){return"use strict",{info:function(){var a=[];for(var b=0;b<arguments.length;b++)a[b-0]=arguments[b];console&&typeOf(console.info)==="function"&&Microsoft.JS.config.logLevel&Microsoft.JS.LogLevel.Info&&console.info.apply(console,a)},warning:function(){var a=[];for(var b=0;b<arguments.length;b++)a[b-0]=arguments[b];console&&typeOf(console.warn)==="function"&&Microsoft.JS.config.logLevel&Microsoft.JS.LogLevel.Warning&&console.warn.apply(console,a)},error:function(){var a=[];for(var b=0;b<arguments.length;b++)a[b-0]=arguments[b];console&&typeOf(console.error)==="function"&&Microsoft.JS.config.logLevel&Microsoft.JS.LogLevel.Error&&console.error.apply(console,a)},assert:function(a){var b=[];for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];console&&typeOf(console.assert)==="function"&&Microsoft.JS.config.logLevel&Microsoft.JS.LogLevel.Debug&&(b.unshift(a),console.assert.apply(console,b))},debug:function(){var a=[];for(var b=0;b<arguments.length;b++)a[b-0]=arguments[b];typeOf(console.debug)==="function"&&Microsoft.JS.config.logLevel&Microsoft.JS.LogLevel.Debug&&console.debug.apply(console,a)}}}(),Microsoft;(function(a){var b;(function(b){function d(a){switch(typeOf(a)){case"object":return JSON.stringify(a);case"null":return"null";case"undefined":return"undefined";case"array":return JSON.stringify(a);default:return a.toString()}}function h(a){var b="",c=0;if(a)for(var d in a)a.hasOwnProperty(d)&&(c++&&(b+="&"),b+=encodeURIComponent(d),a[d]!=null&&(b+="="+encodeURIComponent(a[d])));return b}function i(a,b,c,d){if(d.query){var e=h(d.query);e.length>0&&(b+=(b.indexOf("?")<0?"?":"&")+e)}typeOf(d.timeoutInMs)==="number"&&(a.timeout=d.timeoutInMs),a.open(f[c],b,!0);if(d.headers)for(var g in d.headers)d.headers.hasOwnProperty(g)&&a.setRequestHeader(g,d.headers[g]);d.contentType&&a.setRequestHeader("Content-Type",d.contentType)}function j(a,b,c){c=c||{};if(a==null||b==null)return Promise.reject(new g("HTTP method or URL are not set"));if(c.timeoutInMs!=null&&c.timeoutInMs<0)return Promise.reject(new g("Cannot have a negative timeout. Set to 0 to have no timeout"));var d=new Promise(function(d,e){var h=new XMLHttpRequest;i(h,b,a,c);var j=null;a!=f.GET&&a!=f.HEAD&&(j=c.body),h.send(j),h.onload=function(){if(h.status>=200&&h.status<300){var a=h.response;if(c.parser)try{a=c.parser(h)}catch(b){e(b);return}d(a)}else e(new g(h.statusText,h.status,h))},h.onerror=function(){var a=h.statusText||"Failed to send the request";e(new g(a,h.status,h))},h.ontimeout=function(){e(new g("Timed out",-1,h))},c.token&&c.token.addListener&&c.token.addListener(h.abort.bind(h))});return d}function k(a,b){return Logger.debug("Injecting '"+b+"' into tab "+a),new Promise(function(c,d){chrome.tabs.executeScript(a,{code:b},function(a){chrome.runtime.lastError?d(chrome.runtime.lastError):c(a)})})}function l(a,b){return Logger.debug("Injecting '"+b+"' into tab "+a),new Promise(function(c,d){chrome.tabs.executeScript(a,{file:b},function(a){chrome.runtime.lastError?d(chrome.runtime.lastError):c(a)})})}function m(b,c,d){var e=0,f=a.JS.config.scriptsToInject,g=function(a,b,c){return l(b,c)},h=k(b,'window.fromLang="'+c+'";window.toLang="'+d+'";');for(var e=0;e<f.length;e++)h=h.then(g.bind(null,null,b,f[e]));return h.catch(function(a){throw Logger.error("Failed to inject one or more of the scripts into the page",a),a})}function n(a){return k(a,"window.location.reload();")}"use strict",function(a){a[a.Off=0]="Off",a[a.Error=1]="Error",a[a.Warning=2]="Warning",a[a.Info=4]="Info",a[a.Debug=8]="Debug",a[a.Assert=16]="Assert",a[a.All=4294967295]="All"}(b.LogLevel||(b.LogLevel={}));var c=b.LogLevel;b.serialize=d;var e=function(){function a(a){var b=this;this._listeners=[],this._canceled=!1,typeof a=="number"&&a>0&&setTimeout(function(){b.cancel()},a)}return Object.defineProperty(a.prototype,"isCanceled",{get:function(){return this._canceled},enumerable:!0,configurable:!0}),a.prototype.throwIfCanceled=function(){if(this._canceled===!0)throw new Error("Operation was canceled")},a.prototype.addListener=function(a){if(typeOf(a)!=="function")return;this._listeners.push(a),this._canceled&&setTimeout(a,0)},a.prototype.cancel=function(){if(this._canceled===!0)return;this._canceled=!0;for(var a=0;a<this._listeners.length;a++)try{this._listeners[a]()}catch(b){Logger.warning("Failed during cancellation callback",b)}},a}();b.CancellationTokenSource=e,function(a){a[a.GET=0]="GET",a[a.POST=1]="POST",a[a.HEAD=2]="HEAD",a[a.PUT=3]="PUT",a[a.DELETE=4]="DELETE"}(b.HttpMethod||(b.HttpMethod={}));var f=b.HttpMethod,g=function(){function a(a,b,c){b===void 0&&(b=0),c===void 0&&(c=null),this.message=a,this.status=b,this.details=c}return Object.defineProperty(a.prototype,"isBadRequest",{get:function(){return this.status!=null&&this.status>=400&&this.status<500},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isServerError",{get:function(){return this.status!=null&&this.status>=500&&this.status<600},enumerable:!0,configurable:!0}),a}();b.HttpError=g,b.toQueryString=h,b.AjaxPromise=j,b.injectScript=l,b.injectTranslatorScripts=m,b.injectDisableTranslatorScripts=n})(b=a.JS||(a.JS={}))})(Microsoft||(Microsoft={}))
;var Microsoft;(function(a){var b;(function(a){function c(a,b,c){return new Promise(function(d,e){var f={command:a,options:b,context:c};chrome.runtime.sendMessage(f,function(b){if(chrome.runtime.lastError){var c={command:a,success:!1,response:chrome.runtime.lastError};e(c)}else b&&b.success!==!0?e(b):d(b)})})}"use strict",function(a){a[a.EnableTranslation=0]="EnableTranslation",a[a.DisableTranslation=1]="DisableTranslation"}(a.MessageCommand||(a.MessageCommand={}));var b=a.MessageCommand;a.MessageClient={enableTranslation:function(a,d,e){return c(b.EnableTranslation,{tabId:a,langCode:d},e)},disableTranslation:function(a,d){return c(b.DisableTranslation,{tabId:a},d)}};var d=function(){function a(){this._listeners={},this._eventReceiver=this._receiveMessage.bind(this),chrome.runtime.onMessage.addListener(this._eventReceiver)}return a.prototype.register=function(a,c){var d=this._listeners[b[a]];return d==null&&(d=[],this._listeners[b[a]]=d),d.push(c),this},a.prototype.dispose=function(){chrome.runtime.onMessage.removeListener(this._eventReceiver)},a.prototype._receiveMessage=function(a,c,d){try{var e=a.options&&typeOf(a.options.tabId)==="number"?a.options.tabId:c.tab.id,f=this._listeners[b[a.command]];if(f)for(var g=0;g<f.length;g++)f[g](e,a.options);d({command:a.command,success:!0,response:null})}catch(h){Logger.error("Failed to handle received message",{commmand:a.command,error:h}),d({command:a.command,success:!1,response:h})}},a}();a.MessageServer=d})(b=a.JS||(a.JS={}))})(Microsoft||(Microsoft={}))
;function getUiTextLang(){return Microsoft.JS.TextLanguage.normalizeCode(window.navigator.language)||"en"}var Microsoft;(function(a){var b;(function(a){function d(b,c){var d;try{d=JSON.parse(b.responseText)}catch(e){throw new a.HttpError(b.responseText)}if(typeOf(d)!==c)throw new a.HttpError(a.serialize(d));return d}"use strict";var b={ar:!0,he:!0,fa:!0,ur:!0},c=function(){function a(b,c){this.name=c,this.code=a.normalizeCode(b)}return Object.defineProperty(a.prototype,"isRtl",{get:function(){return this.code&&b.hasOwnProperty(this.code)},enumerable:!0,configurable:!0}),a.prototype.toString=function(){return this.code+": "+this.name},a.isRtl=function(c){return c=a.normalizeCode(c),c&&b.hasOwnProperty(c.toLowerCase())},a.equals=function(a,b){return a!=null&&b!=null&&a.code===b.code},a.normalizeCode=function(a){var b="",c="",d="";if(typeOf(a)==="string"){var e=a.split("-");b=e[0].toLowerCase();for(var f=1;f<e.length&&!d&&!c;f++)e[f].length===2?(c=e[f].toUpperCase(),b==="zh"&&c==="CN"?d="Hans":b=="zh"&&c==="TW"&&(d="Hant")):e[f].length===3&&!c?e[f].toUpperCase()==="CHS"?d="Hans":e[f]==="CHT"&&(d="Hant"):e[f].length===4&&!c&&(d=e[f][0].toUpperCase()+e[f].substring(1).toLowerCase())}b==="nb"&&(b="no");var g=b;return d&&(g+="-"+d),g},a}();a.TextLanguage=c;var e="text_lang_last_sync",f="text_langs_"+getUiTextLang(),g=function(){function b(b,c,d){this._baseUrl=b,this._storage=d;if(b==null||b.length===0)throw new Error("The application ID cannot be null or empty");if(c==null||c.length===0)throw new Error("The application ID cannot be null or empty");this._baseQuery="";var e=b.indexOf("?");e>=0&&(this._baseUrl=b.substring(0,e),this._baseQuery=b.substring(e)),this._baseUrl.charAt(this._baseUrl.length-1)!=="/"&&(this._baseUrl+="/");var f=a.toQueryString({appId:c});this._baseQuery+=(this._baseQuery.length===0?"?":"&")+f}return b.prototype._getCachedTextLanguagesAsync=function(){var b=this;return new Promise(function(c,d){try{b._storage.get([e,f],function(b){if(chrome.runtime.lastError){d(chrome.runtime.lastError);return}if(Date.now()-b[e]>a.config.languageCacheDurationMs){d("The cached text languages have expired");return}typeOf(b[f])!=="array"?d("The cached text languages were not an array"):c(b[f])})}catch(g){d(g)}})},b.prototype.getTextLanguagesAsync=function(b,d){var g=this,h;return b===!0?h=Promise.reject("Forcing an update"):h=this._getCachedTextLanguagesAsync(),h.catch(function(b){Logger.info("Need to retrieve updated text languages",b);var h=[];return g.getTextLanguageCodesAsync(d).then(function(a){return h=a,g.getLanguageNamesAsync(a,d)}).then(function(b){if(b.length!==h.length)return Promise.reject(new a.HttpError("Wrong number of language names returned"));var d=[];for(var i=0;i<b.length;i++)d.push(new c(h[i],b[i]));Logger.debug("Retrieved the following text languages:",d);var j={};return j[e]=Date.now(),j[f]=d,g._storage.set(j,function(){chrome.runtime.lastError&&Logger.error("Failed to store the cached languages.",chrome.runtime.lastError)}),d})})},b.prototype.getTextLanguageCodesAsync=function(b){return a.AjaxPromise(a.HttpMethod.GET,this._baseUrl+"GetLanguagesForTranslate"+this._baseQuery,{contentType:"application/x-www-form-urlencoded",parser:function(a){return d(a,"array")},token:b})},b.prototype.getLanguageNamesAsync=function(b,c){return a.AjaxPromise(a.HttpMethod.GET,this._baseUrl+"GetLanguageNames"+this._baseQuery,{query:{locale:getUiTextLang(),languageCodes:JSON.stringify(b)},contentType:"application/x-www-form-urlencoded",parser:function(a){return d(a,"array")},token:c})},b.prototype.translateAsync=function(b,c,e,f,g,h){if(c==null||c.length===0)return Promise.reject(new a.HttpError("toLang cannot be null or empty"));if(e==null)return Promise.reject(new a.HttpError("Must specify an array of text items to translate"));var i={from:b||"",to:c,texts:JSON.stringify(e)};return f&&(i.options=JSON.stringify(f)),a.AjaxPromise(a.HttpMethod.GET,this._baseUrl+"TranslateArray"+this._baseQuery,{query:i,contentType:"application/x-www-form-urlencoded",timeoutInMs:g,parser:function(a){return d(a,"array")},token:h})},b.TEXT_CONTENT="text/plain",b.XML_CONTENT="text/xml",b.HTML_CONTENT="text/html",b}();a.AjaxTranslatorClientV2=g})(b=a.JS||(a.JS={}))})(Microsoft||(Microsoft={}))
;var Microsoft;(function(a){var b;(function(a){var b="999999998DF84F8327FA426EB589A528730CB6B7",c="https://api.microsofttranslator.com/V2/Ajax.svc";a.config={logLevel:a.LogLevel.Error,debug:!1,languageCacheDurationMs:864e5,translatorClient:new a.AjaxTranslatorClientV2(c,b,chrome.storage.local),scriptsToInject:["injectedscript.min.js"]}})(b=a.JS||(a.JS={}))})(Microsoft||(Microsoft={}))
;function enableTranslation(a){tabInfo[a].translationEnabled=!0,window.browser?chrome.pageAction.setIcon({path:{20:"assets/iconactive20.png",25:"assets/iconactive25.png",30:"assets/iconactive30.png",40:"assets/iconactive40.png"},tabId:a}):chrome.pageAction.setIcon({path:"assets/iconactive20.png",tabId:a}),saveTabInfo(),chrome.pageAction.setTitle({tabId:a,title:chrome.i18n.getMessage("showOriginalButton")})}function disableTranslation(a){tabInfo[a].translationEnabled=!1,window.browser?chrome.pageAction.setIcon({path:{20:"assets/iconpassive20.png",25:"assets/iconpassive25.png",30:"assets/iconpassive30.png",40:"assets/iconpassive40.png"},tabId:a}):chrome.pageAction.setIcon({path:"assets/iconpassive20.png",tabId:a}),saveTabInfo(),chrome.pageAction.setTitle({tabId:a,title:chrome.i18n.getMessage("popupTitle")})}function detectTabLanguage(a){return new Promise(function(b,c){chrome.tabs.detectLanguage(a,function(d){var e=Microsoft.JS.TextLanguage.normalizeCode(d);Logger.info("Language detection done",{tabId:a,lang:d,normalizedLang:e}),e?b(e):c()})})}function saveTabInfo(){chrome.storage.local.set({tabInfo:JSON.stringify(tabInfo)},function(){chrome.runtime.lastError&&Logger.error("Failed to save the updated tab state",chrome.runtime.lastError)})}function retrieveSettings(){chrome.storage.local.get(["translateTo","languagesValue","alwaysTranslate","timestamp"],function(a){a.translateTo!=null&&(translateTo=a.translateTo),a.alwaysTranslate!==undefined&&a.alwaysTranslate!==null&&(alwaysTranslate=a.alwaysTranslate===!0),a.languagesValue?translateFrom=a.languagesValue:getLanguages();var b=Date.now()-Microsoft.JS.config.languageCacheDurationMs;a.timestamp!=null&&a.timestamp-b<0&&getLanguages()})}function getLanguages(){Microsoft.JS.config.translatorClient.getTextLanguagesAsync(!0).then(function(a){var b={};for(var c=0;c<a.length;c++)b[a[c].code]=!0;translateFrom=b,chrome.storage.local.set({languagesValue:b,timestamp:Date.now()},function(){chrome.runtime.lastError&&Logger.error("Failed to set the initial languages values",chrome.runtime.lastError)})}).catch(function(a){Logger.error("Failed to retrieve the text languages.",a)})}window.browser||chrome.tabs.onRemoved.addListener(function(a,b){delete tabInfo[a],saveTabInfo()}),chrome.pageAction.onClicked.addListener(function(a){var b=a.id,c=tabInfo[a.id]||{};c.translationEnabled===!0?(disableTranslation(b),Microsoft.JS.injectDisableTranslatorScripts(b)):c.lang&&(enableTranslation(b),Microsoft.JS.injectTranslatorScripts(b,c.lang,translateTo))}),chrome.tabs.onUpdated.addListener(function(a,b,c){var d=c.url;d!==""&&b.status==="complete"&&detectTabLanguage(a).catch(function(){return Logger.warning("Failed to detect language. Retrying for tab "+a),new Promise(function(b,c){setTimeout(function(){detectTabLanguage(a).then(function(a){b(a)}).catch(function(){c()})},1e3)})}).then(function(b){var c=tabInfo[a];c===undefined&&(c={tabId:a},tabInfo[a]=c);var d=c.lang!==b;c.lang=b;if(b&&translateTo&&b!==translateTo&&translateFrom.hasOwnProperty(b)){chrome.pageAction.show(a);var e;c.translationEnabled!==undefined?e=c.translationEnabled&&(!d||alwaysTranslate):e=alwaysTranslate===!0&&translateFrom[b]===!0,e?(enableTranslation(a,b),Microsoft.JS.injectTranslatorScripts(a,b,translateTo)):disableTranslation(a)}})});var translateTo=getUiTextLang(),translateFrom={},tabInfo={},alwaysTranslate=!1;retrieveSettings(),chrome.storage.onChanged.addListener(function(){retrieveSettings()});var messageServer=(new Microsoft.JS.MessageServer).register(Microsoft.JS.MessageCommand.EnableTranslation,function(a,b){enableTranslation(a,b?b.langCode:null)}).register(Microsoft.JS.MessageCommand.DisableTranslation,function(a){disableTranslation(a)})

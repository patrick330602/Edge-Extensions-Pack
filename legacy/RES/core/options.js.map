{"version":3,"sources":["core/options.js"],"names":[],"mappings":";;;;AAAA,IAAI,WAAW,YAAY,EAAZ;;AAEf,SAAS,OAAT,GAAmB,EAAnB;;AAEA,SAAS,OAAT,CAAiB,SAAjB,GAA6B,EAA7B;AACA,SAAS,OAAT,CAAiB,SAAjB,CAA2B,YAA3B,IAA2C;AAC1C,SAAQ,uCAAR;AACA,WAAU,uBAAV;AACA,WAAU,kBAAS,QAAT,EAAmB;AAC5B,MAAI,QAAQ,SAAS,KAAT;MACX,UAAU,MAAM,GAAN,CAAU,UAAS,IAAT,EAAe;AAClC,UAAO;AACN,QAAI,IAAJ;AACA,UAAM,IAAN;IAFD,CADkC;GAAf,CAApB,CAF2B;AAQ5B,SAAO,OAAP,CAR4B;EAAnB;AAUV,iBAAgB,wBAAS,QAAT,EAAmB;AAClC,MAAI,QAAQ,SAAS,KAAT;MACX,UAAU,MAAM,GAAN,CAAU,UAAS,IAAT,EAAe;AAClC,UAAO;AACN,QAAI,IAAJ;AACA,UAAM,IAAN;IAFD,CADkC;GAAf,CAApB,CAFiC;AAQlC,SAAO,OAAP,CARkC;EAAnB;AAUhB,iBAAgB,0BAAW;AAC1B,MAAI,SAAS,MAAM,SAAN,CAAgB,KAAhB,CAAsB,IAAtB,CAA2B,SAA3B,EAAsC,MAAtC,CAA6C,UAAS,CAAT,EAAY,CAAZ,EAAe;AAAE,UAAO,EAAE,MAAF,CAAS,CAAT,CAAP,CAAF;GAAf,EAAwC,EAArF,CAAT,CADsB;AAE1B,WAAS,OAAO,GAAP,CAAW,UAAS,KAAT,EAAgB;AACnC,OAAI,MAAM,KAAN,EAAa;AAChB,WAAO,MAAM,KAAN,CAAY,OAAZ,CAAP,CADgB;IAAjB;AAGA,UAAO,KAAP,CAJmC;GAAhB,CAAX,CAKN,MALM,CAKC,UAAS,CAAT,EAAY,CAAZ,EAAe;AAAE,UAAO,EAAE,MAAF,CAAS,CAAT,CAAP,CAAF;GAAf,EAAwC,EALzC,CAAT,CAF0B;AAQ1B,SAAO,MAAP,CAR0B;EAAX;CAvBjB;;AAoCA,SAAS,OAAT,CAAiB,KAAjB,GAAyB,EAAzB;;AAEA,SAAS,OAAT,CAAiB,KAAjB,CAAuB,gBAAvB,GAA0C,UAAS,QAAT,EAAmB,SAAnB,EAA8B,gBAA9B,EAAgD;AACzF,KAAI,SAAS,QAAQ,QAAR,EAAkB,OAAlB,CAA0B,SAA1B,CAAT,CADqF;AAEzF,KAAI,SAAS,OAAO,KAAP,CAF4E;AAGzF,KAAI,OAAO,IAAP,KAAgB,OAAhB,IAA2B,CAAC,MAAD,IAAW,CAAC,OAAO,MAAP,EAAe,OAA1D;;AAEA,QAAO,OAAO,IAAP,CAAY,UAAS,KAAT,EAAgB;AAClC,MAAI,eAAe,KAAf,CAD8B;AAElC,MAAI,QAAQ,OAAO,MAAP,CAAc,KAAd,CAAoB,UAAS,KAAT,EAAgB,EAAhB,EAAoB;AACnD,OAAI,aAAa,MAAM,EAAN,CAAb,CAD+C;AAEnD,OAAI,aAAa,SAAS,UAAT,CAAoB,iBAAiB,EAAjB,CAApB,EAA0C,iBAAiB,MAAM,IAAN,CAA3D,CAAb,CAF+C;;AAInD,OAAI,eAAe,SAAf,EAA0B;AAC7B,WAAO,IAAP,CAD6B;IAA9B;;AAIA,OAAI,eAAe,UAAf,EAA2B;AAC9B,mBAAe,IAAf,CAD8B;AAE9B,WAAO,IAAP,CAF8B;IAA/B;;AAKA,UAAO,KAAP,CAbmD;GAApB,CAA5B,CAF8B;;AAkBlC,SAAO,SAAS,YAAT,CAlB2B;EAAhB,CAAnB,CALyF;CAAhD;;AA2B1C,SAAS,OAAT,CAAiB,KAAjB,CAAuB,QAAvB,GAAkC,UAAS,QAAT,EAAmB,SAAnB,EAA8B,KAA9B,EAAqC;AACtE,KAAI,SAAS,QAAQ,QAAR,EAAkB,OAAlB,CAA0B,SAA1B,CAAT,CADkE;AAEtE,KAAI,OAAO,IAAP,KAAgB,OAAhB,EAAyB;AAC5B,UAAQ,KAAR,CAAc,8DAA8D,QAA9D,GAAyE,cAAzE,GAA0F,SAA1F,CAAd,CAD4B;AAE5B,SAF4B;EAA7B;;AAKA,KAAI,CAAC,OAAO,KAAP,EAAc;AAClB,SAAO,KAAP,GAAe,EAAf,CADkB;EAAnB;AAGA,KAAI,SAAS,OAAO,KAAP,CAVyD;;AAYtE,KAAI,cAAc,OAAO,MAAP,CAAc,GAAd,CAAkB,UAAS,KAAT,EAAgB,CAAhB,EAAmB;AACtD,SAAO,SAAS,UAAT,CAAoB,MAAM,CAAN,CAApB,EAA8B,MAAM,MAAM,IAAN,CAApC,EAAiD,MAAM,KAAN,CAAxD,CADsD;EAAnB,CAAhC,CAZkE;;AAgBtE,QAAO,IAAP,CAAY,WAAZ,EAhBsE;AAiBtE,UAAS,OAAT,CAAiB,SAAjB,CAA2B,QAA3B,EAAqC,SAArC,EAAgD,MAAhD,EAjBsE;;AAmBtE,QAAO,WAAP,CAnBsE;CAArC;;AAsBlC,SAAS,OAAT,CAAiB,KAAjB,CAAuB,qBAAvB,GAA+C,UAAS,QAAT,EAAmB,SAAnB,EAA8B,eAA9B,EAA+C,YAA/C,EAA6D;AAC3G,KAAI,gBAAgB,SAAS,OAAT,CAAiB,KAAjB,CAAuB,gBAAvB,CAAwC,QAAxC,EAAkD,SAAlD,EAA6D,eAA7D,CAAhB,CADuG;AAE3G,KAAI,CAAC,aAAD,EAAgB;AACnB,MAAI,QAAQ,eAAR,CADe;AAEnB,MAAI,YAAJ,EAAkB;AACjB,WAAQ,aAAa,eAAb,CAAR,CADiB;GAAlB;;AAIA,kBAAgB,SAAS,OAAT,CAAiB,KAAjB,CAAuB,QAAvB,CAAgC,QAAhC,EAA0C,SAA1C,EAAqD,KAArD,CAAhB,CANmB;EAApB;;AASA,QAAO,aAAP,CAX2G;CAA7D;;AAc/C,SAAS,OAAT,CAAiB,KAAjB,CAAuB,gBAAvB,GAA0C,UAAS,QAAT,EAAmB,SAAnB,EAA8B,KAA9B,EAAqC;AAC9E,KAAI,SAAS,QAAQ,QAAR,EAAkB,OAAlB,CAA0B,SAA1B,CAAT,CAD0E;;AAG9E,KAAI,SAAS,EAAT,CAH0E;AAI9E,QAAO,MAAP,CAAc,OAAd,CAAsB,UAAS,KAAT,EAAgB,CAAhB,EAAmB;AACxC,SAAO,MAAM,IAAN,CAAP,GAAqB,MAAM,CAAN,CAArB,CADwC;EAAnB,CAAtB,CAJ8E;;AAQ9E,QAAO,MAAP,CAR8E;CAArC;;AAW1C,EAAE,MAAF,CAAS,SAAS,OAAT,EAAkB;AAC1B,mBAAkB,4BAAW;AAC5B,OAAK,cAAL,CAAoB,EAApB,EAD4B;EAAX;AAGlB,oBAAmB,2BAAS,KAAT,EAAgB;AAClC,MAAI,WAAJ;;AADkC,MAG9B,CAAE,KAAD,IAAY,OAAO,KAAK,uBAAL,KAAiC,WAAxC,EAAsD;AACtE,UAAO,KAAK,uBAAL,CAD+D;GAAvE;;AAHkC,MAO9B,WAAW,OAAX,CAAmB,iBAAnB,MAA0C,IAA1C,EAAgD;AACnD,iBAAc,SAAS,KAAT,CAAe,WAAW,OAAX,CAAmB,iBAAnB,CAAf,EAAsD,iBAAtD,CAAd,CADmD;GAApD,MAEO,IAAI,WAAW,OAAX,CAAmB,aAAnB,MAAsC,IAAtC,EAA4C;;AAEtD,iBAAc,SAAS,KAAT,CAAe,WAAW,OAAX,CAAmB,aAAnB,CAAf,EAAkD,aAAlD,CAAd,CAFsD;AAGtD,cAAW,UAAX,CAAsB,aAAtB,EAHsD;AAItD,QAAK,cAAL,CAAoB,WAApB,EAJsD;GAAhD;AAMP,MAAI,CAAC,WAAD,EAAc;AACjB,iBAAc,EAAd,CADiB;GAAlB;;AAfkC,MAmB9B,QAAQ,EAAR;;AAnB8B,OAqB7B,IAAI,MAAJ,IAAc,OAAnB,EAA4B;AAC3B,OAAI,YAAY,MAAZ,CAAJ,EAAyB;AACxB,UAAM,MAAN,IAAgB,YAAY,MAAZ,CAAhB,CADwB;IAAzB,MAEO,IAAI,CAAC,QAAQ,MAAR,EAAgB,iBAAhB,KACT,YAAY,MAAZ,MAAwB,SAAxB,IACD,YAAY,MAAZ,MAAwB,IAAxB,IAAgC,OAAO,aAAP,CAFvB,EAE8C;;AAExD,UAAM,MAAN,IAAgB,IAAhB,CAFwD;IAFlD,MAKA;AACN,UAAM,MAAN,IAAgB,KAAhB,CADM;IALA;GAHR;AAYA,OAAK,uBAAL,GAA+B,KAA/B,CAjCkC;AAkClC,SAAO,KAAP,CAlCkC;EAAhB;AAoCnB,iBAAgB,wBAAS,QAAT,EAAmB;AAClC,MAAI,QAAJ,EAAc;AACb,OAAI,QAAQ,KAAK,iBAAL,EAAR,CADS;AAEb,UAAO,MAAM,QAAN,CAAP,CAFa;GAAd,MAGO;AACN,SAAM,6CAAN,EADM;GAHP;EADe;AAQhB,iBAAgB,wBAAS,KAAT,EAAgB;AAC/B,MAAI,UAAU,IAAV,EAAgB;AACnB,cAAW,OAAX,CAAmB,iBAAnB,EAAsC,KAAK,SAAL,CAAe,KAAf,CAAtC,EADmB;AAEnB,UAAO,KAAP,CAFmB;GAApB,MAGO;AACN,SAAM,4BAAN,EADM;GAHP;EADe;AAQhB,yBAAwB,gCAAS,QAAT,EAAmB;AAC1C,MAAI,aAAa,OAAO,mBAAP,CAA2B,OAA3B,EACf,MADe,CACR,UAAS,QAAT,EAAmB;AAC1B,UAAO,CAAC,QAAQ,QAAR,EAAkB,MAAlB,CADkB;GAAnB,CADQ,CAIf,MAJe,CAIR,UAAS,QAAT,EAAmB;AAC1B,UAAO,GAAG,MAAH,CAAU,QAAQ,QAAR,EAAkB,QAAlB,CAAV,CAAsC,OAAtC,CAA8C,QAA9C,MAA4D,CAAC,CAAD,CADzC;GAAnB,CAJQ,CAOf,IAPe,CAOV,UAAS,SAAT,EAAoB,SAApB,EAA+B;AACpC,OAAI,IAAI,QAAQ,SAAR,CAAJ,CADgC;AAEpC,OAAI,IAAI,QAAQ,SAAR,CAAJ,CAFgC;;AAIpC,OAAI,EAAE,IAAF,KAAW,SAAX,IAAwB,EAAE,IAAF,KAAW,SAAX,EAAsB;AACjD,QAAI,iBAAiB,CAAC,EAAE,IAAF,IAAU,CAAV,CAAD,IAAiB,EAAE,IAAF,IAAU,CAAV,CAAjB,CAD4B;AAEjD,QAAI,mBAAmB,CAAnB,EAAsB;AACzB,YAAO,cAAP,CADyB;KAA1B;IAFD;;AAOA,OAAI,EAAE,UAAF,CAAa,WAAb,KAA6B,EAAE,UAAF,CAAa,WAAb,EAA7B,EAAyD,OAAO,CAAP,CAA7D;AACA,UAAO,CAAC,CAAD,CAZ6B;GAA/B,CAPH,CADsC;;AAuB1C,SAAO,UAAP,CAvB0C;EAAnB;AAyBxB,eAAc,sBAAS,QAAT,EAAmB,OAAnB,EAA4B;AACzC,MAAI,SAAS,QAAQ,QAAR,CAAT,CADqC;AAEzC,MAAI,CAAC,MAAD,EAAS;AACZ,WAAQ,IAAR,CAAa,4CAAb,EAA2D,QAA3D,EADY;AAEZ,UAFY;GAAb;AAIA,MAAI,OAAO,aAAP,IAAwB,CAAC,OAAD,EAAU;AACrC,UADqC;GAAtC;;AAIA,MAAI,QAAQ,KAAK,iBAAL,CAAuB,IAAvB,CAAR,CAVqC;AAWzC,QAAM,QAAN,IAAkB,CAAC,CAAC,OAAD,CAXsB;AAYzC,OAAK,cAAL,CAAoB,KAApB,EAZyC;AAazC,MAAI,OAAO,OAAO,QAAP,KAAoB,UAA3B,EAAuC;AAC1C,WAAQ,QAAR,EAAkB,QAAlB,CAA2B,OAA3B,EAD0C;GAA3C;EAba;AAiBd,YAAW,mBAAS,QAAT,EAAmB,UAAnB,EAA+B,WAA/B,EAA4C;AACtD,MAAI,UAAU,IAAV,CAAe,UAAf,CAAJ,EAAgC;AAC/B,gBAAa,WAAW,OAAX,CAAmB,SAAnB,EAA8B,EAA9B,CAAb,CAD+B;GAAhC;AAGA,MAAI,cAAc,KAAK,UAAL,CAAgB,QAAhB,CAAd,CAJkD;AAKtD,MAAI,CAAC,YAAY,UAAZ,CAAD,EAA0B;AAC7B,WAAQ,IAAR,CAAa,uBAAb,EAAsC,QAAtC,EAAgD,UAAhD,EAD6B;AAE7B,UAAO,KAAP,CAF6B;GAA9B;;AAKA,MAAI,eAAJ,CAVsD;AAWtD,MAAI,gBAAgB,EAAhB,EAAoB;AACvB,qBAAkB,EAAlB,CADuB;GAAxB,MAEO,IAAI,KAAC,CAAM,WAAN,CAAD,IAAyB,OAAO,WAAP,KAAuB,SAAvB,IAAsC,QAAO,iEAAP,KAAuB,QAAvB,EAAkC;AAC3G,qBAAkB,WAAlB,CAD2G;GAArG,MAEA,IAAI,YAAY,OAAZ,IAAuB,YAAY,OAAZ,CAAoB,GAApB,MAA6B,CAAC,CAAD,EAAI;AAClE,qBAAkB,WAAW,WAAX,CAAlB,CADkE;GAA5D,MAEA;AACN,qBAAkB,SAAS,WAAT,EAAsB,EAAtB,CAAlB,CADM;GAFA;AAKP,cAAY,UAAZ,EAAwB,KAAxB,GAAgC,eAAhC;;AApBsD,UAsBtD,CAAS,OAAT,CAAiB,iBAAjB,CAAmC,QAAnC,EAA6C,WAA7C,EAtBsD;AAuBtD,SAAO,IAAP,CAvBsD;EAA5C;AAyBX,oBAAmB,2BAAS,QAAT,EAAmB,UAAnB,EAA+B;AACjD,WAAS,MAAT,CAAgB,GAAhB,EAAqB;AACpB,OAAI,MAAM,EAAN,CADgB;AAEpB,OAAI,GAAJ,EAAS;AACR,SAAK,IAAI,GAAJ,IAAW,GAAhB,EAAqB;AACpB,SAAI,WAAW,IAAI,GAAJ,CAAX,EAAqB;AACxB,UAAI,GAAJ,IAAW,EAAC,OAAO,IAAI,GAAJ,EAAS,KAAT,EAAnB,CADwB;MAAzB;KADD;IADD;AAOA,UAAO,GAAP,CAToB;GAArB;AAWA,MAAI,UAAJ,EAAgB;AACf,WAAQ,QAAR,EAAkB,OAAlB,GAA4B,UAA5B,CADe;GAAhB;AAGA,aAAW,OAAX,CAAmB,gBAAgB,QAAhB,EAA0B,KAAK,SAAL,CAAe,OAAO,QAAQ,QAAR,EAAkB,OAAlB,CAAtB,CAA7C,EAfiD;EAA/B;AAiBnB,cAAa,qBAAS,QAAT,EAAmB;AAC/B,MAAI,eAAe,OAAO,mBAAP,CAA2B,QAAQ,QAAR,EAAkB,OAAlB,IAA6B,EAA7B,CAA3B,CAA4D,IAA5D,CAAiE,UAAS,SAAT,EAAoB;AACvG,OAAI,OAAO,QAAQ,QAAR,EAAkB,OAAlB,CAA0B,SAA1B,EAAqC,IAArC,CAD4F;AAEvG,UAAO,SAAS,QAAT,CAFgG;GAApB,CAAhF,CAD2B;;AAM/B,MAAI,YAAJ,EAAkB;AACjB,UAAO,WAAW,QAAX,CAAoB,gBAAgB,QAAhB,CAApB,CACL,IADK,CACA,SAAS,OAAT,CAAiB,UAAjB,CAA4B,IAA5B,CAAiC,SAAS,OAAT,EAAkB,QAAnD,CADA,CAAP,CADiB;GAAlB,MAGO;AACN,UAAO,EAAE,QAAF,GAAa,OAAb,CAAqB,QAAQ,QAAR,EAAkB,OAAlB,CAA5B,CADM;GAHP;EANY;AAab,qBAAoB,EAApB;AACA,aAAY,oBAAS,QAAT,EAAmB,mBAAnB,EAAwC;AACnD,MAAI,KAAK,kBAAL,CAAwB,QAAxB,CAAJ,EAAuC;;AAEtC,UAAO,QAAQ,QAAR,EAAkB,OAAlB,CAF+B;GAAvC;AAIA,IAAE,IAAF,CAAO,QAAQ,QAAR,EAAkB,OAAlB,IAA6B,EAA7B,EAAiC,UAAS,GAAT,EAAc,GAAd,EAAmB;AAC1D,OAAI,OAAJ,GAAc,IAAI,KAAJ,CAD4C;GAAnB,CAAxC,CALmD;AAQnD,MAAI,aAAa,WAAW,OAAX,CAAmB,gBAAgB,QAAhB,CAAhC,CAR+C;AASnD,MAAI,cAAc,eAAe,WAAf,EAA4B;;AAE7C,OAAI,gBAAgB,SAAS,KAAT,CAAe,UAAf,EAA2B,gBAAgB,QAAhB,CAA3C,CAFyC;AAG7C,OAAI,cAAc,QAAQ,QAAR,EAAkB,OAAlB,CAH2B;AAI7C,OAAI,YAAY,KAAZ,CAJyC;AAK7C,QAAK,IAAI,QAAJ,IAAgB,WAArB,EAAkC;AACjC,QAAI,OAAO,cAAc,QAAd,CAAP,KAAmC,WAAnC,EAAgD;AACnD,iBAAY,IAAZ,CADmD;KAApD,MAEO;AACN,iBAAY,QAAZ,EAAsB,KAAtB,GAA8B,cAAc,QAAd,EAAwB,KAAxB,CADxB;KAFP;IADD;AAOA,OAAI,wBAAwB,IAAxB,EAA8B;AACjC,YAAQ,QAAR,EAAkB,kBAAlB,GAAuC,IAAvC,CADiC;AAEjC,SAAK,IAAI,OAAJ,IAAe,aAApB,EAAmC;AAClC,SAAI,YAAY,OAAZ,MAAyB,SAAzB,EAAoC;AACvC,kBAAY,OAAZ,IAAuB,cAAc,OAAd,CAAvB,CADuC;AAEvC,kBAAY,OAAZ,EAAqB,QAArB,GAAgC,IAAhC,CAFuC;MAAxC;KADD;IAFD;AASA,WAAQ,QAAR,EAAkB,OAAlB,GAA4B,WAA5B,CArB6C;AAsB7C,OAAI,SAAJ,EAAe;AACd,aAAS,OAAT,CAAiB,iBAAjB,CAAmC,QAAnC,EADc;IAAf;GAtBD,MAyBO;;AAEN,YAAS,OAAT,CAAiB,iBAAjB,CAAmC,QAAnC,EAFM;GAzBP;AA6BA,OAAK,kBAAL,CAAwB,QAAxB,IAAoC,IAApC,CAtCmD;AAuCnD,SAAO,QAAQ,QAAR,EAAkB,OAAlB,CAvC4C;EAAxC;AAyCZ,wBAAuB,+BAAS,QAAT,EAAmB;AACzC,MAAI,OAAO,QAAP,KAAoB,WAApB,EAAiC;AACpC,QAAK,QAAL,IAAiB,OAAjB,EAA0B;AACzB,aAAS,OAAT,CAAiB,qBAAjB,CAAuC,QAAvC,EADyB;IAA1B;AAGA,UAJoC;GAArC;;AAOA,MAAI,QAAQ,QAAR,EAAkB,kBAAlB,EAAsC;AACzC,OAAI,gBAAgB,QAAQ,QAAR,EAAkB,OAAlB,CADqB;AAEzC,QAAK,IAAI,GAAJ,IAAW,aAAhB,EAA+B;AAC9B,QAAI,cAAc,GAAd,EAAmB,QAAnB,EAA6B;AAChC,YAAO,cAAc,GAAd,CAAP,CADgC;KAAjC;IADD;AAKA,WAAQ,QAAR,EAAkB,kBAAlB,GAAuC,KAAvC,CAPyC;GAA1C;EARsB;CAnMxB;;AAuNA,CAAC,UAAS,MAAT,EAAiB;AACjB,KAAI,aAAJ,CADiB;;AAGjB,sBAHiB;;AAKjB,UAAS,WAAT,CAAqB,QAArB,EAA+B,UAA/B,EAA2C,WAA3C,EAAwD;AACvD,gBAAc,QAAd,IAA0B,cAAc,QAAd,KAA2B,EAA3B,CAD6B;AAEvD,gBAAc,QAAd,EAAwB,UAAxB,IAAsC;AACrC,UAAO,WAAP;GADD,CAFuD;EAAxD;AAMA,UAAS,mBAAT,GAA+B;AAC9B,IAAE,IAAF,CAAO,aAAP,EAAsB,UAAS,QAAT,EAAmB,MAAnB,EAA2B;AAChD,KAAE,IAAF,CAAO,MAAP,EAAe,UAAS,UAAT,EAAqB,MAArB,EAA6B;AAC3C,aAAS,OAAT,CAAiB,SAAjB,CAA2B,QAA3B,EAAqC,UAArC,EAAiD,OAAO,KAAP,CAAjD,CAD2C;IAA7B,CAAf,CADgD;GAA3B,CAAtB,CAD8B;AAM9B,uBAN8B;EAA/B;AAQA,UAAS,kBAAT,GAA8B;AAC7B,kBAAgB,EAAhB,CAD6B;EAA9B;;AAIA,UAAS,gBAAT,GAA4B;AAC3B,SAAO,OAAO,mBAAP,CAA2B,aAA3B,EAA0C,MAA1C,CADoB;EAA5B;;AAIA,UAAS,UAAT,CAAoB,QAApB,EAA8B;AAC7B,SAAO,cAAc,QAAd,CAAP,CAD6B;EAA9B;;AAIA,QAAO,KAAP,GAAe,kBAAf,CA/BiB;AAgCjB,QAAO,GAAP,GAAa,WAAb,CAhCiB;AAiCjB,QAAO,MAAP,GAAgB,mBAAhB,CAjCiB;AAkCjB,QAAO,OAAP,GAAiB,gBAAjB,CAlCiB;AAmCjB,QAAO,GAAP,GAAa,UAAb,CAnCiB;CAAjB,CAAD,CAoCG,SAAS,OAAT,CAAiB,KAAjB,GAAyB,SAAS,OAAT,CAAiB,KAAjB,IAA0B,EAA1B,CApC5B","file":"core/options.js","sourcesContent":["var RESUtils = RESUtils || {};\r\n\r\nRESUtils.options = {};\r\n\r\nRESUtils.options.listTypes = {};\r\nRESUtils.options.listTypes['subreddits'] = {\r\n\tsource: '/api/search_reddit_names.json?app=res',\r\n\thintText: 'type a subreddit name',\r\n\tonResult: function(response) {\r\n\t\tvar names = response.names,\r\n\t\t\tresults = names.map(function(name) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tid: name,\r\n\t\t\t\t\tname: name\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\treturn results;\r\n\t},\r\n\tonCachedResult: function(response) {\r\n\t\tvar names = response.names,\r\n\t\t\tresults = names.map(function(name) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tid: name,\r\n\t\t\t\t\tname: name\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\treturn results;\r\n\t},\r\n\tsanitizeValues: function() {\r\n\t\tvar values = Array.prototype.slice.call(arguments).reduce(function(a, b) { return a.concat(b); }, []);\r\n\t\tvalues = values.map(function(value) {\r\n\t\t\tif (value.split) {\r\n\t\t\t\treturn value.split(/[\\s,]/);\r\n\t\t\t}\r\n\t\t\treturn value;\r\n\t\t}).reduce(function(a, b) { return a.concat(b); }, []);\r\n\t\treturn values;\r\n\t}\r\n};\r\n\r\n\r\nRESUtils.options.table = {};\r\n\r\nRESUtils.options.table.getMatchingValue = function(moduleID, optionKey, valueIdentifiers) {\r\n\tvar option = modules[moduleID].options[optionKey];\r\n\tvar values = option.value;\r\n\tif (option.type !== 'table' || !values || !values.length) return;\r\n\r\n\treturn values.find(function(value) {\r\n\t\tvar containValid = false;\r\n\t\tvar match = option.fields.every(function(field, fi) {\r\n\t\t\tvar fieldValue = value[fi];\r\n\t\t\tvar matchValue = RESUtils.firstValid(valueIdentifiers[fi], valueIdentifiers[field.name]);\r\n\r\n\t\t\tif (matchValue === undefined) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tif (matchValue === fieldValue) {\r\n\t\t\t\tcontainValid = true;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\treturn false;\r\n\t\t});\r\n\r\n\t\treturn match && containValid;\r\n\t});\r\n};\r\n\r\nRESUtils.options.table.addValue = function(moduleID, optionKey, value) {\r\n\tvar option = modules[moduleID].options[optionKey];\r\n\tif (option.type !== 'table') {\r\n\t\tconsole.error('Tried to save table value to non-table option: modules[\\'' + moduleID + '\\'].options.' + optionKey);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (!option.value) {\r\n\t\toption.value = [];\r\n\t}\r\n\tvar values = option.value;\r\n\r\n\tvar optionValue = option.fields.map(function(field, i) {\r\n\t\treturn RESUtils.firstValid(value[i], value[field.name], field.value);\r\n\t});\r\n\r\n\tvalues.push(optionValue);\r\n\tRESUtils.options.setOption(moduleID, optionKey, values);\r\n\r\n\treturn optionValue;\r\n};\r\n\r\nRESUtils.options.table.getMatchingValueOrAdd = function(moduleID, optionKey, valueIdentifier, hydrateValue) {\r\n\tvar matchingValue = RESUtils.options.table.getMatchingValue(moduleID, optionKey, valueIdentifier);\r\n\tif (!matchingValue) {\r\n\t\tvar value = valueIdentifier;\r\n\t\tif (hydrateValue) {\r\n\t\t\tvalue = hydrateValue(valueIdentifier);\r\n\t\t}\r\n\r\n\t\tmatchingValue = RESUtils.options.table.addValue(moduleID, optionKey, value);\r\n\t}\r\n\r\n\treturn matchingValue;\r\n};\r\n\r\nRESUtils.options.table.mapValueToObject = function(moduleID, optionKey, value) {\r\n\tvar option = modules[moduleID].options[optionKey];\r\n\r\n\tvar object = {};\r\n\toption.fields.forEach(function(field, i) {\r\n\t\tobject[field.name] = value[i];\r\n\t});\r\n\r\n\treturn object;\r\n};\r\n\r\n$.extend(RESUtils.options, {\r\n\tresetModulePrefs: function() {\r\n\t\tthis.setModulePrefs({});\r\n\t},\r\n\tgetAllModulePrefs: function(force) {\r\n\t\tvar storedPrefs;\r\n\t\t// if we've done this before, just return the cached version\r\n\t\tif ((!force) && (typeof this.getAllModulePrefsCached !== 'undefined')) {\r\n\t\t\treturn this.getAllModulePrefsCached;\r\n\t\t}\r\n\t\t// get the stored preferences out first.\r\n\t\tif (RESStorage.getItem('RES.modulePrefs') !== null) {\r\n\t\t\tstoredPrefs = safeJSON.parse(RESStorage.getItem('RES.modulePrefs'), 'RES.modulePrefs');\r\n\t\t} else if (RESStorage.getItem('modulePrefs') !== null) {\r\n\t\t\t// Clean up old moduleprefs.\r\n\t\t\tstoredPrefs = safeJSON.parse(RESStorage.getItem('modulePrefs'), 'modulePrefs');\r\n\t\t\tRESStorage.removeItem('modulePrefs');\r\n\t\t\tthis.setModulePrefs(storedPrefs);\r\n\t\t}\r\n\t\tif (!storedPrefs) {\r\n\t\t\tstoredPrefs = {};\r\n\t\t}\r\n\t\t// create a new JSON object that we'll use to return all preferences. This is just in case we add a module, and there's no pref stored for it.\r\n\t\tvar prefs = {};\r\n\t\t// for any stored prefs, drop them in our prefs JSON object.\r\n\t\tfor (var module in modules) {\r\n\t\t\tif (storedPrefs[module]) {\r\n\t\t\t\tprefs[module] = storedPrefs[module];\r\n\t\t\t} else if (!modules[module].disabledByDefault &&\r\n\t\t\t\t\t(storedPrefs[module] === undefined ||\r\n\t\t\t\t\tstoredPrefs[module] === null || module.alwaysEnabled)) {\r\n\t\t\t\t// looks like a new module, or no preferences. We'll default it to on.\r\n\t\t\t\tprefs[module] = true;\r\n\t\t\t} else {\r\n\t\t\t\tprefs[module] = false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.getAllModulePrefsCached = prefs;\r\n\t\treturn prefs;\r\n\t},\r\n\tgetModulePrefs: function(moduleID) {\r\n\t\tif (moduleID) {\r\n\t\t\tvar prefs = this.getAllModulePrefs();\r\n\t\t\treturn prefs[moduleID];\r\n\t\t} else {\r\n\t\t\talert('no module name specified for getModulePrefs');\r\n\t\t}\r\n\t},\r\n\tsetModulePrefs: function(prefs) {\r\n\t\tif (prefs !== null) {\r\n\t\t\tRESStorage.setItem('RES.modulePrefs', JSON.stringify(prefs));\r\n\t\t\treturn prefs;\r\n\t\t} else {\r\n\t\t\talert('error - no prefs specified');\r\n\t\t}\r\n\t},\r\n\tgetModuleIDsByCategory: function(category) {\r\n\t\tvar moduleList = Object.getOwnPropertyNames(modules)\r\n\t\t\t.filter(function(moduleID) {\r\n\t\t\t\treturn !modules[moduleID].hidden;\r\n\t\t\t})\r\n\t\t\t.filter(function(moduleID) {\r\n\t\t\t\treturn [].concat(modules[moduleID].category).indexOf(category) !== -1;\r\n\t\t\t})\r\n\t\t\t.sort(function(moduleID1, moduleID2) {\r\n\t\t\t\tvar a = modules[moduleID1];\r\n\t\t\t\tvar b = modules[moduleID2];\r\n\r\n\t\t\t\tif (a.sort !== undefined || b.sort !== undefined) {\r\n\t\t\t\t\tvar sortComparison = (a.sort || 0) - (b.sort || 0);\r\n\t\t\t\t\tif (sortComparison !== 0) {\r\n\t\t\t\t\t\treturn sortComparison;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (a.moduleName.toLowerCase() > b.moduleName.toLowerCase()) return 1;\r\n\t\t\t\treturn -1;\r\n\t\t\t});\r\n\r\n\t\treturn moduleList;\r\n\t},\r\n\tenableModule: function(moduleID, onOrOff) {\r\n\t\tvar module = modules[moduleID];\r\n\t\tif (!module) {\r\n\t\t\tconsole.warn('options.enableModule could not find module', moduleID);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (module.alwaysEnabled && !onOrOff) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar prefs = this.getAllModulePrefs(true);\r\n\t\tprefs[moduleID] = !!onOrOff;\r\n\t\tthis.setModulePrefs(prefs);\r\n\t\tif (typeof module.onToggle === 'function') {\r\n\t\t\tmodules[moduleID].onToggle(onOrOff);\r\n\t\t}\r\n\t},\r\n\tsetOption: function(moduleID, optionName, optionValue) {\r\n\t\tif (/_[\\d]+$/.test(optionName)) {\r\n\t\t\toptionName = optionName.replace(/_[\\d]+$/, '');\r\n\t\t}\r\n\t\tvar thisOptions = this.getOptions(moduleID);\r\n\t\tif (!thisOptions[optionName]) {\r\n\t\t\tconsole.warn('Could not find option', moduleID, optionName);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tvar saveOptionValue;\r\n\t\tif (optionValue === '') {\r\n\t\t\tsaveOptionValue = '';\r\n\t\t} else if ((isNaN(optionValue)) || (typeof optionValue === 'boolean') || (typeof optionValue === 'object')) {\r\n\t\t\tsaveOptionValue = optionValue;\r\n\t\t} else if (optionValue.indexOf && optionValue.indexOf('.') !== -1) {\r\n\t\t\tsaveOptionValue = parseFloat(optionValue);\r\n\t\t} else {\r\n\t\t\tsaveOptionValue = parseInt(optionValue, 10);\r\n\t\t}\r\n\t\tthisOptions[optionName].value = saveOptionValue;\r\n\t\t// save it to the object and to RESStorage\r\n\t\tRESUtils.options.saveModuleOptions(moduleID, thisOptions);\r\n\t\treturn true;\r\n\t},\r\n\tsaveModuleOptions: function(moduleID, newOptions) {\r\n\t\tfunction minify(obj) {\r\n\t\t\tvar min = {};\r\n\t\t\tif (obj) {\r\n\t\t\t\tfor (var key in obj) {\r\n\t\t\t\t\tif ('value' in obj[key]) {\r\n\t\t\t\t\t\tmin[key] = {value: obj[key].value};\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn min;\r\n\t\t}\r\n\t\tif (newOptions) {\r\n\t\t\tmodules[moduleID].options = newOptions;\r\n\t\t}\r\n\t\tRESStorage.setItem('RESoptions.' + moduleID, JSON.stringify(minify(modules[moduleID].options)));\r\n\t},\r\n\tloadOptions: function(moduleID) {\r\n\t\tvar needsStorage = Object.getOwnPropertyNames(modules[moduleID].options || {}).some(function(optionKey) {\r\n\t\t\tvar type = modules[moduleID].options[optionKey].type;\r\n\t\t\treturn type !== 'button';\r\n\t\t});\r\n\r\n\t\tif (needsStorage) {\r\n\t\t\treturn RESStorage.loadItem('RESoptions.' + moduleID)\r\n\t\t\t\t.then(RESUtils.options.getOptions.bind(RESUtils.options, moduleID));\r\n\t\t} else {\r\n\t\t\treturn $.Deferred().resolve(modules[moduleID].options);\r\n\t\t}\r\n\t},\r\n\tgetOptionsFirstRun: {},\r\n\tgetOptions: function(moduleID, keepObsoleteOptions) {\r\n\t\tif (this.getOptionsFirstRun[moduleID]) {\r\n\t\t\t// we've already grabbed these out of localstorage, so modifications should be done in memory. just return that object.\r\n\t\t\treturn modules[moduleID].options;\r\n\t\t}\r\n\t\t$.each(modules[moduleID].options || {}, function(key, opt) {\r\n\t\t\topt.default = opt.value;\r\n\t\t});\r\n\t\tvar rawOptions = RESStorage.getItem('RESoptions.' + moduleID);\r\n\t\tif (rawOptions && rawOptions !== 'undefined') {\r\n\t\t\t// merge options (in case new ones were added via code) and if anything has changed, update to localStorage\r\n\t\t\tvar storedOptions = safeJSON.parse(rawOptions, 'RESoptions.' + moduleID);\r\n\t\t\tvar codeOptions = modules[moduleID].options;\r\n\t\t\tvar newOption = false;\r\n\t\t\tfor (var attrname in codeOptions) {\r\n\t\t\t\tif (typeof storedOptions[attrname] === 'undefined') {\r\n\t\t\t\t\tnewOption = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcodeOptions[attrname].value = storedOptions[attrname].value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (keepObsoleteOptions === true) {\r\n\t\t\t\tmodules[moduleID].hasObsoleteOptions = true;\r\n\t\t\t\tfor (var optName in storedOptions) {\r\n\t\t\t\t\tif (codeOptions[optName] === undefined) {\r\n\t\t\t\t\t\tcodeOptions[optName] = storedOptions[optName];\r\n\t\t\t\t\t\tcodeOptions[optName].obsolete = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tmodules[moduleID].options = codeOptions;\r\n\t\t\tif (newOption) {\r\n\t\t\t\tRESUtils.options.saveModuleOptions(moduleID);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// nothing in localStorage, let's set the defaults...\r\n\t\t\tRESUtils.options.saveModuleOptions(moduleID);\r\n\t\t}\r\n\t\tthis.getOptionsFirstRun[moduleID] = true;\r\n\t\treturn modules[moduleID].options;\r\n\t},\r\n\tremoveObsoleteOptions: function(moduleID) {\r\n\t\tif (typeof moduleID === 'undefined') {\r\n\t\t\tfor (moduleID in modules) {\r\n\t\t\t\tRESUtils.options.removeObsoleteOptions(moduleID);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (modules[moduleID].hasObsoleteOptions) {\r\n\t\t\tvar moduleOptions = modules[moduleID].options;\r\n\t\t\tfor (var opt in moduleOptions) {\r\n\t\t\t\tif (moduleOptions[opt].obsolete) {\r\n\t\t\t\t\tdelete moduleOptions[opt];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tmodules[moduleID].hasObsoleteOptions = false;\r\n\t\t}\r\n\t}\r\n});\r\n\r\n(function(module) {\r\n\tvar stagedOptions;\r\n\r\n\tclearStagedOptions();\r\n\r\n\tfunction stageOption(moduleID, optionName, optionValue) {\r\n\t\tstagedOptions[moduleID] = stagedOptions[moduleID] || {};\r\n\t\tstagedOptions[moduleID][optionName] = {\r\n\t\t\tvalue: optionValue\r\n\t\t};\r\n\t}\r\n\tfunction commitStagedOptions() {\r\n\t\t$.each(stagedOptions, function(moduleID, module) {\r\n\t\t\t$.each(module, function(optionName, option) {\r\n\t\t\t\tRESUtils.options.setOption(moduleID, optionName, option.value);\r\n\t\t\t});\r\n\t\t});\r\n\t\tclearStagedOptions();\r\n\t}\r\n\tfunction clearStagedOptions() {\r\n\t\tstagedOptions = {};\r\n\t}\r\n\r\n\tfunction hasStagedOptions() {\r\n\t\treturn Object.getOwnPropertyNames(stagedOptions).length;\r\n\t}\r\n\r\n\tfunction getOptions(moduleID) {\r\n\t\treturn stagedOptions[moduleID];\r\n\t}\r\n\r\n\tmodule.reset = clearStagedOptions;\r\n\tmodule.add = stageOption;\r\n\tmodule.commit = commitStagedOptions;\r\n\tmodule.isDirty = hasStagedOptions;\r\n\tmodule.get = getOptions;\r\n})(RESUtils.options.stage = RESUtils.options.stage || {});\r\n"],"sourceRoot":"/source/"}
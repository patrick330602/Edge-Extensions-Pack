{"version":3,"sources":["modules/hideChildComments.js"],"names":[],"mappings":"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","file":"modules/hideChildComments.js","sourcesContent":["addModule('hideChildComments', function(module, moduleID) {\r\n\tmodule.moduleName = 'Hide All Child Comments';\r\n\tmodule.category = 'Comments';\r\n\tmodule.description = 'Allows you to hide all comments except for replies to the OP for easier reading.';\r\n\tmodule.options = {\r\n\t\tautomatic: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Automatically hide all but parent comments, or provide a link to hide them all?'\r\n\t\t}\r\n\t};\r\n\tmodule.include = [\r\n\t\t'comments'\r\n\t];\r\n\tmodule.go = function() {\r\n\t\tif ((this.isEnabled()) && (this.isMatchURL())) {\r\n\t\t\tvar toggleButton = document.createElement('li');\r\n\t\t\tthis.toggleAllLink = document.createElement('a');\r\n\t\t\tthis.toggleAllLink.textContent = 'hide all child comments';\r\n\t\t\tthis.toggleAllLink.setAttribute('action', 'hide');\r\n\t\t\tthis.toggleAllLink.setAttribute('href', '#');\r\n\t\t\tthis.toggleAllLink.setAttribute('title', 'Show only replies to original poster.');\r\n\t\t\tthis.toggleAllLink.addEventListener('click', function(e) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\ttoggleComments(this.getAttribute('action'));\r\n\t\t\t\tif (this.getAttribute('action') === 'hide') {\r\n\t\t\t\t\tthis.setAttribute('action', 'show');\r\n\t\t\t\t\tthis.setAttribute('title', 'Show all comments.');\r\n\t\t\t\t\tthis.textContent = 'show all child comments';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.setAttribute('action', 'hide');\r\n\t\t\t\t\tthis.setAttribute('title', 'Show only replies to original poster.');\r\n\t\t\t\t\tthis.textContent = 'hide all child comments';\r\n\t\t\t\t}\r\n\t\t\t}, true);\r\n\t\t\ttoggleButton.appendChild(this.toggleAllLink);\r\n\t\t\tvar commentMenu = document.querySelector('ul.buttons');\r\n\t\t\tif (commentMenu) {\r\n\t\t\t\tcommentMenu.appendChild(toggleButton);\r\n\t\t\t\tvar rootComments = document.querySelectorAll('div.commentarea > div.sitetable > div.thing > div.child > div.listing');\r\n\t\t\t\tfor (var i = 0, len = rootComments.length; i < len; i++) {\r\n\t\t\t\t\ttoggleButton = document.createElement('li');\r\n\t\t\t\t\tvar toggleLink = document.createElement('a');\r\n\t\t\t\t\ttoggleLink.setAttribute('data-text', 'hide child comments');\r\n\t\t\t\t\ttoggleLink.setAttribute('action', 'hide');\r\n\t\t\t\t\ttoggleLink.setAttribute('href', '#');\r\n\t\t\t\t\ttoggleLink.setAttribute('class', 'toggleChildren noCtrlF');\r\n\t\t\t\t\t// toggleLink.setAttribute('title','Hide child comments.');\r\n\t\t\t\t\ttoggleLink.addEventListener('click', function(e) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\ttoggleComments(this.getAttribute('action'), this);\r\n\t\t\t\t\t}, true);\r\n\t\t\t\t\ttoggleButton.appendChild(toggleLink);\r\n\t\t\t\t\tvar sib = rootComments[i].parentNode.previousSibling;\r\n\t\t\t\t\tif (typeof sib !== 'undefined') {\r\n\t\t\t\t\t\tvar sibMenu = sib.querySelector('ul.buttons');\r\n\t\t\t\t\t\tif (sibMenu) sibMenu.appendChild(toggleButton);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (this.options.automatic.value) {\r\n\t\t\t\t\t// ensure we're not in a permalinked post..\r\n\t\t\t\t\tvar linkRE = /\\/comments\\/(?:\\w+)\\/(?:\\w+)\\/(\\w+)/;\r\n\t\t\t\t\tif (!location.pathname.match(linkRE)) {\r\n\t\t\t\t\t\tRESUtils.click(this.toggleAllLink);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tfunction toggleComments(action, obj) {\r\n\t\tvar commentContainers;\r\n\t\tif (obj) { // toggle a single comment tree\r\n\t\t\tcommentContainers = $(obj).closest('.thing');\r\n\t\t} else { // toggle all comments\r\n\t\t\tcommentContainers = document.querySelectorAll('div.commentarea > div.sitetable > div.thing');\r\n\t\t}\r\n\t\tfor (var i = 0, len = commentContainers.length; i < len; i++) {\r\n\t\t\tvar thisChildren = commentContainers[i].querySelector('div.child > div.sitetable');\r\n\t\t\tvar thisToggleLink = commentContainers[i].querySelector('a.toggleChildren');\r\n\t\t\tif (thisToggleLink) {\r\n\t\t\t\tif (action === 'hide') {\r\n\t\t\t\t\tvar numChildrenElem = commentContainers[i].querySelector('.numchildren'),\r\n\t\t\t\t\t\tnumChildren = parseInt((/\\((\\d+)/).exec(numChildrenElem.textContent)[1], 10);\r\n\t\t\t\t\tif (thisChildren) {\r\n\t\t\t\t\t\tthisChildren.style.display = 'none';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthisToggleLink.setAttribute('data-text', 'show ' + numChildren + ' child comments');\r\n\t\t\t\t\tthisToggleLink.setAttribute('action', 'show');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (thisChildren) {\r\n\t\t\t\t\t\tthisChildren.style.display = 'block';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthisToggleLink.setAttribute('data-text', 'hide child comments');\r\n\t\t\t\t\tthisToggleLink.setAttribute('action', 'hide');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n"],"sourceRoot":"/source/"}
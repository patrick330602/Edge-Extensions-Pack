{"version":3,"sources":["modules/singleClick.js"],"names":[],"mappings":"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","file":"modules/singleClick.js","sourcesContent":["addModule('singleClick', function(module, moduleID) {\r\n\tmodule.moduleName = 'Single Click Opener';\r\n\tmodule.category = 'Browsing';\r\n\tmodule.description = 'Adds an [l+c] link that opens a link and the comments page in new tabs for you in one click.';\r\n\tmodule.options = {\r\n\t\topenOrder: {\r\n\t\t\ttype: 'enum',\r\n\t\t\tvalues: [{\r\n\t\t\t\tname: 'open comments then link',\r\n\t\t\t\tvalue: 'commentsfirst'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'open link then comments',\r\n\t\t\t\tvalue: 'linkfirst'\r\n\t\t\t}],\r\n\t\t\tvalue: 'commentsfirst',\r\n\t\t\tdescription: 'What order to open the link/comments in.'\r\n\t\t},\r\n\t\thideLEC: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Hide the [l=c] when the link is the same as the comments page',\r\n\t\t\tadvanced: true\r\n\t\t},\r\n\t\topenBackground: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Open the [l+c] link in background tabs'\r\n\t\t}\r\n\t};\r\n\tmodule.exclude = [\r\n\t\t'comments',\r\n\t\t/^https?:\\/\\/(?:[\\-\\w\\.]+\\.)?reddit\\.com\\/subreddits\\/?/i\r\n\t];\r\n\tmodule.go = function() {\r\n\t\tif ((this.isEnabled()) && (this.isMatchURL())) {\r\n\t\t\tRESUtils.watchForElement('siteTable', applyLinks);\r\n\t\t\tapplyLinks();\r\n\t\t}\r\n\t};\r\n\tfunction applyLinks(ele) {\r\n\t\tele = ele || document;\r\n\t\tvar entries = ele.querySelectorAll('#siteTable .entry, #siteTable_organic .entry');\r\n\t\tfor (var i = 0, len = entries.length; i < len; i++) {\r\n\t\t\tif ((typeof entries[i] !== 'undefined') && (!entries[i].classList.contains('lcTagged'))) {\r\n\t\t\t\tentries[i].classList.add('lcTagged');\r\n\t\t\t\tvar thisLA = entries[i].querySelector('A.title');\r\n\t\t\t\tif (thisLA !== null) {\r\n\t\t\t\t\tvar thisLink = thisLA.href;\r\n\t\t\t\t\tvar thisComments = (thisComments = entries[i].querySelector('.comments')) && thisComments.href;\r\n\t\t\t\t\tvar thisUL = entries[i].querySelector('ul.flat-list');\r\n\t\t\t\t\tvar singleClickLI = document.createElement('li');\r\n\t\t\t\t\t// changed from a link to a span because you can't cancel a new window on middle click of a link during the mousedown event, and a click event isn't triggered.\r\n\t\t\t\t\tvar singleClickLink = document.createElement('span');\r\n\t\t\t\t\t// singleClickLink.setAttribute('href','javascript:void 0');\r\n\t\t\t\t\tsingleClickLink.setAttribute('class', 'redditSingleClick');\r\n\t\t\t\t\tsingleClickLink.setAttribute('thisLink', thisLink);\r\n\t\t\t\t\tsingleClickLink.setAttribute('thisComments', thisComments);\r\n\t\t\t\t\tif (!$(entries[i]).closest('.thing').hasClass('self')) {\r\n\t\t\t\t\t\tsingleClickLink.textContent = '[l+c]';\r\n\t\t\t\t\t} else if (!(module.options.hideLEC.value)) {\r\n\t\t\t\t\t\tsingleClickLink.textContent = '[l=c]';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsingleClickLI.appendChild(singleClickLink);\r\n\t\t\t\t\tthisUL.appendChild(singleClickLI);\r\n\t\t\t\t\t// we have to switch to mousedown because Webkit is being a douche and not triggering click events on middle click.\r\n\t\t\t\t\t// ?? We should still preventDefault on a click though, maybe?\r\n\t\t\t\t\tsingleClickLink.addEventListener('mousedown', function(e) {\r\n\t\t\t\t\t\tif (e.button !== 2) {\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t// if openBackground is enabled, middle click\r\n\t\t\t\t\t\t\tvar lcMouseBtn = e.button || (module.options.openBackground.value ? 1 : 0);\r\n\t\t\t\t\t\t\t// check if it's a relative link (no http://domain) because chrome barfs on these when creating a new tab...\r\n\t\t\t\t\t\t\tvar thisLink = $(this).parent().parent().parent().find('a.title').attr('href');\r\n\t\t\t\t\t\t\tif (!/^http/i.test(thisLink)) {\r\n\t\t\t\t\t\t\t\tthisLink = location.protocol + '//' + document.domain + thisLink;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tvar thisJSON = {\r\n\t\t\t\t\t\t\t\trequestType: 'singleClick',\r\n\t\t\t\t\t\t\t\tlinkURL: thisLink,\r\n\t\t\t\t\t\t\t\topenOrder: module.options.openOrder.value,\r\n\t\t\t\t\t\t\t\tcommentsURL: this.getAttribute('thisComments'),\r\n\t\t\t\t\t\t\t\tbutton: lcMouseBtn,\r\n\t\t\t\t\t\t\t\tctrl: e.ctrlKey\r\n\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\tRESEnvironment.sendMessage(thisJSON);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, false);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n"],"sourceRoot":"/source/"}
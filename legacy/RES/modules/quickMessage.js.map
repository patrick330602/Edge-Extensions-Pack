{"version":3,"sources":["modules/quickMessage.js"],"names":[],"mappings":"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","file":"modules/quickMessage.js","sourcesContent":["addModule('quickMessage', function(module, moduleID) {\r\n\tmodule.moduleName = 'Quick Message';\r\n\tmodule.category = ['Users', 'My account'];\r\n\tmodule.description = 'A pop-up dialog that allows you to send messages from anywhere on reddit. Messages can be sent from the quick message dialog by pressing control-enter or command-enter.';\r\n\tmodule.options = {\r\n\t\topenQuickMessage: {\r\n\t\t\ttype: 'keycode',\r\n\t\t\tvalue: [77, false, true, false], // control-m\r\n\t\t\tdescription: 'Keyboard shortcut to open the quick message dialog.'\r\n\t\t},\r\n\t\tdefaultSubject: {\r\n\t\t\ttype: 'text',\r\n\t\t\tvalue: '',\r\n\t\t\tdescription: 'Text that will automatically be inserted into the subject field, unless it is auto-filled by context.'\r\n\t\t},\r\n\t\tsendAs: {\r\n\t\t\ttype: 'enum',\r\n\t\t\tvalues: [{\r\n\t\t\t\tname: 'Current user',\r\n\t\t\t\tvalue: 'user'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Current subreddit',\r\n\t\t\t\tvalue: 'sub'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Last selected',\r\n\t\t\t\tvalue: 'last'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Last selected (this page load)',\r\n\t\t\t\tvalue: 'temporary'\r\n\t\t\t}],\r\n\t\t\tvalue: 'user',\r\n\t\t\tdescription: 'The default user or subreddit to select when the \"from\" field is unspecified.<p>Reverts to the current user if the selected option can\\'t be used (i.e. you aren\\'t a moderator of the current subreddit).</p>'\r\n\t\t},\r\n\t\thandleContentLinks: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Open the quick message dialog when clicking on reddit.com/message/compose links in comments, selftext, or wiki pages.'\r\n\t\t},\r\n\t\thandleSideLinks: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Open the quick message dialog when clicking on reddit.com/message/compose links in the sidebar. (e.g. \"message the moderators\")'\r\n\t\t},\r\n\t\tlinkToCurrentPage: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Automatically start with a link to the current page in the message body (or, if opened from the user info popup, a link to the current post or comment).'\r\n\t\t}\r\n\t};\r\n\tvar quickMessageFields = {},\r\n\t\tquickMessageDialog;\r\n\tmodule.go = function() {\r\n\t\tif ((module.isEnabled()) && (module.isMatchURL())) {\r\n\t\t\tRESTemplates.load('quickMessage', function(template) {\r\n\t\t\t\tquickMessageDialog = RESUtils.createElement('div', 'quickMessage');\r\n\t\t\t\t$(quickMessageDialog).html(template.html());\r\n\t\t\t\tdocument.body.appendChild(quickMessageDialog);\r\n\r\n\t\t\t\tquickMessageFields.from = quickMessageDialog.querySelector('#quickMessageDialogFrom');\r\n\t\t\t\tquickMessageFields.to = quickMessageDialog.querySelector('#quickMessageDialogTo');\r\n\t\t\t\tquickMessageFields.subject = quickMessageDialog.querySelector('#quickMessageDialogSubject');\r\n\t\t\t\tquickMessageFields.body = quickMessageDialog.querySelector('#quickMessageDialogBody');\r\n\r\n\t\t\t\tattachEventListeners();\r\n\t\t\t});\r\n\r\n\t\t\tmodules['commandLine'].registerCommand('qm', 'qm [recipient [message]] - open quick message dialog',\r\n\t\t\t\tfunction(command, val, match) {\r\n\t\t\t\t\tvar message = parseCommandLine(val);\r\n\t\t\t\t\tif (message.body) {\r\n\t\t\t\t\t\treturn 'quick message to ' + message.to + ': ' + message.body;\r\n\t\t\t\t\t} else if (message.to) {\r\n\t\t\t\t\t\treturn 'quick message to ' + val;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn 'quick message';\r\n\t\t\t\t}, function(command, val, match, e) {\r\n\t\t\t\t\tvar message = parseCommandLine(val);\r\n\t\t\t\t\tmodule.openQuickMessageDialog(message);\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t};\r\n\tfunction parseCommandLine(val) {\r\n\t\tvar parts = {};\r\n\t\tvar vals = val.match(/^([^\\s]+)(?:\\s(.*))?$/);\r\n\r\n\t\tif (vals) {\r\n\t\t\tparts.to = vals[1];\r\n\t\t\tparts.body = vals[2];\r\n\t\t}\r\n\r\n\t\treturn parts;\r\n\t}\r\n\tvar sendFromLabel;\r\n\tfunction updateModeratorIcon(state) {\r\n\t\tsendFromLabel = sendFromLabel || quickMessageDialog.querySelector('label[for=quickMessageDialogFrom]');\r\n\t\tsendFromLabel.classList.toggle('moderator', state);\r\n\t}\r\n\tfunction attachEventListeners() {\r\n\t\t//keyboard shortcut\r\n\t\twindow.addEventListener('keydown', function(e) {\r\n\t\t\tif (RESUtils.checkKeysForEvent(e, module.options.openQuickMessage.value)) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tmodule.openQuickMessageDialog();\r\n\t\t\t}\r\n\t\t}, true);\r\n\r\n\t\t// close dialog with \"x\" button\r\n\t\tquickMessageDialog.querySelector('#quickMessageDialogClose').addEventListener('click', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tmodule.closeQuickMessageDialog();\r\n\t\t}, false);\r\n\t\t// close dialog with escape key\r\n\t\tquickMessageDialog.addEventListener('keydown', function(e) {\r\n\t\t\tif (e.keyCode === modules['commentTools'].KEYS.ESCAPE) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tmodule.closeQuickMessageDialog();\r\n\t\t\t}\r\n\t\t}, true);\r\n\r\n\t\t// send with \"send message\" button (we would use a 'submit' event listener, but then the user could accidentally send the message by pressing enter)\r\n\t\tquickMessageDialog.querySelector('#quickMessageDialogSend').addEventListener('click', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tsendMessage();\r\n\t\t}, true);\r\n\t\t// send with control-enter\r\n\t\tmodules['commentTools'].onCtrlEnter(\r\n\t\t\t'#quickMessageDialog',\r\n\t\t\tsendMessage\r\n\t\t);\r\n\r\n\t\t// open full message form\r\n\t\tvar fullMessageForm = quickMessageDialog.querySelector('a.fullMessageForm');\r\n\t\tfunction updateUrl(e) { e.target.href = getFullMessageFormUrl(); }\r\n\t\tfullMessageForm.addEventListener('mousedown', updateUrl);\r\n\t\tfullMessageForm.addEventListener('focus', updateUrl); // mousedown isn't fired if you tab over to the button\r\n\t\tfullMessageForm.addEventListener('click', module.closeQuickMessageDialog);\r\n\r\n\t\t$(quickMessageDialog).find('a').on('keypress', function(e) {\r\n\t\t\tif ((e.keyCode || e.which) === 13) {\r\n\t\t\t\t$(e.target).trigger('click');\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// show moderator shield when sending from subreddit and store the user's selection\r\n\t\tquickMessageFields.from.addEventListener('change', function(e) {\r\n\t\t\tupdateModeratorIcon(this.value.substr(0, 3) === '/r/');\r\n\t\t\tRESStorage.setItem('RESmodules.quickMessage.lastSentAs.' + RESUtils.loggedInUser(), this.value);\r\n\t\t});\r\n\r\n\t\tif (module.options.handleContentLinks.value) {\r\n\t\t\t$('div.content[role=\"main\"]').on('click', 'a[href*=\"/message/compose\"]', messageLinkEventHandler);\r\n\t\t}\r\n\t\tif (module.options.handleSideLinks.value) {\r\n\t\t\t$('div.side').on('click', 'a[href*=\"/message/compose\"]', messageLinkEventHandler);\r\n\t\t}\r\n\t}\r\n\tfunction messageLinkEventHandler(event) {\r\n\t\tvar url = event.target.href;\r\n\t\tvar linkRe = /^(?:https?:\\/\\/(?:[\\-\\w\\.]+\\.)?reddit\\.com)?(?:\\/r\\/[\\-\\w\\.]+)?\\/message\\/compose/i;\r\n\t\tif (event.which === 1 && linkRe.test(url)) {\r\n\t\t\tevent.preventDefault();\r\n\r\n\t\t\tvar params = RESUtils.getUrlParams(url),\r\n\t\t\t\tsrMatch = RESUtils.regexes.subreddit.exec(url);\r\n\r\n\t\t\tmodule.openQuickMessageDialog({\r\n\t\t\t\tfrom: srMatch ? ('/r/' + srMatch[1]) : undefined,\r\n\t\t\t\tto: params.to,\r\n\t\t\t\tsubject: params.subject,\r\n\t\t\t\tbody: params.message\r\n\t\t\t});\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\tmodule.onClickMessageLink = function(event) {\r\n\t\tif (!this.isEnabled() || !this.isMatchURL()) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn messageLinkEventHandler(event);\r\n\t};\r\n\t// Executes the callback with an array of objects as the only argument; each object is formatted as follows:\r\n\t// { name: '/u/realUsername' /* or '/r/subreddit' */,\r\n\t//   displayText: '/u/anonymous' /* optional */ }\r\n\tfunction getValidSendFrom(callback) {\r\n\t\tvar username = RESUtils.loggedInUser();\r\n\t\tif (username) {\r\n\t\t\tcallback([{\r\n\t\t\t\tname: '/u/' + username,\r\n\t\t\t\tdisplayText: '/u/' + (modules['usernameHider'].isEnabled() ? modules['usernameHider'].getDisplayText(username) : username)\r\n\t\t\t}]);\r\n\t\t\tvar cacheKey = 'RESUtils.moderatedSubCache.' + username;\r\n\t\t\tif (RESUtils.isModeratorAnywhere()) {\r\n\t\t\t\tRESUtils.cache.fetch({\r\n\t\t\t\t\tkey: cacheKey,\r\n\t\t\t\t\tendpoint: 'subreddits/mine/moderator.json?limit=100&show=all',\r\n\t\t\t\t\thandleData: function(response) {\r\n\t\t\t\t\t\treturn response.data.children.map(function(e) {\r\n\t\t\t\t\t\t\treturn { name: e.data.url.slice(0, -1) };\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcallback: callback\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tRESUtils.cache.expire({key: cacheKey});\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tcallback([]);\r\n\t\t}\r\n\t}\r\n\tvar setUpSendFromDropdownDone = false;\r\n\tfunction setUpSendFromDropdown() {\r\n\t\tif (setUpSendFromDropdownDone) return;\r\n\t\tsetUpSendFromDropdownDone = true;\r\n\t\tgetValidSendFrom(function(senders) {\r\n\t\t\tsenders.forEach(function(userOrSubreddit) {\r\n\t\t\t\tvar currentOption = document.createElement('option');\r\n\t\t\t\tcurrentOption.value = userOrSubreddit.name;\r\n\t\t\t\tcurrentOption.text = userOrSubreddit.displayText || userOrSubreddit.name;\r\n\t\t\t\tquickMessageFields.from.add(currentOption);\r\n\t\t\t});\r\n\t\t\tquickMessageFields.from.disabled = (senders.length < 2);\r\n\t\t});\r\n\t}\r\n\tfunction focusFirstEmpty() {\r\n\t\tvar elems = quickMessageDialog.querySelectorAll('input, textarea');\r\n\t\tfor (var len = elems.length, i = 0; i < len; i++) {\r\n\t\t\tif (!elems[i].value || i === len - 1) {\r\n\t\t\t\telems[i].focus();\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tfunction updateSelectedSender(desiredUser) {\r\n\t\tvar sendAsOptions = Array.prototype.slice.apply(quickMessageFields.from.options)\r\n\t\t\t\t.map(function(e) { return e.textContent.toLowerCase(); }),\r\n\t\t\tindexToSelect = sendAsOptions.indexOf(desiredUser.toLowerCase());\r\n\r\n\t\tif (indexToSelect === -1) {\r\n\t\t\tindexToSelect = 0;\r\n\t\t\tswitch (module.options.sendAs.value) {\r\n\t\t\t\tcase 'sub':\r\n\t\t\t\t\tvar subreddit = '/r/' + RESUtils.currentSubreddit();\r\n\t\t\t\t\tindexToSelect = sendAsOptions.indexOf(subreddit.toLowerCase());\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'last':\r\n\t\t\t\t\tvar lastSelected = RESStorage.getItem('RESmodules.quickMessage.lastSentAs.' + RESUtils.loggedInUser());\r\n\t\t\t\t\tif (lastSelected) {\r\n\t\t\t\t\t\tindexToSelect = sendAsOptions.indexOf(lastSelected.toLowerCase());\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'temporary':\r\n\t\t\t\t\tindexToSelect = quickMessageFields.from.selectedIndex;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//case 'user':\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tindexToSelect = 0;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tquickMessageFields.from.selectedIndex = (indexToSelect !== -1 ? indexToSelect : 0);\r\n\t\tupdateModeratorIcon(quickMessageFields.from.value.substr(0, 3) === '/r/');\r\n\t}\r\n\tmodule.openQuickMessageDialog = function(fields) {\r\n\t\tif (!RESUtils.loggedInUser()) {\r\n\t\t\tmodules['notifications'].showNotification({\r\n\t\t\t\tmoduleID: 'quickMessage',\r\n\t\t\t\tnotificationID: 'quickMessageNoUser',\r\n\t\t\t\theader: 'Not Logged In.',\r\n\t\t\t\tcloseDelay: 3000,\r\n\t\t\t\tmessage: 'You must log in to use the quick message dialog.'\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tsetUpSendFromDropdown();\r\n\r\n\t\tif (!fields) {\r\n\t\t\tfields = {};\r\n\t\t}\r\n\r\n\t\tupdateSelectedSender(fields.from || '');\r\n\t\tquickMessageFields.to.value = fields.to || '';\r\n\t\tquickMessageFields.subject.value = fields.subject || module.options.defaultSubject.value;\r\n\t\tquickMessageFields.body.value = fields.body || (module.options.linkToCurrentPage.value ? location.href : '');\r\n\r\n\t\tRESUtils.fadeElementIn(quickMessageDialog, 0.3);\r\n\t\tmodules['styleTweaks'].setSRStyleToggleVisibility(false, 'quickMessage');\r\n\r\n\t\tfocusFirstEmpty();\r\n\t};\r\n\tmodule.closeQuickMessageDialog = function() {\r\n\t\tRESUtils.fadeElementOut(quickMessageDialog, 0.3);\r\n\t\tmodules['styleTweaks'].setSRStyleToggleVisibility(true, 'quickMessage');\r\n\r\n\t\tif (modules['keyboardNav'].isEnabled()) {\r\n\t\t\tvar inputs = quickMessageDialog.querySelectorAll('INPUT, TEXTAREA, BUTTON');\r\n\t\t\t// remove focus from any input fields from the prompt so that keyboard navigation works again...\r\n\t\t\tfor (var i = 0, len = inputs.length; i < len; i++) {\r\n\t\t\t\tinputs[i].blur();\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tfunction getFullMessageFormUrl() {\r\n\t\tvar subreddit = (quickMessageFields.from.value.substring(0, 3) === '/r/') ? quickMessageFields.from.value : '';\r\n\t\treturn location.protocol + '//' + location.hostname + subreddit + '/message/compose?to=' + encodeURIComponent(quickMessageFields.to.value) +\r\n\t\t\t'&subject=' + encodeURIComponent(quickMessageFields.subject.value) +\r\n\t\t\t'&message=' + encodeURIComponent(quickMessageFields.body.value);\r\n\t}\r\n\tvar presetSendErrors = {\r\n\t\t'NO_USER': 'No recipient specified.',\r\n\t\t'NO_SUBJECT': 'No subject specified.',\r\n\t\t'NO_TEXT': 'Message body is empty.',\r\n\t\t'BAD_CAPTCHA': '<p>Sorry, reddit requires you to enter a captcha to send messages. This is usually because your account is brand new or has low karma.</p><b>Click on \"open full message form\" and try again (your message will be preserved).</b>',\r\n\t\t'TOO_LONG': 'Either your subject (max 100 characters) or body (max 10,000 characters) is too long.'\r\n\t};\r\n\tfunction sendMessage() {\r\n\t\tvar from = quickMessageFields.from.value,\r\n\t\t\tfromSubreddit = (from.substring(0, 3) === '/r/') ? ('&from_sr=' + from.substring(3)) : '';\r\n\t\tRESEnvironment.ajax({\r\n\t\t\tmethod: 'POST',\r\n\t\t\turl: 'https://' + location.hostname + '/api/compose',\r\n\t\t\tdata: 'api_type=json' + fromSubreddit +\r\n\t\t\t\t'&subject=' + encodeURIComponent(quickMessageFields.subject.value) +\r\n\t\t\t\t'&text=' + encodeURIComponent(quickMessageFields.body.value) +\r\n\t\t\t\t'&to=' + encodeURIComponent(quickMessageFields.to.value),\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded',\r\n\t\t\t\t'X-Modhash': RESUtils.loggedInUserHash()\r\n\t\t\t},\r\n\t\t\tonload: function(response) {\r\n\t\t\t\tif (response.status === 200) {\r\n\t\t\t\t\tvar data = safeJSON.parse(response.responseText).json;\r\n\r\n\t\t\t\t\tif (data.errors[0]) {\r\n\t\t\t\t\t\tconsole.error(data);\r\n\r\n\t\t\t\t\t\tmodules['notifications'].showNotification({\r\n\t\t\t\t\t\t\tmoduleID: 'quickMessage',\r\n\t\t\t\t\t\t\tnotificationID: 'quickMessageSendError',\r\n\t\t\t\t\t\t\theader: 'Message not sent.',\r\n\t\t\t\t\t\t\tcloseDelay: 15000,\r\n\t\t\t\t\t\t\tmessage: presetSendErrors[data.errors[0][0]] || (data.errors[0][0] + ' : ' + data.errors[0][1]) // errors[0][0] is the error name, [1] is reddit's description of the error\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmodule.closeQuickMessageDialog();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.error(response);\r\n\r\n\t\t\t\t\tmodules['notifications'].showNotification({\r\n\t\t\t\t\t\tmoduleID: 'quickMessage',\r\n\t\t\t\t\t\tnotificationID: 'failedToSendQuickMessage',\r\n\t\t\t\t\t\theader: 'Sending Failed!',\r\n\t\t\t\t\t\tcloseDelay: 15000,\r\n\t\t\t\t\t\tmessage: 'Reddit is likely under heavy load. Either wait a minute or click on \"open full message form\" and try again (your message will be preserved).'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n});\r\n"],"sourceRoot":"/source/"}
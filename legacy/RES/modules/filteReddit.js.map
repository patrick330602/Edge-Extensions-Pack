{"version":3,"sources":["modules/filteReddit.js"],"names":[],"mappings":"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","file":"modules/filteReddit.js","sourcesContent":["addModule('filteReddit', function(module, moduleID) {\r\n\tmodule.moduleName = 'filteReddit';\r\n\tmodule.category = ['Subreddits', 'Submissions'];\r\n\tmodule.description = 'Filter out NSFW content, or links by keyword, domain (use User Tagger to ignore by user) or subreddit (for /r/all or /domain/*).';\r\n\tmodule.options = {\r\n\t\t// any configurable options you have go here...\r\n\t\t// options must have a type and a value..\r\n\t\t// valid types are: text, boolean (if boolean, value must be true or false)\r\n\t\t// for example:\r\n\t\tNSFWfilter: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Filters all links labelled NSFW'\r\n\t\t},\r\n\t\tnotificationThreshold: {\r\n\t\t\ttype: 'text',\r\n\t\t\tvalue: '80',\r\n\t\t\tdescription: 'If more than this percentage (0-100) of a page is filtered, show a notification',\r\n\t\t\tadvanced: true\r\n\t\t},\r\n\t\tNSFWQuickToggle: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Add a quick NSFW on/off toggle to the gear menu',\r\n\t\t\tadvanced: true\r\n\t\t},\r\n\t\texcludeCommentsPage: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'When visiting the comments page for a filtered link, allow the link/expando to be shown'\r\n\t\t},\r\n\t\texcludeModqueue: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Don\\'t filter anything on modqueue pages (modqueue, reports, spam)'\r\n\t\t},\r\n\t\texcludeUserPages: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Don\\'t filter anything on users\\' profile pages'\r\n\t\t},\r\n\t\tregexpFilters: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tadvanced: true,\r\n\t\t\tdescription: 'Allow RegExp in certain filteReddit fields.' +\r\n\t\t\t\t'<br>If you have filters which start with <code>/</code> and don\\'t know what RegExp is, you should turn this option off.' +\r\n\t\t\t\t'<br>Find out more on the <a href=\"/r/Enhancement/wiki/index/filters/filtereddit/regexp\">/r/Enhancement wiki</a>.'\r\n\t\t},\r\n\t\tkeywords: {\r\n\t\t\ttype: 'table',\r\n\t\t\taddRowText: '+add filter',\r\n\t\t\tfields: [{\r\n\t\t\t\tname: 'keyword',\r\n\t\t\t\ttype: 'text'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'applyTo',\r\n\t\t\t\ttype: 'enum',\r\n\t\t\t\tvalues: [{\r\n\t\t\t\t\tname: 'Everywhere',\r\n\t\t\t\t\tvalue: 'everywhere'\r\n\t\t\t\t}, {\r\n\t\t\t\t\tname: 'Everywhere but:',\r\n\t\t\t\t\tvalue: 'exclude'\r\n\t\t\t\t}, {\r\n\t\t\t\t\tname: 'Only on:',\r\n\t\t\t\t\tvalue: 'include'\r\n\t\t\t\t}],\r\n\t\t\t\tvalue: 'everywhere',\r\n\t\t\t\tdescription: 'Apply filter to:'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'subreddits',\r\n\t\t\t\ttype: 'list',\r\n\t\t\t\tlistType: 'subreddits'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'unlessKeyword',\r\n\t\t\t\ttype: 'text'\r\n\t\t\t}],\r\n\t\t\tvalue: [],\r\n\t\t\tdescription: 'Hide posts with certain keywords in the title.' +\r\n\t\t\t\t'\\n\\n<br><br>RegExp like <code>/(this|that|theother)/i</code> is allowed for keyword (but not unlessKeyword).' +\r\n\t\t\t\t'\\n\\n<br>Find out more on the <a href=\"/r/Enhancement/wiki/index/filters/filtereddit/regexp\">/r/Enhancement wiki</a>.'\r\n\t\t},\r\n\t\tsubreddits: {\r\n\t\t\ttype: 'table',\r\n\t\t\taddRowText: '+add filter',\r\n\t\t\tfields: [{\r\n\t\t\t\tname: 'subreddit',\r\n\t\t\t\ttype: 'text'\r\n\t\t\t}],\r\n\t\t\tvalue: [],\r\n\t\t\tdescription: 'Hide posts submitted to certain subreddits.' +\r\n\t\t\t\t'\\n\\n<br><br>RegExp like <code>/(this|that|theother)/i</code> is allowed for subreddit.' +\r\n\t\t\t\t'\\n\\n<br>Find out more on the <a href=\"/r/Enhancement/wiki/index/filters/filtereddit/regexp\">/r/Enhancement wiki</a>.'\r\n\t\t},\r\n\t\tfilterSubredditsFrom: {\r\n\t\t\ttype: 'enum',\r\n\t\t\tvalue: 'everywhere-except-subreddit',\r\n\t\t\tvalues: [{\r\n\t\t\t\tname: 'Everywhere except inside a subreddit',\r\n\t\t\t\tvalue: 'everywhere-except-subreddit'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Everywhere',\r\n\t\t\t\tvalue: 'everywhere'\r\n\t\t\t}, {\r\n\t\t\t\tname: '/r/all and domain pages',\r\n\t\t\t\tvalue: 'legacy',\r\n\t\t\t}, ]\r\n\t\t},\r\n\t\tdomains: {\r\n\t\t\ttype: 'table',\r\n\t\t\taddRowText: '+add filter',\r\n\t\t\tfields: [{\r\n\t\t\t\tname: 'keyword',\r\n\t\t\t\ttype: 'text'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'applyTo',\r\n\t\t\t\ttype: 'enum',\r\n\t\t\t\tvalues: [{\r\n\t\t\t\t\tname: 'Everywhere',\r\n\t\t\t\t\tvalue: 'everywhere'\r\n\t\t\t\t}, {\r\n\t\t\t\t\tname: 'Everywhere but:',\r\n\t\t\t\t\tvalue: 'exclude'\r\n\t\t\t\t}, {\r\n\t\t\t\t\tname: 'Only on:',\r\n\t\t\t\t\tvalue: 'include'\r\n\t\t\t\t}],\r\n\t\t\t\tvalue: 'everywhere',\r\n\t\t\t\tdescription: 'Apply filter to:'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'subreddits',\r\n\t\t\t\ttype: 'list',\r\n\t\t\t\tlistType: 'subreddits'\r\n\t\t\t}],\r\n\t\t\tvalue: [],\r\n\t\t\tdescription: 'Hide posts that link to certain domains.' +\r\n\t\t\t\t'\\n\\n<br><br>Caution: domain keywords like \"reddit\" would ignore \"reddit.com\" and \"fooredditbar.com\".' +\r\n\t\t\t\t'\\n\\n<br><br>RegExp like <code>/(this|that|theother)/i</code> is allowed for domain.' +\r\n\t\t\t\t'\\n\\n<br>Find out more on the <a href=\"/r/Enhancement/wiki/index/filters/filtereddit/regexp\">/r/Enhancement wiki</a>.'\r\n\t\t},\r\n\t\tflair: {\r\n\t\t\ttype: 'table',\r\n\t\t\taddRowText: '+add filter',\r\n\t\t\tfields: [{\r\n\t\t\t\tname: 'keyword',\r\n\t\t\t\ttype: 'text'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'applyTo',\r\n\t\t\t\ttype: 'enum',\r\n\t\t\t\tvalues: [{\r\n\t\t\t\t\tname: 'Everywhere',\r\n\t\t\t\t\tvalue: 'everywhere'\r\n\t\t\t\t}, {\r\n\t\t\t\t\tname: 'Everywhere but:',\r\n\t\t\t\t\tvalue: 'exclude'\r\n\t\t\t\t}, {\r\n\t\t\t\t\tname: 'Only on:',\r\n\t\t\t\t\tvalue: 'include'\r\n\t\t\t\t}],\r\n\t\t\t\tvalue: 'everywhere',\r\n\t\t\t\tdescription: 'Apply filter to:'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'subreddits',\r\n\t\t\t\ttype: 'list',\r\n\t\t\t\tlistType: 'subreddits'\r\n\t\t\t}],\r\n\t\t\tvalue: [],\r\n\t\t\tdescription: 'Hide in posts where certain keywords are in the post\\'s link flair' +\r\n\t\t\t\t'\\n\\n<br><br>RegExp like <code>/(this|that|theother)/i</code> is allowed for flair.' +\r\n\t\t\t\t'\\n\\n<br>Find out more on the <a href=\"/r/Enhancement/wiki/index/filters/filtereddit/regexp\">/r/Enhancement wiki</a>.'\r\n\t\t},\r\n\t\tallowNSFW: {\r\n\t\t\ttype: 'table',\r\n\t\t\taddRowText: '+add subreddits',\r\n\t\t\tdescription: 'Don\\'t hide NSFW posts from certain subreddits when the NSFW filter is turned on.',\r\n\t\t\tfields: [\r\n\t\t\t\t{\r\n\t\t\t\t\tname: 'subreddits',\r\n\t\t\t\t\ttype: 'list',\r\n\t\t\t\t\tlistType: 'subreddits'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tname: 'where',\r\n\t\t\t\t\ttype: 'enum',\r\n\t\t\t\t\tvalues: [{\r\n\t\t\t\t\t\tname: 'Everywhere',\r\n\t\t\t\t\t\tvalue: 'everywhere'\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: 'When browsing subreddit/multi-subreddit',\r\n\t\t\t\t\t\tvalue: 'visit'\r\n\t\t\t\t\t}],\r\n\t\t\t\t\tvalue: 'everywhere'\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n\t\tcustomFilters: {\r\n\t\t\ttype: 'builder',\r\n\t\t\tadvanced: true, //VERY\r\n\t\t\tdescription: 'Hide posts based on complex custom criteria. <p>This is a very advanced feature, please <a href=\"http://www.reddit.com/r/Enhancement/wiki/customfilters\">read the guide</a> before asking questions.  <p style=\"font-weight: bold; font-size: 16pt;\">This feature is currently in beta. Filters may break in future RES updates.</p>',\r\n\t\t\tvalue: [],\r\n\t\t\taddItemText: '+add custom filter',\r\n\t\t\tdefaultTemplate: function() {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tnote: '', ver: 1,\r\n\t\t\t\t\tbody: {type: 'group', op: 'all', of: [ /* empty */ ]}\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tcases: {\r\n\t\t\t\tgroup: {\r\n\t\t\t\t\tname: 'Group of conditions',\r\n\t\t\t\t\tdefaultTemplate: function(op, of) {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\ttype: 'group',\r\n\t\t\t\t\t\t\top: (op || 'all'),\r\n\t\t\t\t\t\t\tof: (of || [])\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfields: [\r\n\t\t\t\t\t\t{type: 'select', options: ['all', 'any', 'one', 'none'], id: 'op'},\r\n\t\t\t\t\t\t' of these are true:',\r\n\t\t\t\t\t\t{type: 'multi', include: 'all', id: 'of'}\r\n\t\t\t\t\t],\r\n\t\t\t\t\tevaluate: function(thing, data, config) {\r\n\t\t\t\t\t\tif (data.op === 'all') {\r\n\t\t\t\t\t\t\treturn data.of.every(function(condition) {\r\n\t\t\t\t\t\t\t\treturn config[condition.type].evaluate(thing, condition, config);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else if (data.op === 'any') {\r\n\t\t\t\t\t\t\treturn data.of.some(function(condition) {\r\n\t\t\t\t\t\t\t\treturn config[condition.type].evaluate(thing, condition, config);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else if (data.op === 'one') {\r\n\t\t\t\t\t\t\tvar seenTrue = false;\r\n\t\t\t\t\t\t\tfor (var i = 0; i < data.of.length; i++) {\r\n\t\t\t\t\t\t\t\tvar condition = data.of[i];\r\n\t\t\t\t\t\t\t\tvar result = config[condition.type].evaluate(thing, condition, config);\r\n\t\t\t\t\t\t\t\tif (result) {\r\n\t\t\t\t\t\t\t\t\tif (seenTrue) return false;\r\n\t\t\t\t\t\t\t\t\tseenTrue = true;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\treturn seenTrue;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (data.op === 'none') {\r\n\t\t\t\t\t\t\treturn data.of.every(function(condition) {\r\n\t\t\t\t\t\t\t\treturn !config[condition.type].evaluate(thing, condition, config);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthrow new RangeError('Illegal group operator: \"' + data.op + '\"');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tscore: {\r\n\t\t\t\t\tname: 'Score',\r\n\t\t\t\t\tdefaultTemplate: function(op, val) {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\ttype: 'score',\r\n\t\t\t\t\t\t\top: (op || '>'),\r\n\t\t\t\t\t\t\tval: (val || 0)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfields: [\r\n\t\t\t\t\t\t'post has ',\r\n\t\t\t\t\t\t{type: 'select', options: 'COMPARISON', id: 'op'},\r\n\t\t\t\t\t\t' ',\r\n\t\t\t\t\t\t{type: 'number', id: 'val'},\r\n\t\t\t\t\t\t'points'\r\n\t\t\t\t\t],\r\n\t\t\t\t\tevaluate: function(thing, data, config) {\r\n\t\t\t\t\t\tvar score = thing.getScore();\r\n\t\t\t\t\t\tif (typeof score === 'undefined') {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn modules.settingsConsole.numericalCompare(data.op, score, data.val);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsubreddit: {\r\n\t\t\t\t\tname: 'Subreddit',\r\n\t\t\t\t\tdefaultTemplate: function(patt) {\r\n\t\t\t\t\t\treturn {type: 'subreddit', patt: patt || ''};\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfields: [\r\n\t\t\t\t\t\t'posted in /r/', {type: 'text', id: 'patt', validator: RegExp}\r\n\t\t\t\t\t],\r\n\t\t\t\t\tevaluate: function(thing, data, config) {\r\n\t\t\t\t\t\tvar subreddit = thing.getSubreddit();\r\n\t\t\t\t\t\tif (!subreddit) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar pattern = new RegExp('^('+data.patt+')$', 'i');\r\n\t\t\t\t\t\treturn pattern.test(subreddit.trim());\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tusername: {\r\n\t\t\t\t\tname: 'Username',\r\n\t\t\t\t\tdefaultTemplate: function(patt) {\r\n\t\t\t\t\t\treturn {type: 'username', patt: patt || ''};\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfields: [\r\n\t\t\t\t\t\t'posted by /u/', {type: 'text', id: 'patt', validator: RegExp}\r\n\t\t\t\t\t],\r\n\t\t\t\t\tevaluate: function(thing, data, config) {\r\n\t\t\t\t\t\tvar user  = thing.getAuthor();\r\n\t\t\t\t\t\tif (!user) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar pattern = new RegExp('^('+data.patt+')$', 'i');\r\n\t\t\t\t\t\treturn pattern.test(user);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcommentCount: {\r\n\t\t\t\t\tname: 'Comment count',\r\n\t\t\t\t\tdefaultTemplate: function(op, val) {\r\n\t\t\t\t\t\treturn {type: 'commentCount', op: op || '>', val: val || 0};\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfields:[\r\n\t\t\t\t\t\t'post has ',\r\n\t\t\t\t\t\t{type: 'select', options: 'COMPARISON', id: 'op'},\r\n\t\t\t\t\t\t' ',\r\n\t\t\t\t\t\t{type: 'number', id: 'val'},\r\n\t\t\t\t\t\t' comments'\r\n\t\t\t\t\t],\r\n\t\t\t\t\tevaluate: function(thing, data, config) {\r\n\t\t\t\t\t\tvar commentCount = thing.getCommentCount();\r\n\t\t\t\t\t\tif (typeof commentCount !=='number') {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn modules.settingsConsole.numericalCompare(data.op, commentCount, data.val);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tuserAttr: {\r\n\t\t\t\t\tname: 'User attribute (friend/mod/etc...)',\r\n\t\t\t\t\tdefaultTemplate: function(cat) {\r\n\t\t\t\t\t\treturn {type: 'userAttr', attr: cat || 'friend'};\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfields: [\r\n\t\t\t\t\t\t'user is ',\r\n\t\t\t\t\t\t{type: 'select', id: 'attr', options: [\r\n\t\t\t\t\t\t\t['a friend', 'friend'],\r\n\t\t\t\t\t\t\t['a moderator', 'moderator'],\r\n\t\t\t\t\t\t\t['an admin', 'admin'],\r\n\t\t\t\t\t\t\t// ['op', 'submitter]',\r\n\t\t\t\t\t\t\t'me'\r\n\t\t\t\t\t\t]}\r\n\t\t\t\t\t],\r\n\t\t\t\t\tevaluate: function(thing, data, config) {\r\n\t\t\t\t\t\tif (data.attr === 'me') {\r\n\t\t\t\t\t\t\t//No standard marker for my own posts so compare against the logged in user\r\n\t\t\t\t\t\t\tvar myName = RESUtils.loggedInUser();\r\n\t\t\t\t\t\t\tif (!myName) {\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar author = thing.getAuthor().toLowerCase();\r\n\t\t\t\t\t\t\tmyName = myName.trim().toLowerCase();\r\n\r\n\t\t\t\t\t\t\treturn author === myName;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t//The other cases have hardcoded class names\r\n\t\t\t\t\t\t\tvar element = thing.getAuthorElement();\r\n\t\t\t\t\t\t\treturn element.classList.contains(data.attr);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tdomain: {\r\n\t\t\t\t\tname: 'Link domain name',\r\n\t\t\t\t\tdefaultTemplate: function(dom) {\r\n\t\t\t\t\t\treturn {type: 'domain', patt: dom || ''};\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfields: [\r\n\t\t\t\t\t\t'post links to the domain ',\r\n\t\t\t\t\t\t{type: 'text', id: 'patt', validator: RegExp}\r\n\t\t\t\t\t],\r\n\t\t\t\t\tevaluate: function(thing, data, config) {\r\n\t\t\t\t\t\tvar domain = thing.getPostDomain();\r\n\t\t\t\t\t\tif (!domain) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar pattern = new RegExp('^(' + data.patt + ')$', 'i');\r\n\t\t\t\t\t\treturn pattern.test(domain);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tdow: {\r\n\t\t\t\t\tname: 'Day of week',\r\n\t\t\t\t\tdefaultTemplate: function(dom) {\r\n\t\t\t\t\t\treturn {type: 'dow', days: []};\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfields: [\r\n\t\t\t\t\t\t'current day of the week is ',\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttype: 'checkset', id: 'days',\r\n\t\t\t\t\t\t\t//Uses same 3 letter names as\r\n\t\t\t\t\t\t\t//.toLocaleDateString('en-US', {weekday: 'short'}))\r\n\t\t\t\t\t\t\titems: 'Sun,Mon,Tue,Wed,Thu,Fri,Sat'.split(','),\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t],\r\n\t\t\t\t\tevaluate: function(thing, data, config) {\r\n\t\t\t\t\t\t//duplicating because I was having issues with accessing a variable before it was assigned\r\n\t\t\t\t\t\tvar dayList = 'Sun,Mon,Tue,Wed,Thu,Fri,Sat'.split(',');\r\n\t\t\t\t\t\t//Get 3 letter name\r\n\t\t\t\t\t\tvar currentDOW = dayList[new Date().getDay()];\r\n\r\n\t\t\t\t\t\t//At the time of writing Safari doesn't support the toLocaleDateString\r\n\t\t\t\t\t\t// var currentDOW = new Date().toLocaleDateString('en-US', {weekday: 'short'});\r\n\t\t\t\t\t\treturn data.days.indexOf(currentDOW) !== -1;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tlinkFlair: {\r\n\t\t\t\t\tname: 'Link flair',\r\n\t\t\t\t\tdefaultTemplate: function(patt) {\r\n\t\t\t\t\t\treturn {type: 'linkFlair', patt: patt || ''};\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfields: [\r\n\t\t\t\t\t\t'post has link flair matching ',\r\n\t\t\t\t\t\t{type: 'text', id: 'patt', validator: RegExp}\r\n\t\t\t\t\t],\r\n\t\t\t\t\tevaluate: function(thing, data, config) {\r\n\t\t\t\t\t\tvar text = thing.getPostFlairText();\r\n\t\t\t\t\t\tif (!text) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar pattern = new RegExp('^(' + data.patt + ')$', 'i');\r\n\t\t\t\t\t\treturn pattern.test(text.trim());\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tuserFlair: {\r\n\t\t\t\t\tname: 'User flair',\r\n\t\t\t\t\tdefaultTemplate: function(patt) {\r\n\t\t\t\t\t\treturn {type: 'userFlair', patt: patt || ''};\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfields: [\r\n\t\t\t\t\t\t'author of this post has flair matching ',\r\n\t\t\t\t\t\t{type: 'text', id: 'patt', validator: RegExp}\r\n\t\t\t\t\t],\r\n\t\t\t\t\tevaluate: function(thing, data, config) {\r\n\t\t\t\t\t\tvar text = thing.getUserFlairText();\r\n\t\t\t\t\t\tif (!text) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar pattern = new RegExp('^(' + data.patt + ')$', 'i');\r\n\t\t\t\t\t\treturn pattern.test(text);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tpostType: {\r\n\t\t\t\t\tname: 'Post type',\r\n\t\t\t\t\tdefaultTemplate: function(kind) {\r\n\t\t\t\t\t\treturn {type: 'postType', kind: kind || 'link'};\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfields: [\r\n\t\t\t\t\t\t'post is a ', {\r\n\t\t\t\t\t\t\t//id: 'type' results in a collsion\r\n\t\t\t\t\t\t\ttype: 'select', id: 'kind',\r\n\t\t\t\t\t\t\toptions: [\r\n\t\t\t\t\t\t\t\t['link post', 'link'],\r\n\t\t\t\t\t\t\t\t['self post', 'self'],\r\n\t\t\t\t\t\t\t\t// 'comment',\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t}, '.'\r\n\t\t\t\t\t],\r\n\t\t\t\t\tevaluate: function(thing, data, config) {\r\n\t\t\t\t\t\tswitch (data.kind) {\r\n\t\t\t\t\t\t\tcase 'comment': return thing.isComment();\r\n\t\t\t\t\t\t\tcase 'link':    return thing.isSelfPost();\r\n\t\t\t\t\t\t\tcase 'self':    return this.isLinkPost();\r\n\t\t\t\t\t\t\tdefault: throw new Error('unknown post type \"' + data.kind + '\"');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tpostTitle: {\r\n\t\t\t\t\tname: 'Post title',\r\n\t\t\t\t\tdefaultTemplate: function(patt) {\r\n\t\t\t\t\t\treturn {type: 'postTitle', patt: patt || ''};\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfields: [\r\n\t\t\t\t\t\t'post\\'s title contains ', {type: 'text', id: 'patt', validator: RegExp}\r\n\t\t\t\t\t],\r\n\t\t\t\t\tevaluate: function(thing, data, config) {\r\n\t\t\t\t\t\tvar title = thing.getPostTitle();\r\n\t\t\t\t\t\t//Do not anchor for this case\r\n\t\t\t\t\t\treturn new RegExp(data.patt, 'i').test(title);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tpostAge: {\r\n\t\t\t\t\tname: 'Post age',\r\n\t\t\t\t\tdefaultTemplate: function(age) {\r\n\t\t\t\t\t\t//4 hours in milliseconds\r\n\t\t\t\t\t\treturn {type: 'postAge', age: age || 4*60*60*1000};\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfields: [\r\n\t\t\t\t\t\t'post is ',\r\n\t\t\t\t\t\t{type: 'select', id: 'op', options: [\r\n\t\t\t\t\t\t\t['more than', '>'],\r\n\t\t\t\t\t\t\t['less than', '<']\r\n\t\t\t\t\t\t]},\r\n\t\t\t\t\t\t' ', {type: 'duration', id: 'age'}, ' old'\r\n\t\t\t\t\t],\r\n\t\t\t\t\tevaluate: function(thing, data, config) {\r\n\t\t\t\t\t\tvar postTime = thing.getTimestamp();\r\n\t\t\t\t\t\tif (!postTime) {\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar now = new Date();\r\n\t\t\t\t\t\treturn modules.settingsConsole.numericalCompare(data.op, now-postTime, data.age);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcurrentSub: {\r\n\t\t\t\t\tname: 'When browsing a subreddit',\r\n\t\t\t\t\tdefaultTemplate: function(patt) {\r\n\t\t\t\t\t\treturn {type: 'currentSub', patt: patt || ''};\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfields: [\r\n\t\t\t\t\t\t'when browsing /r/',\r\n\t\t\t\t\t\t{type: 'text', id: 'patt', validator: RegExp},\r\n\t\t\t\t\t],\r\n\t\t\t\t\tevaluate: function(thing, data, config) {\r\n\t\t\t\t\t\tvar sub = RESUtils.currentSubreddit();\r\n\t\t\t\t\t\tif (sub === null) return false;\r\n\t\t\t\t\t\treturn new RegExp('^(' + data.patt + ')$', 'i').test(sub);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcurrentUserProfile: {\r\n\t\t\t\t\tname: 'When browsing a user profile',\r\n\t\t\t\t\tdefaultTemplate: function(patt) {\r\n\t\t\t\t\t\treturn {type: 'currentUserProfile', patt: patt || ''};\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfields: [\r\n\t\t\t\t\t\t'when browsing /u/',\r\n\t\t\t\t\t\t{type: 'text', id: 'patt', validator: RegExp},\r\n\t\t\t\t\t\t'\\'s posts',\r\n\t\t\t\t\t],\r\n\t\t\t\t\tevaluate: function(thing, data, config) {\r\n\t\t\t\t\t\tvar user = RESUtils.currentUserProfile();\r\n\t\t\t\t\t\tif (user === null) return false;\r\n\t\t\t\t\t\treturn new RegExp('^(' + data.patt + ')$', 'i').test(user);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcurrentMulti: {\r\n\t\t\t\t\tname: 'When browsing a multireddit',\r\n\t\t\t\t\tdefaultTemplate: function(user, name) {\r\n\t\t\t\t\t\treturn {type: 'currentMulti', user: user || '', name: name || ''};\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfields: [\r\n\t\t\t\t\t\t'when browsing /u/',\r\n\t\t\t\t\t\t{type: 'text', id: 'user', validator: RegExp},\r\n\t\t\t\t\t\t'/m/',\r\n\t\t\t\t\t\t{type: 'text', id: 'name', validator: RegExp},\r\n\t\t\t\t\t],\r\n\t\t\t\t\tevaluate: function(thing, data, config) {\r\n\t\t\t\t\t\tvar parts = /^(?:user\\/)?([a-z0-9_-]+)\\/m\\/([a-z0-9_-]+)$/i\r\n\t\t\t\t\t\t\t.exec(RESUtils.currentMultireddit());\r\n\t\t\t\t\t\tif (parts === null) return false;\r\n\t\t\t\t\t\tvar multiNameRE = data.name.trim() === '' ? /.*/ : new RegExp('^(' + data.name + ')$', 'i');\r\n\t\t\t\t\t\tvar user = parts[1], multi = parts[2];\r\n\t\t\t\t\t\tif (user === 'me' && data.name.trim() === 'me') {\r\n\t\t\t\t\t\t\treturn multiNameRE.test(multi);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn (data.user.trim() === '' ? /.*/ : new RegExp('^(' + data.user + ')$', 'i')).test(user) && multiNameRE.test(multi);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tbrowsingFrontPage: {\r\n\t\t\t\t\tname: 'Browsing the front page',\r\n\t\t\t\t\tdefaultTemplate: function() {\r\n\t\t\t\t\t\treturn {type: 'browsingFrontPage'};\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfields: [\r\n\t\t\t\t\t\t'when browsing the front page',\r\n\t\t\t\t\t],\r\n\t\t\t\t\tevaluate: function(thing, data, config) {\r\n\t\t\t\t\t\treturn RESUtils.pageType() === 'linklist' &&\r\n\t\t\t\t\t\t\tRESUtils.currentSubreddit() === null &&\r\n\t\t\t\t\t\t\tRESUtils.currentMultireddit() === null &&\r\n\t\t\t\t\t\t\tRESUtils.currentUserProfile() === null;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tisNSFW: {\r\n\t\t\t\t\tname: 'NSFW post',\r\n\t\t\t\t\tdefaultTemplate: function() {\r\n\t\t\t\t\t\treturn {type: 'isNSFW'};\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfields: [\r\n\t\t\t\t\t\t'post is marked NSFW',\r\n\t\t\t\t\t],\r\n\t\t\t\t\tevaluate: function(thing, data, config) {\r\n\t\t\t\t\t\treturn thing.classList.contains('over18');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\ttoggle: {\r\n\t\t\t\t\tname: 'Custom toggle',\r\n\t\t\t\t\tdefaultTemplate: function() {\r\n\t\t\t\t\t\tvar toggleName = '';\r\n\t\t\t\t\t\tvar toggles = modules['customToggles'].options.toggle.value;\r\n\t\t\t\t\t\tif (toggles && toggles.length === 1) {\r\n\t\t\t\t\t\t\ttoggleName = toggles[0][0];\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\ttype: 'toggle',\r\n\t\t\t\t\t\t\ttoggleName: toggleName\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfields: [\r\n\t\t\t\t\t\t'custom toggle named',\r\n\t\t\t\t\t\t{type: 'text', id: 'toggleName', validator: RegExp},\r\n\t\t\t\t\t\t'is turned on'\r\n\t\t\t\t\t],\r\n\t\t\t\t\tevaluate: function(thing, data, config) {\r\n\t\t\t\t\t\tvar toggleName = data.toggleName;\r\n\t\t\t\t\t\treturn modules['customToggles'].toggleActive(toggleName);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t/*\r\n\t\t\t\tpossible for later:\r\n\r\n\t\t\t\tres tag\r\n\t\t\t\tres score\r\n\t\t\t\tup/down/unvoted\r\n\t\t\t\tsort\r\n\t\t\t\t//*/\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tmodule.include = [\r\n\t\t'linklist',\r\n\t\t'profile',\r\n\t\t'comments',\r\n\t\t'search'\r\n\t];\r\n\tmodule.exclude = [\r\n\t\t// /^https?:\\/\\/(?:[-\\w\\.]+\\.)?reddit\\.com\\/[-\\w\\.\\/]+\\/comments\\/[-\\w\\.]+/i,\r\n\t\t// /^https?:\\/\\/(?:[-\\w\\.]+\\.)?reddit\\.com\\/comments\\/[-\\w\\.]+/i\r\n\t\t/^https?:\\/\\/(?:[\\-\\w\\.]+\\.)?reddit\\.com\\/over18.*/i\r\n\t];\r\n\r\n\tvar excludeSaved = /^https?:\\/\\/(?:[\\-\\w\\.]+\\.)?reddit\\.com\\/user\\/[\\w]+\\/saved/i;\r\n\tvar excludeModqueue = /^https?:\\/\\/(?:[\\-\\w\\.]+\\.)?reddit\\.com\\/r\\/[\\-\\w\\.]+\\/about\\/(?:modqueue|reports|spam)\\/?/i;\r\n\r\n\tmodule.isMatchURL = function() {\r\n\t\tif (\r\n\t\t\tthis.options.excludeModqueue.value && excludeModqueue.test(location.href) ||\r\n\t\t\tthis.options.excludeUserPages.value && RESUtils.pageType() === 'profile'\r\n\t\t) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn RESUtils.isMatchURL(moduleID);\r\n\t};\r\n\tmodule.beforeLoad = function() {\r\n\t\tif (this.isEnabled() && this.isMatchURL()) {\r\n\t\t\tfilterNSFW(this.options.NSFWfilter.value);\r\n\t\t}\r\n\t};\r\n\r\n\tvar nsfwSwitchToggle;\r\n\r\n\tmodule.go = function() {\r\n\t\t// shh I'm cheating. This runs the toggle on every single page, bypassing isMatchURL.\r\n\t\tif ((this.isEnabled()) && (this.options.NSFWQuickToggle.value)) {\r\n\t\t\tvar thisFrag = document.createDocumentFragment(),\r\n\t\t\t\ttoggleOn, toggleOff;\r\n\r\n\t\t\ttoggleOn = RESUtils.createElement('span', null, 'toggleOn', 'on');\r\n\t\t\ttoggleOff = RESUtils.createElement('span', null, 'toggleOff', 'off');\r\n\t\t\tvar nsfwSwitch = document.createElement('div');\r\n\t\t\tnsfwSwitch.setAttribute('title', 'Toggle NSFW Filter');\r\n\t\t\tvar onClickSwitch = function(e) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\ttoggleNsfwFilter();\r\n\t\t\t};\r\n\t\t\tnsfwSwitch.textContent = 'nsfw filter';\r\n\t\t\tnsfwSwitchToggle = RESUtils.createElement('div', 'nsfwSwitchToggle', 'toggleButton');\r\n\t\t\tnsfwSwitchToggle.appendChild(toggleOn);\r\n\t\t\tnsfwSwitchToggle.appendChild(toggleOff);\r\n\t\t\tnsfwSwitch.appendChild(nsfwSwitchToggle);\r\n\t\t\tif (this.options.NSFWfilter.value) {\r\n\t\t\t\tnsfwSwitchToggle.classList.add('enabled');\r\n\t\t\t} else {\r\n\t\t\t\tnsfwSwitchToggle.classList.remove('enabled');\r\n\t\t\t}\r\n\t\t\tthisFrag.appendChild(nsfwSwitch);\r\n\t\t\tmodules['RESMenu'].addMenuItem(nsfwSwitch, onClickSwitch);\r\n\t\t}\r\n\r\n\t\tif ((this.isEnabled()) && (this.isMatchURL())) {\r\n\t\t\tscanEntries();\r\n\t\t\tRESUtils.watchForElement('siteTable', scanEntries);\r\n\r\n\t\t\tmodules['commandLine'].registerCommand('nsfw', 'nsfw [on|off] - toggle nsfw filter on/off',\r\n\t\t\t\tfunction(command, val, match) {\r\n\t\t\t\t\treturn 'Toggle nsfw filter on or off';\r\n\t\t\t\t}, function(command, val, match, e) {\r\n\t\t\t\t\tvar toggle;\r\n\t\t\t\t\tswitch (val && val.toLowerCase()) {\r\n\t\t\t\t\t\tcase 'on':\r\n\t\t\t\t\t\t\ttoggle = true;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'off':\r\n\t\t\t\t\t\t\ttoggle = false;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\treturn 'nsfw on &nbsp; or &nbsp; nsfw off ?';\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttoggleNsfwFilter(toggle, true);\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t};\r\n\r\n\tfunction toggleNsfwFilter(toggle, notify) {\r\n\t\tif (toggle === false || module.options.NSFWfilter.value) {\r\n\t\t\tfilterNSFW(false);\r\n\t\t\tRESUtils.options.setOption('filteReddit', 'NSFWfilter', false);\r\n\t\t\t$(nsfwSwitchToggle).removeClass('enabled');\r\n\t\t} else {\r\n\t\t\tfilterNSFW(true);\r\n\t\t\tRESUtils.options.setOption('filteReddit', 'NSFWfilter', true);\r\n\t\t\t$(nsfwSwitchToggle).addClass('enabled');\r\n\t\t}\r\n\r\n\t\tif (notify) {\r\n\t\t\tvar onOff = module.options.NSFWfilter.value ? 'on' : ' off';\r\n\r\n\t\t\tmodules['notifications'].showNotification({\r\n\t\t\t\theader: 'NSFW Filter',\r\n\t\t\t\tmoduleID: 'filteReddit',\r\n\t\t\t\toptionKey: 'NSFWfilter',\r\n\t\t\t\tmessage: 'NSFW Filter has been turned ' + onOff + '.'\r\n\t\t\t}, 4000);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction scanEntries(ele) {\r\n\t\tif (module.options.excludeCommentsPage.value && RESUtils.isPageType('comments')) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar numFiltered = 0;\r\n\t\tvar numNsfwHidden = 0;\r\n\r\n\t\tvar things = RESUtils.things(ele);\r\n\r\n\t\t// var RALLre = /\\/r\\/all\\/?(([\\w]+)\\/)?/i;\r\n\t\t// var onRALL = RALLre.exec(location.href);\r\n\t\tvar filterSubs = (module.options.filterSubredditsFrom.value === 'everywhere') ||\r\n\t\t\t(module.options.filterSubredditsFrom.value === 'everywhere-except-subreddit' && !RESUtils.currentSubreddit()) ||\r\n\t\t\t(RESUtils.currentSubreddit('all')) || (RESUtils.currentDomain()) || (RESUtils.currentMultireddit('me/f/all')),\r\n\t\t\tonSavedPage = excludeSaved.test(location.href);\r\n\r\n\t\tthings.forEach(function(thing) {\r\n\t\t\tvar currSub, postTitle, postDomain, postSubreddit, postFlair;\r\n\t\t\tvar filtered;\r\n\t\t\tif (thing.isPost() && !onSavedPage) {\r\n\t\t\t\tpostTitle = thing.getTitle();\r\n\t\t\t\tpostDomain = thing.getPostDomain();\r\n\t\t\t\tpostSubreddit = thing.getSubreddit();\r\n\t\t\t\tpostFlair = thing.getPostFlairText();\r\n\r\n\t\t\t\tfiltered = executeCustomFilters(thing);\r\n\r\n\t\t\t\tcurrSub = (RESUtils.currentSubreddit()) ? RESUtils.currentSubreddit().toLowerCase() : null;\r\n\t\t\t\tif (!filtered) filtered = filterTitle(postTitle, postSubreddit);\r\n\t\t\t\tif (!filtered) filtered = filterDomain(postDomain, postSubreddit || currSub);\r\n\t\t\t\tif ((!filtered) && (filterSubs) && (postSubreddit)) {\r\n\t\t\t\t\tfiltered = filterSubreddit(postSubreddit);\r\n\t\t\t\t}\r\n\t\t\t\tif ((!filtered) && (postFlair)) {\r\n\t\t\t\t\tfiltered = filterFlair(postFlair, postSubreddit);\r\n\t\t\t\t}\r\n\t\t\t\tif (filtered) {\r\n\t\t\t\t\tthing.element.classList.add('RESFiltered');\r\n\t\t\t\t\tnumFiltered++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (thing.isNSFW()) {\r\n\t\t\t\tif (allowNSFW(postSubreddit, currSub)) {\r\n\t\t\t\t\tthing.entry.classList.add('allowOver18');\r\n\t\t\t\t} else if (module.options.NSFWfilter.value) {\r\n\t\t\t\t\tif (!thing.element.classList.contains('over18')) {\r\n\t\t\t\t\t\t// backfill for new post layout\r\n\t\t\t\t\t\tthing.element.classList.add('over18');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnumNsfwHidden++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tvar notificationThreshold = parseInt(module.options.notificationThreshold.value, 10);\r\n\t\tif (typeof notificationThreshold !== 'number' || isNaN(notificationThreshold)) {\r\n\t\t\tnotificationThreshold = module.options.notificationThreshold.default;\r\n\t\t}\r\n\t\tnotificationThreshold = Math.max(0, Math.min(notificationThreshold, 110)); // so users can go the extra 10% to avoid notifications completely\r\n\t\tnotificationThreshold /= 100;\r\n\r\n\t\tvar percentageHidden = (numFiltered + numNsfwHidden) / things.length;\r\n\t\tif (things.length && percentageHidden >= notificationThreshold) {\r\n\t\t\tvar notification = [];\r\n\t\t\tif (!percentageHidden) notification.push('No posts were filtered.');\r\n\t\t\tif (numFiltered) notification.push(numFiltered + ' post(s) hidden by ' + modules['settingsNavigation'].makeUrlHashLink('filteReddit', 'keywords', 'custom filters') + '.');\r\n\t\t\tif (numNsfwHidden) notification.push(numNsfwHidden + ' post(s) hidden by the ' + modules['settingsNavigation'].makeUrlHashLink('filteReddit', 'NSFWfilter', 'NSFW filter') + '.');\r\n\t\t\tif (numNsfwHidden && module.options.NSFWQuickToggle.value) notification.push('You can toggle the nsfw filter in the <span class=\"gearIcon\"></span> menu.');\r\n\r\n\t\t\tnotification = notification.join('<br><br>');\r\n\t\t\tmodules['notifications'].showNotification({\r\n\t\t\t\theader: 'Posts Filtered',\r\n\t\t\t\tmoduleID: 'filteReddit',\r\n\t\t\t\tmessage: notification\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tfunction filterNSFW(filterOn) {\r\n\t\tif (filterOn) {\r\n\t\t\tRESUtils.bodyClasses.add('hideOver18');\r\n\t\t} else {\r\n\t\t\tRESUtils.bodyClasses.remove('hideOver18');\r\n\t\t}\r\n\t}\r\n\r\n\tfunction filterTitle(title, reddit) {\r\n\t\treddit = reddit ? reddit.toLowerCase() : null;\r\n\t\treturn filtersMatchString('keywords', title.toLowerCase(), reddit);\r\n\t}\r\n\r\n\tfunction filterDomain(domain, reddit) {\r\n\t\tdomain = domain ? domain.toLowerCase() : null;\r\n\t\treddit = reddit ? reddit.toLowerCase() : null;\r\n\t\treturn filtersMatchString('domains', domain, reddit);\r\n\t}\r\n\r\n\tvar filterFormatChecked;\r\n\r\n\tfunction filterSubreddit(subreddit) {\r\n\t\t// check for /r/ hack from when reddit changed its format and broke RES filters\r\n\t\tif (!filterFormatChecked) {\r\n\t\t\tcheckFilterFormat();\r\n\t\t}\r\n\t\treturn filtersMatchString('subreddits', subreddit.toLowerCase(), null, true);\r\n\t}\r\n\r\n\tfunction filterFlair(flair, reddit) {\r\n\t\treddit = reddit ? reddit.toLowerCase() : null;\r\n\t\treturn filtersMatchString('flair', flair.toLowerCase(), reddit);\r\n\t}\r\n\r\n\tfunction checkFilterFormat() {\r\n\t\tvar changed = false;\r\n\r\n\t\tmodule.options.subreddits.value.forEach(function(subreddit) {\r\n\t\t\tvar check = subreddit[0];\r\n\t\t\tif (check.substr(0, 3) === '/r/') {\r\n\t\t\t\tsubreddit[0] = check.substr(3);\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (changed) {\r\n\t\t\tRESUtils.options.saveModuleOptions('filteReddit');\r\n\t\t}\r\n\t\tfilterFormatChecked = true;\r\n\t}\r\n\r\n\tvar _filters = {};\r\n\r\n\tfunction getFilters(type) {\r\n\t\tvar sources = module.options[type].value;\r\n\t\tif (!_filters[type] || _filters[type].length !== sources.length) {\r\n\t\t\tvar filters = [];\r\n\t\t\t_filters[type] = filters;\r\n\r\n\t\t\tsources.forEach(function(source) {\r\n\t\t\t\tvar filter = {};\r\n\t\t\t\tfilters.push(filter);\r\n\r\n\t\t\t\tif (typeof source !== 'object') {\r\n\t\t\t\t\tsource = [ source ];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar searchString = source[0];\r\n\t\t\t\tif (module.options.regexpFilters.value && regexRegex.test(searchString)) {\r\n\t\t\t\t\tvar regexp = regexRegex.exec(searchString);\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tsearchString = new RegExp(regexp[1], regexp[2]);\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\tmodules['notifications'].showNotification({\r\n\t\t\t\t\t\t\tmoduleID: 'filteReddit',\r\n\t\t\t\t\t\t\toptionKey: type,\r\n\t\t\t\t\t\t\tnotificationID: 'badRegexpPattern',\r\n\t\t\t\t\t\t\theader: 'filteReddit RegExp issue',\r\n\t\t\t\t\t\t\tmessage: 'There was a problem parsing a RegExp in your filteReddit settings. ' +\r\n\t\t\t\t\t\t\t\tmodules['settingsNavigation'].makeUrlHashLink('filteReddit', type, 'Correct it now.') +\r\n\t\t\t\t\t\t\t\t'<p>RegExp: <code>' + RESUtils.sanitizeHTML(searchString) + '</code></p>' +\r\n\t\t\t\t\t\t\t\t'<blockquote>' + e.toString() + '</blockquote>'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsearchString = searchString.toString().toLowerCase();\r\n\t\t\t\t}\r\n\t\t\t\tfilter.searchString = searchString;\r\n\r\n\t\t\t\tvar applyTo = source[1] || 'everywhere';\r\n\t\t\t\tfilter.applyTo = applyTo;\r\n\r\n\t\t\t\tvar applyList = (source[2] || '').toLowerCase().split(',');\r\n\t\t\t\tfilter.applyList = applyList;\r\n\r\n\t\t\t\tvar exceptSearchString = source[3] && source[3].toString().toLowerCase() || '';\r\n\t\t\t\tfilter.exceptSearchString = exceptSearchString;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn _filters[type];\r\n\t}\r\n\r\n\tvar allowAllNsfw = null; // lazy loaded with boolean-y value\r\n\tvar subredditAllowNsfwOption = null; // lazy loaded with function to get a given subreddit's row in module.options.allowNSFW\r\n\r\n\tfunction allowNSFW(postSubreddit, currSubreddit) {\r\n\t\tif (!module.options.allowNSFW.value || !module.options.allowNSFW.value.length) return false;\r\n\r\n\t\tif (typeof currSubreddit === 'undefined') {\r\n\t\t\tcurrSubreddit = RESUtils.currentSubreddit();\r\n\t\t}\r\n\r\n\t\tif (!subredditAllowNsfwOption) {\r\n\t\t\tsubredditAllowNsfwOption = RESUtils.indexOptionTable('filteReddit', 'allowNSFW', 0);\r\n\t\t}\r\n\r\n\t\tif (allowAllNsfw === null && currSubreddit) {\r\n\t\t\tvar currOptionValue = subredditAllowNsfwOption(currSubreddit);\r\n\t\t\tallowAllNsfw = (currOptionValue && currOptionValue[0][1] === 'visit') || false;\r\n\t\t}\r\n\t\tif (allowAllNsfw) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tif (!postSubreddit) postSubreddit = currSubreddit;\r\n\t\tif (!postSubreddit) return false;\r\n\t\tvar postOptionValue = subredditAllowNsfwOption(postSubreddit);\r\n\t\tif (postOptionValue) {\r\n\t\t\tif (postOptionValue[0][1] === 'everywhere') {\r\n\t\t\t\treturn true;\r\n\t\t\t} else { // optionValue[1] == visit (subreddit or multisubreddit)\r\n\t\t\t\tif (RESUtils.inList(postSubreddit, currSubreddit, '+')) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tvar regexRegex = /^\\/(.*)\\/([gim]+)?$/;\r\n\r\n\tfunction filtersMatchString(filterType, stringToSearch, reddit, fullmatch) {\r\n\t\tvar filters = getFilters(filterType);\r\n\t\tif (!filters || !filters.length) return false;\r\n\t\tif (!stringToSearch) {\r\n\t\t\t// this means a bad filter of some sort...\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar i = filters.length;\r\n\t\tvar result = false;\r\n\r\n\t\twhile (i--) {\r\n\t\t\tvar filter = filters[i];\r\n\t\t\tvar skipCheck = false;\r\n\r\n\t\t\t// we also want to know if we should be matching /r/all, because when getting\r\n\t\t\t// listings on /r/all, each post has a subreddit (that does not equal \"all\")\r\n\t\t\tvar checkRAll = ((RESUtils.currentSubreddit() === 'all') && (filter.applyList.indexOf('all') !== -1));\r\n\t\t\tswitch (filter.applyTo) {\r\n\t\t\t\tcase 'exclude':\r\n\t\t\t\t\tif ((filter.applyList.indexOf(reddit) !== -1) || (checkRAll)) {\r\n\t\t\t\t\t\tskipCheck = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'include':\r\n\t\t\t\t\tif ((filter.applyList.indexOf(reddit) === -1) && (!checkRAll)) {\r\n\t\t\t\t\t\tskipCheck = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tif (!skipCheck && filter.exceptSearchString.length && stringToSearch.indexOf(filter.exceptSearchString) !== -1) {\r\n\t\t\t\tskipCheck = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (skipCheck) {\r\n\t\t\t\t// skip checking this filter, duh\r\n\t\t\t\tcontinue;\r\n\t\t\t} else if (filter.searchString.test) {\r\n\t\t\t\t// filter is a regex\r\n\t\t\t\tif (filter.searchString.test(stringToSearch)) {\r\n\t\t\t\t\tresult = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else if (fullmatch) {\r\n\t\t\t\t// simple full string match\r\n\t\t\t\tif (stringToSearch === filter.searchString) {\r\n\t\t\t\t\tresult = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// simple in-string match\r\n\t\t\t\tif (stringToSearch.indexOf(filter.searchString) !== -1) {\r\n\t\t\t\t\tresult = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tmodule.toggleFilter = function(e) {\r\n\t\tvar thisSubreddit = $(e.target).data('subreddit').toLowerCase();\r\n\t\tvar filteredReddits = module.options.subreddits.value || [];\r\n\t\tvar message;\r\n\t\tvar subredditIndex = filteredReddits.findIndex(function(reddit) {\r\n\t\t\treturn reddit && reddit[0].toLowerCase() === thisSubreddit;\r\n\t\t});\r\n\t\tif (subredditIndex !== -1) {\r\n\t\t\tfilteredReddits.splice(subredditIndex, 1);\r\n\t\t\te.target.setAttribute('title', 'Filter this subreddit from /r/all and /domain/*');\r\n\t\t\te.target.textContent = '+filter';\r\n\t\t\te.target.classList.remove('remove');\r\n\t\t\tmessage = 'No longer filtering submissions from /r/' + thisSubreddit + '.';\r\n\t\t} else {\r\n\t\t\tfilteredReddits.push([thisSubreddit, 'everywhere', '']);\r\n\t\t\te.target.setAttribute('title', 'Stop filtering this subreddit from /r/all and /domain/*');\r\n\t\t\te.target.textContent = '-filter';\r\n\t\t\te.target.classList.add('remove');\r\n\t\t\tmessage = 'Submissions from /r/' + thisSubreddit + ' will be hidden from listings.';\r\n\t\t}\r\n\t\tmodules['notifications'].showNotification({\r\n\t\t\tmoduleID: 'filteReddit',\r\n\t\t\tnotificationID: 'filterSubreddit',\r\n\t\t\tmessage: message\r\n\t\t});\r\n\t\tmodule.options.subreddits.value = filteredReddits;\r\n\t\t// save change to options...\r\n\t\tRESUtils.options.saveModuleOptions('filteReddit');\r\n\t};\r\n\r\n\tfunction executeCustomFilters(thing) {\r\n\t\tvar advancedFilterOptions = module.options.customFilters;\r\n\t\tvar filters = advancedFilterOptions.value,\r\n\t\t\tconfig = advancedFilterOptions.cases;\r\n\t\treturn filters.some(function(filter) {\r\n\t\t\treturn config[filter.body.type].evaluate(thing, filter.body, config);\r\n\t\t});\r\n\t}\r\n});\r\n"],"sourceRoot":"/source/"}
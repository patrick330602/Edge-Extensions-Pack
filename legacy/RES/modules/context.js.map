{"version":3,"sources":["modules/context.js"],"names":[],"mappings":";;AAAA,UAAU,SAAV,EAAqB,UAAS,MAAT,EAAiB,QAAjB,EAA2B;AAC/C,QAAO,UAAP,GAAoB,SAApB,CAD+C;AAE/C,QAAO,QAAP,GAAkB,UAAlB,CAF+C;AAG/C,QAAO,WAAP,GAAqB,yFAArB,CAH+C;AAI/C,QAAO,OAAP,GAAiB;AAChB,mBAAiB;AAChB,SAAM,SAAN;AACA,UAAO,IAAP;AACA,gBAAa,2DAAb;GAHD;AAKA,kBAAgB;AACf,SAAM,MAAN;AACA,UAAO,GAAP;AACA,gBAAa,kDAAb;GAHD;EAND,CAJ+C;AAgB/C,QAAO,OAAP,GAAiB,CAChB,UADgB,EAEhB,OAFgB,EAGhB,SAHgB,CAAjB,CAhB+C;AAqB/C,QAAO,EAAP,GAAY,YAAW;AACtB,MAAI,KAAK,SAAL,MAAoB,KAAK,UAAL,EAApB,EAAuC;AAC1C,OAAI,SAAS,UAAT,CAAoB,UAApB,KAAmC,KAAK,OAAL,CAAa,eAAb,CAA6B,KAA7B,EAAoC;AAC1E,yBAD0E;IAA3E;AAGA,OAAI,SAAS,UAAT,CAAoB,OAApB,EAA6B,SAA7B,KAA2C,CAAC,MAAM,KAAK,OAAL,CAAa,cAAb,CAA4B,KAA5B,CAAP,IAA6C,KAAK,OAAL,CAAa,cAAb,CAA4B,KAA5B,IAAqC,CAArC,EAAwC;AACnI,wBADmI;AAEnI,aAAS,eAAT,CAAyB,WAAzB,EAAsC,iBAAtC,EAFmI;IAApI;GAJD;EADW,CArBmC;;AAiC/C,UAAS,kBAAT,GAA8B;AAC7B,MAAI,SAAS,MAAT,KAAoB,gBAApB,EAAsC;AACzC,OAAI,WAAW,SAAS,aAAT,CAAuB,gCAAvB,CAAX,CADqC;AAEzC,OAAI,QAAJ,EAAc;;AAEb,QAAI,EAAE,yCAAF,EAA6C,MAA7C,GAAsD,CAAtD,EAAyD;;AAC5D,cAAS,SAAT,IAAsB,iEAAtB,CAD4D;KAA7D;IAFD;GAFD;EADD;;AAYA,UAAS,iBAAT,CAA2B,GAA3B,EAAgC;AAC/B,QAAM,OAAO,QAAP,CADyB;AAE/B,IAAE,GAAF,EAAO,IAAP,CAAY,SAAZ,EAAuB,IAAvB,CAA4B,YAAW;AACtC,QAAK,YAAL,CAAkB,MAAlB,EAA0B,KAAK,YAAL,CAAkB,MAAlB,EAA0B,OAA1B,CAAkC,mBAAlC,EAAuD,cAAc,OAAO,OAAP,CAAe,cAAf,CAA8B,KAA9B,CAA/F,EADsC;GAAX,CAA5B,CAF+B;EAAhC;CA7CoB,CAArB","file":"modules/context.js","sourcesContent":["addModule('context', function(module, moduleID) {\r\n\tmodule.moduleName = 'Context';\r\n\tmodule.category = 'Comments';\r\n\tmodule.description = 'Adds a link to the yellow infobar to view deeply linked comments in their full context.';\r\n\tmodule.options = {\r\n\t\tviewFullContext: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Add a \"View the Full Context\" link when on a comment link'\r\n\t\t},\r\n\t\tdefaultContext: {\r\n\t\t\ttype: 'text',\r\n\t\t\tvalue: '3',\r\n\t\t\tdescription: 'Change the default context value on context link'\r\n\t\t}\r\n\t};\r\n\tmodule.include = [\r\n\t\t'comments',\r\n\t\t'inbox',\r\n\t\t'profile'\r\n\t];\r\n\tmodule.go = function() {\r\n\t\tif (this.isEnabled() && this.isMatchURL()) {\r\n\t\t\tif (RESUtils.isPageType('comments') && this.options.viewFullContext.value) {\r\n\t\t\t\taddViewFullContext();\r\n\t\t\t}\r\n\t\t\tif (RESUtils.isPageType('inbox', 'profile') && !isNaN(this.options.defaultContext.value) && this.options.defaultContext.value >= 0) {\r\n\t\t\t\tsetDefaultContext();\r\n\t\t\t\tRESUtils.watchForElement('siteTable', setDefaultContext);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tfunction addViewFullContext() {\r\n\t\tif (location.search !== '?context=10000') {\r\n\t\t\tvar pInfobar = document.querySelector('.infobar:not(#searchexpando) p');\r\n\t\t\tif (pInfobar) {\r\n\t\t\t\t// check if there is a Parent button; if not, it's a top comment so don't show full context link\r\n\t\t\t\tif ($('.sitetable:eq(1) .buttons:first .bylink').length > 1) { // Permalink and Parent have bylink class\r\n\t\t\t\t\tpInfobar.innerHTML += '&nbsp;<a href=\"?context=10000\">view the full context</a>&nbsp;â†’';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction setDefaultContext(ele) {\r\n\t\tele = ele || document;\r\n\t\t$(ele).find('.bylink').each(function() {\r\n\t\t\tthis.setAttribute('href', this.getAttribute('href').replace(/\\?context=[0-9]+$/, '?context=' + module.options.defaultContext.value));\r\n\t\t});\r\n\t}\r\n});\r\n"],"sourceRoot":"/source/"}
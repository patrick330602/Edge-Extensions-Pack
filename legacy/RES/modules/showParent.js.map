{"version":3,"sources":["modules/showParent.js"],"names":[],"mappings":"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","file":"modules/showParent.js","sourcesContent":["addModule('showParent', function(module, moduleID) {\r\n\tmodule.moduleName = 'Show Parent on Hover';\r\n\tmodule.category = 'Comments';\r\n\tmodule.description = 'Shows the parent comments when hovering over the \"parent\" link of a comment.';\r\n\tmodule.options = {\r\n\t\thoverDelay: {\r\n\t\t\ttype: 'text',\r\n\t\t\tvalue: 500,\r\n\t\t\tdescription: 'Delay, in milliseconds, before parent hover loads. Default is 500.',\r\n\t\t\tadvanced: true\r\n\t\t},\r\n\t\tfadeDelay: {\r\n\t\t\ttype: 'text',\r\n\t\t\tvalue: 200,\r\n\t\t\tdescription: 'Delay, in milliseconds, before parent hover fades away after the mouse leaves. Default is 200.',\r\n\t\t\tadvanced: true\r\n\t\t},\r\n\t\tfadeSpeed: {\r\n\t\t\ttype: 'text',\r\n\t\t\tvalue: 0.7,\r\n\t\t\tdescription: 'Fade animation\\'s speed (in seconds). Default is 0.7.',\r\n\t\t\tadvanced: true\r\n\t\t},\r\n\t\tdirection: {\r\n\t\t\ttype: 'enum',\r\n\t\t\tvalue: 'down',\r\n\t\t\tvalues: [{\r\n\t\t\t\tname: 'Above',\r\n\t\t\t\tvalue: 'up'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Below',\r\n\t\t\t\tvalue: 'down'\r\n\t\t\t}],\r\n\t\t\tdescription: 'Order the parent comments to place each parent comment above or below its children.',\r\n\t\t\tbodyClass: true\r\n\t\t}\r\n\t};\r\n\tmodule.include = [\r\n\t\t'comments'\r\n\t];\r\n\tmodule.go = function() {\r\n\t\tif ((this.isEnabled()) && (this.isMatchURL())) {\r\n\t\t\t$('body').on('mouseenter', '.comment .buttons :not(:first-child) .bylink', function(e) {\r\n\t\t\t\tmodules['hover'].infocard('showParent')\r\n\t\t\t\t\t.target(this)\r\n\t\t\t\t\t.options({\r\n\t\t\t\t\t\topenDelay: module.options.hoverDelay.value,\r\n\t\t\t\t\t\tfadeDelay: module.options.fadeDelay.value,\r\n\t\t\t\t\t\tfadeSpeed: module.options.fadeSpeed.value\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.populateWith(module.showCommentHover)\r\n\t\t\t\t\t.begin();\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\tfunction handleVoteClick(evt) {\r\n\t\tvar $this = $(this),\r\n\t\t\tvoteClasses = {\r\n\t\t\t\t'-1': 'dislikes',\r\n\t\t\t\t0: 'unvoted',\r\n\t\t\t\t1: 'likes'\r\n\t\t\t},\r\n\t\t\tid = $this.parent().parent().data('fullname'),\r\n\t\t\tdirection = /(up|down)(?:mod)?/.exec(this.className);\r\n\r\n\t\tif (!direction) return;\r\n\r\n\t\tdirection = direction[1];\r\n\r\n\t\tvar $targetButton = $('.content .thing.id-' + id).children('.midcol')\r\n\t\t\t.find('.arrow.' + direction + ', .arrow.' + direction + 'mod');\r\n\r\n\t\tif ($targetButton.length !== 1) {\r\n\t\t\tconsole.error('When attempting to find %s arrow for comment %s %d elements were returned',\r\n\t\t\t\tdirection, id, $targetButton.length);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Prevent other click handlers from running\r\n\t\t// Note that $targetButton's other click handlers run before this one,\r\n\t\t// by a \"first come, first serve\" basis\r\n\t\tvar removeClickHandlers = function(event) {\r\n\t\t\tevent.stopPropagation();\r\n\t\t};\r\n\r\n\t\t$targetButton.on('click', removeClickHandlers);\r\n\t\t$targetButton.click();\r\n\t\t$targetButton.off('click', removeClickHandlers);\r\n\r\n\t\tvar clickedDir = (direction === 'up' ? 1 : -1),\r\n\t\t\t$midcol = $this.parent(),\r\n\t\t\tstartDir;\r\n\r\n\t\t$.each(voteClasses, function(key, value) {\r\n\t\t\tif ($midcol.hasClass(value)) {\r\n\t\t\t\tstartDir = parseInt(key, 10);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tvar newDir = clickedDir === startDir ? 0 : clickedDir;\r\n\r\n\t\t$midcol.parent().children('.' + voteClasses[startDir])\r\n\t\t\t.removeClass(voteClasses[startDir])\r\n\t\t\t.addClass(voteClasses[newDir]);\r\n\t\t$midcol.find('.up, .upmod')\r\n\t\t\t.toggleClass('upmod', newDir === 1)\r\n\t\t\t.toggleClass('up', newDir !== 1);\r\n\t\t$midcol.find('.down, .downmod')\r\n\t\t\t.toggleClass('downmod', newDir === -1)\r\n\t\t\t.toggleClass('down', newDir !== -1);\r\n\t}\r\n\tmodule.showCommentHover = function(def, base, context) {\r\n\t\tvar direction = module.options.direction.value,\r\n\t\t\t$thing = $(base);\r\n\r\n\t\t// If the passed element is not a `.thing` move up to the nearest `.thing`\r\n\t\tif (!$thing.is('.thing')) $thing = $thing.parents('.thing:first');\r\n\t\tvar $parents = $thing.parents('.thing').clone();\r\n\r\n\t\tif (direction === 'up') {\r\n\t\t\t$parents = $($parents.get().reverse());\r\n\t\t}\r\n\r\n\t\t$parents.addClass('comment parentComment').removeClass('thing even odd');\r\n\t\t$parents.children('.child').remove(); // replies and reply edit form\r\n\t\t$parents.each(function() {\r\n\t\t\tvar $this = $(this);\r\n\r\n\t\t\t// Remove the keyboardNav functionality\r\n\t\t\t$this.off('click');\r\n\r\n\t\t\t// A link to go to the actual comment\r\n\t\t\tvar id = $this.data('fullname');\r\n\t\t\tif (typeof id !== 'undefined') {\r\n\t\t\t\tid = id.slice(3);\r\n\t\t\t\t$this.find('> .entry .tagline').append('<a class=\"bylink parentlink\" href=\"#' + id + '\">goto comment</a>');\r\n\t\t\t}\r\n\t\t});\r\n\t\t$parents.find('.parent').remove();\r\n\t\t$parents.find('.usertext-body').show(); // contents\r\n\t\t$parents.find('.flat-list.buttons').remove(); // buttons\r\n\t\t$parents.find('.usertext-edit').remove(); // edit form\r\n\t\t$parents.find('.RESUserTag').remove(); // tags\r\n\t\t$parents.find('.voteWeight').remove(); // tags\r\n\t\t$parents.find('.entry').removeClass('RES-keyNav-activeElement');\r\n\t\t$parents.find('.author.userTagged').removeClass('userTagged'); // tags again\r\n\t\t$parents.find('.collapsed').remove(); // unused collapse view\r\n\t\t$parents.find('.expand').remove(); // expand button\r\n\t\t$parents.find('form').attr('id', ''); // IDs should be unique\r\n\t\t$parents.find('.arrow').prop('onclick', null) // clear the vote handlers\r\n\t\t.on('click', handleVoteClick); // bind handlers to vote buttons\r\n\t\t/*\r\n\t\tI am stripping out the image viewer stuff for now.\r\n\t\tMaking the image viewer work here requires some changes that are for another time.\r\n\t\t*/\r\n\t\t$parents.find('.madeVisible, .toggleImage').remove(); // image viewer\r\n\t\t$parents.find('.keyNavAnnotation').remove();\r\n\r\n\t\tvar $container = $('<div class=\"parentCommentWrapper\">');\r\n\t\t$container.append($parents);\r\n\t\t$parents.slice(0, -1).after('<div class=\"parentArrow\">reply to</div>');\r\n\t\tdef.resolve('Parents', $container);\r\n\t};\r\n});\r\n"],"sourceRoot":"/source/"}
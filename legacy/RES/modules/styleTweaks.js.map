{"version":3,"sources":["modules/styleTweaks.js"],"names":[],"mappings":"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","file":"modules/styleTweaks.js","sourcesContent":["addModule('styleTweaks', function(module, moduleID) {\r\n\tmodule.moduleName = 'Style Tweaks';\r\n\tmodule.category = ['Appearance', 'Comments'];\r\n\tmodule.description = 'Provides a number of style tweaks to the Reddit interface. Also allow you to disable specific subreddit style (the <a href=\"/prefs/#show_stylesheets\">global setting</a> must be on).';\r\n\tmodule.options = {\r\n\t\tnavTop: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Moves the username navbar to the top (great on netbooks!)',\r\n\t\t\tbodyClass: 'res-navTop'\r\n\t\t},\r\n\t\tcommentBoxes: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Highlights comment boxes for easier reading / placefinding in large threads.',\r\n\t\t\tbodyClass: 'res-commentBoxes'\r\n\t\t},\r\n\t\t/* REMOVED for performance reasons...\r\n\t\tcommentBoxShadows: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Drop shadows on comment boxes (turn off for faster performance)'\r\n\t\t},\r\n\t\t*/\r\n\t\tcommentRounded: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Round corners of comment boxes',\r\n\t\t\tadvanced: true,\r\n\t\t\tdependsOn: 'commentBoxes',\r\n\t\t\tbodyClass: 'res-commentBoxes-rounded'\r\n\t\t},\r\n\t\tcommentHoverBorder: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Highlight comment box hierarchy on hover (turn off for faster performance)',\r\n\t\t\tadvanced: true,\r\n\t\t\tdependsOn: 'commentBoxes',\r\n\t\t\tbodyClass: 'res-commentHoverBorder'\r\n\t\t},\r\n\t\tcommentIndent: {\r\n\t\t\ttype: 'text',\r\n\t\t\tvalue: 10,\r\n\t\t\tdescription: 'Indent comments by [x] pixels (only enter the number, no \\'px\\')',\r\n\t\t\tadvanced: true,\r\n\t\t\tdependsOn: 'commentBoxes'\r\n\t\t},\r\n\t\tcontinuity: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Show comment continuity lines',\r\n\t\t\tadvanced: true,\r\n\t\t\tdependsOn: 'commentBoxes',\r\n\t\t\tbodyClass: 'res-continuity'\r\n\t\t},\r\n\t\tdisableAnimations: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Discourage CSS3 animations. (This will apply to all of reddit, every subreddit, and RES functionality. However, subreddits might still have some animations.)',\r\n\t\t\tbodyClass: true\r\n\t\t},\r\n\t\tvisitedStyle: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Reddit makes it so no links on comment pages appear as \"visited\" - including user profiles. This option undoes that.',\r\n\t\t\tadvanced: true,\r\n\t\t\tbodyClass: true\r\n\t\t},\r\n\t\tshowExpandos: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Bring back video and text expando buttons for users with compressed link display',\r\n\t\t\tadvanced: true,\r\n\t\t\tbodyClass: true\r\n\t\t},\r\n\t\thideUnvotable: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Hide vote arrows on threads where you cannot vote (e.g. archived due to age)',\r\n\t\t\tbodyClass: true\r\n\t\t},\r\n\t\tshowFullLinkFlair: {\r\n\t\t\ttype: 'enum',\r\n\t\t\tvalues: [{\r\n\t\t\t\tname: 'Never',\r\n\t\t\t\tvalue: 'never'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'On hover',\r\n\t\t\t\tvalue: 'hover'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Always',\r\n\t\t\t\tvalue: 'always'\r\n\t\t\t}],\r\n\t\t\tvalue: 'never',\r\n\t\t\tdescription: 'Choose when full link flair should be shown',\r\n\t\t\tbodyClass: true\r\n\t\t},\r\n\t\thighlightEditedTime: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Make edited timestamps bold (e.g. \"last edited 50 minutes ago\")',\r\n\t\t\tbodyClass: true\r\n\t\t},\r\n\t\tcolorBlindFriendly: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Use colorblind friendly styles when possible',\r\n\t\t\tadvanced: true,\r\n\t\t\tbodyClass: 'res-colorblind'\r\n\t\t},\r\n\t\t/* DISABLED: too many dragons\r\n\t\tprotectRESElements: {\r\n\t\t\tadvanced: true,\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Ensure that certain RES elements are visible despite subreddit styles. Disable this if elements of subreddits disappear unexpectedly.'\r\n\t\t},\r\n\t\t*/\r\n\t\tsubredditStyleBrowserToolbarButton: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Add an icon in the omnibar (where the page address is written) to disable/enable current subreddit style.',\r\n\t\t\tnoconfig: true // only show for chrome\r\n\t\t},\r\n\t\tscrollSubredditDropdown: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Scroll the standard subreddit dropdown (useful for pinned header and disabled Subreddit Manager)',\r\n\t\t\tadvanced: true\r\n\t\t},\r\n\t\thighlightTopLevel: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Draws a line to separate top-level comments for easier distinction.'\r\n\t\t},\r\n\t\thighlightTopLevelColor: {\r\n\t\t\ttype: 'color',\r\n\t\t\tdependsOn: 'highlightTopLevel',\r\n\t\t\tdescription: 'Specify the color to separate top-level comments',\r\n\t\t\tvalue: '#8B0000'\r\n\t\t},\r\n\t\thighlightTopLevelSize: {\r\n\t\t\ttype: 'text',\r\n\t\t\tdependsOn: 'highlightTopLevel',\r\n\t\t\tdescription: 'Specify how thick (in pixels) of a bar is used to separate top-level comments',\r\n\t\t\tvalue: 2\r\n\t\t},\r\n\t\tfloatingSideBar: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Makes the left sidebar (with multireddits) float as you scroll down so you can always see it.',\r\n\t\t\tadvanced: true\r\n\t\t},\r\n\t\tpostTitleCapitalization: {\r\n\t\t\tdescription: 'Force a particular style of capitalization on post titles',\r\n\t\t\ttype: 'enum',\r\n\t\t\tvalue: 'none',\r\n\t\t\tvalues: [{\r\n\t\t\t\tname: 'do nothing',\r\n\t\t\t\tvalue: 'none'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Title Case',\r\n\t\t\t\tvalue: 'title'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Sentence case',\r\n\t\t\t\tvalue: 'sentence'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'lowercase',\r\n\t\t\t\tvalue: 'lowercase'\r\n\t\t\t}],\r\n\t\t\tbodyClass: true\r\n\t\t}\r\n\t};\r\n\tmodule.loadDynamicOptions = function() {\r\n\t\tif (BrowserDetect.isChrome() || BrowserDetect.isFirefox()) {\r\n\t\t\tthis.options.subredditStyleBrowserToolbarButton.noconfig = false;\r\n\t\t}\r\n\t};\r\n\r\n\tvar styleCBName = RESUtils.randomHash();\r\n\tvar curSubReddit;\r\n\r\n\tmodule.beforeLoad = function() {\r\n\t\tif ((this.isEnabled()) && (this.isMatchURL())) {\r\n\t\t\tif (this.options.commentBoxes.value && this.options.commentIndent.value && RESUtils.pageType('comments')) {\r\n\t\t\t\t// this should override the default of 10px in commentboxes.css because it's added later.\r\n\t\t\t\tRESUtils.addCSS('.res-commentBoxes .comment { margin-left:' + this.options.commentIndent.value + 'px !important; }');\r\n\t\t\t}\r\n\t\t\tif (RESUtils.currentSubreddit()) {\r\n\t\t\t\tcurSubReddit = RESUtils.currentSubreddit().toLowerCase();\r\n\t\t\t}\r\n\r\n\r\n\t\t\tRESUtils.addCSS('body.res .side .spacer .titlebox div #' + styleCBName + ':before { display: none !important;  }');\r\n\t\t\tRESUtils.addCSS('body.res .side .spacer .titlebox div #label-' + styleCBName + ':before { display: none !important; }');\r\n\t\t\tRESUtils.addCSS('body.res .side .spacer .titlebox div #' + styleCBName + ':after { display: none !important;  }');\r\n\t\t\tRESUtils.addCSS('body.res .side .spacer .titlebox div #label-' + styleCBName + ':after { display: none !important; }');\r\n\r\n\t\t\tif (this.options.highlightTopLevel.value) {\r\n\t\t\t\tvar highlightTopLevelColor = this.options.highlightTopLevelColor.value || this.options.highlightTopLevelColor.default;\r\n\t\t\t\tvar highlightTopLevelSize = parseInt(this.options.highlightTopLevelSize.value || this.options.highlightTopLevelSize.default, 10);\r\n\t\t\t\tRESUtils.addCSS('.nestedlisting > .comment + .clearleft { height: ' + highlightTopLevelSize + 'px !important; margin-bottom: 5px; background: ' + highlightTopLevelColor + ' !important; }');\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tmodule.afterLoad = function() {\r\n\t\t// Chrome pageAction\r\n\t\tif (BrowserDetect.isChrome()) {\r\n\t\t\tif (!RESUtils.currentSubreddit() || !module.options.subredditStyleBrowserToolbarButton.value) {\r\n\t\t\t\tRESEnvironment.sendMessage({\r\n\t\t\t\t\trequestType: 'pageAction',\r\n\t\t\t\t\taction: 'hide'\r\n\t\t\t\t});\r\n\t\t\t\t// }, 1);\r\n\t\t\t} else {\r\n\t\t\t\t// because this is run off of a separate async event, check if the checkbox\r\n\t\t\t\t// has been created yet, and if not, wait a bit and try again. There is a miniscule\r\n\t\t\t\t// likelihood of ever having to wait, but it is nonzero.\r\n\t\t\t\tif (module.styleToggleCheckbox) {\r\n\t\t\t\t\tRESEnvironment.sendMessage({\r\n\t\t\t\t\t\trequestType: 'pageAction',\r\n\t\t\t\t\t\taction: 'show',\r\n\t\t\t\t\t\tvisible: module.styleToggleCheckbox.checked\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetTimeout(module.afterLoad, 10);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tmodule.go = function() {\r\n\t\tif ((this.isEnabled()) && (this.isMatchURL())) {\r\n\t\t\tif (this.options.colorBlindFriendly.value) {\r\n\t\t\t\tvar orangered = document.getElementById('mail');\r\n\t\t\t\tif ((orangered) && (orangered.classList.contains('havemail'))) {\r\n\t\t\t\t\torangered.setAttribute('style', 'background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAKAgMAAAAWdexqAAAACVBMVEX/VwD/hgD///9PE9e4AAAAL0lEQVQI12MIDQ0NYUhgYFBh8GBgaGFwYmBiYXBo4AASCSosDE5cTSwQCbASkGIAxJMH9f3+nCsAAAAASUVORK5CYII=); background-position: 0 0;');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.options.scrollSubredditDropdown.value) {\r\n\t\t\t\tvar calcedHeight = Math.floor(window.innerHeight * 0.95);\r\n\t\t\t\tif ($('.drop-choices.srdrop').height() > calcedHeight) {\r\n\t\t\t\t\tRESUtils.addCSS('.drop-choices.srdrop { \\\r\n\t\t\t\t\t\toverflow-y: scroll; \\\r\n\t\t\t\t\t\tmax-height: ' + calcedHeight + 'px; \\\r\n\t\t\t\t\t}');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.options.floatingSideBar.value) {\r\n\t\t\t\tfloatSideBar();\r\n\t\t\t}\r\n\t\t\tsubredditStyles();\r\n\t\t\tsetupProtectProtectedElements();\r\n\t\t\tsetupElementToggleObservers();\r\n\r\n\t\t\tif ($('#show_stylesheets').length) {\r\n\t\t\t\t$('label[for=show_stylesheets]').after(' <span class=\"little gray\">(RES allows you to disable specific subreddit styles!  <a href=\"/r/Enhancement/wiki/srstyle\">Click here to learn more</a>)</span>');\r\n\t\t\t}\r\n\t\t\tif (BrowserDetect.isFirefox()) {\r\n\t\t\t\tif (!module.options.subredditStyleBrowserToolbarButton.value) {\r\n\t\t\t\t\tRESEnvironment.sendMessage({\r\n\t\t\t\t\t\trequestType: 'pageAction',\r\n\t\t\t\t\t\taction: 'hide'\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (!RESUtils.currentSubreddit()) {\r\n\t\t\t\t\tRESEnvironment.sendMessage({\r\n\t\t\t\t\t\trequestType: 'pageAction',\r\n\t\t\t\t\t\taction: 'disable'\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// because this is run off of a separate async event, check if the checkbox\r\n\t\t\t\t\t// has been created yet, and if not, wait a bit and try again. There is a miniscule\r\n\t\t\t\t\t// likelihood of ever having to wait, but it is nonzero.\r\n\t\t\t\t\tvar setupPageAction = function() {\r\n\t\t\t\t\t\tif (module.styleToggleCheckbox) {\r\n\t\t\t\t\t\t\tRESEnvironment.sendMessage({\r\n\t\t\t\t\t\t\t\trequestType: 'pageAction',\r\n\t\t\t\t\t\t\t\taction: 'show',\r\n\t\t\t\t\t\t\t\tvisible: module.styleToggleCheckbox.checked\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tsetTimeout(setupPageAction, 10);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tsetupPageAction();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tregisterCommandLine();\r\n\t\t}\r\n\t};\r\n\r\n\tfunction registerCommandLine() {\r\n\t\tmodules['commandLine'].registerCommand('srstyle', 'srstyle [subreddit] [on|off] - toggle subreddit style on/off (if no subreddit is specified, uses current subreddit)',\r\n\t\t\tfunction(command, val) {\r\n\t\t\t\tvar options = getSrstyleOptions(val);\r\n\t\t\t\tvar str = 'toggle subreddit style';\r\n\t\t\t\tif (options.toggleText) {\r\n\t\t\t\t\tstr += ' ' + options.toggleText;\r\n\r\n\t\t\t\t\tif (options.sr) {\r\n\t\t\t\t\t\tstr += ' for: ' + options.sr;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn str;\r\n\t\t\t},\r\n\t\t\tfunction(command, val, match, e) {\r\n\t\t\t\t// toggle subreddit style\r\n\t\t\t\tvar options = getSrstyleOptions(val);\r\n\r\n\t\t\t\tif (!options.sr) {\r\n\t\t\t\t\treturn 'No subreddit specified.';\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar toggle;\r\n\t\t\t\tif (options.toggleText === 'on') {\r\n\t\t\t\t\ttoggle = true;\r\n\t\t\t\t} else if (options.toggleText === 'off') {\r\n\t\t\t\t\ttoggle = false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn 'You must specify \"on\" or \"off\".';\r\n\t\t\t\t}\r\n\t\t\t\tvar action = toggle ? 'enabled' : 'disabled';\r\n\t\t\t\tmodule.toggleSubredditStyle(toggle, options.sr);\r\n\t\t\t\tmodules['notifications'].showNotification({\r\n\t\t\t\t\theader: 'Subreddit Style',\r\n\t\t\t\t\tmoduleID: 'styleTweaks',\r\n\t\t\t\t\tmessage: 'Subreddit style ' + action + ' for subreddit: ' + options.sr\r\n\t\t\t\t}, 4000);\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tfunction getSrstyleOptions(val) {\r\n\t\t\tvar sr;\r\n\t\t\tvar toggleText;\r\n\t\t\tvar splitWords = val.split(' ');\r\n\t\t\tif (splitWords.length === 2) {\r\n\t\t\t\tsr = splitWords[0];\r\n\t\t\t\ttoggleText = splitWords[1];\r\n\t\t\t} else {\r\n\t\t\t\tsr = RESUtils.currentSubreddit();\r\n\t\t\t\ttoggleText = splitWords[0];\r\n\t\t\t}\r\n\r\n\t\t\tif (toggleText !== 'on' && toggleText !== 'off') {\r\n\t\t\t\ttoggleText = false;\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\tsr: sr,\r\n\t\t\t\ttoggleText: toggleText\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\tfunction floatSideBar() {\r\n\t\tvar sideBarElement = document.querySelector('.listing-chooser');\r\n\t\tif (sideBarElement) {\r\n\t\t\twindow.addEventListener('scroll', RESUtils.debounce.bind(RESUtils, 'scroll.styleTweaks', 300, handleScroll, sideBarElement), false);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction handleScroll(sideBarElement) {\r\n\t\tif (RESUtils.elementInViewport(sideBarElement)) {\r\n\t\t\tsideBarElement.setAttribute('style', '');\r\n\t\t} else {\r\n\t\t\tsideBarElement.setAttribute('style', 'position: fixed; top: 0; z-index: 100; height: 100%; overflow-y: auto;');\r\n\t\t}\r\n\t}\r\n\r\n\tvar ignoredSubReddits = [];\r\n\r\n\tfunction subredditStyles() {\r\n\t\tif (!RESUtils.currentSubreddit()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar getIgnored = RESStorage.getItem('RESmodules.styleTweaks.ignoredSubredditStyles'),\r\n\t\t\tsubredditTitle, subredditStylesWhitelist, index;\r\n\r\n\t\tif (getIgnored) {\r\n\t\t\tignoredSubReddits = safeJSON.parse(getIgnored, 'RESmodules.styleTweaks.ignoredSubredditStyles');\r\n\t\t}\r\n\t\tsubredditTitle = document.querySelector('.titlebox h1');\r\n\t\tmodule.styleToggleContainer = document.createElement('div');\r\n\t\tmodule.styleToggleLabel = document.createElement('label');\r\n\t\tmodule.styleToggleCheckbox = document.createElement('input');\r\n\t\tmodule.styleToggleCheckbox.setAttribute('type', 'checkbox');\r\n\t\tmodule.styleToggleCheckbox.setAttribute('id', styleCBName);\r\n\t\tmodule.styleToggleCheckbox.setAttribute('name', styleCBName);\r\n\r\n\t\t// are we blacklisting, or whitelisting subreddits?  If we're in night mode on a sub that's\r\n\t\t// incompatible with it, we want to check the whitelist. Otherwise, check the blacklist.\r\n\r\n\t\tif (curSubReddit && subredditTitle) {\r\n\t\t\tif (modules['nightMode'].isNightModeOn() &&\r\n\t\t\t\t\t!modules['nightMode'].isNightmodeCompatible) {\r\n\t\t\t\tsubredditStylesWhitelist = modules['nightMode'].options.subredditStylesWhitelist.value.split(',');\r\n\t\t\t\tindex = subredditStylesWhitelist.indexOf(curSubReddit);\r\n\r\n\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\tmodule.styleToggleCheckbox.checked = true;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tindex = ignoredSubReddits.indexOf(curSubReddit);\r\n\r\n\t\t\t\tif (index === -1) {\r\n\t\t\t\t\tmodule.styleToggleCheckbox.checked = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmodule.toggleSubredditStyle(false);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tmodule.styleToggleCheckbox.addEventListener('change', function(e) {\r\n\t\t\t\tmodule.toggleSubredditStyle(this.checked);\r\n\t\t\t}, false);\r\n\t\t\tmodule.styleToggleContainer.appendChild(module.styleToggleCheckbox);\r\n\t\t\tRESUtils.insertAfter(subredditTitle, module.styleToggleContainer);\r\n\t\t}\r\n\r\n\t\tmodule.styleToggleLabel.setAttribute('for', styleCBName);\r\n\t\tmodule.styleToggleLabel.setAttribute('id', 'label-' + styleCBName);\r\n\t\tmodule.styleToggleLabel.textContent = 'Use subreddit style ';\r\n\t\tmodule.styleToggleContainer.appendChild(module.styleToggleLabel);\r\n\r\n\t\tmodule.protectElement(module.styleToggleContainer, 'display: block !important;');\r\n\t\tmodule.protectElement(module.styleToggleCheckbox, 'display: inline-block !important;');\r\n\t\tmodule.protectElement(module.styleToggleLabel, 'display: inline-block !important; margin-left: 4px !important;');\r\n\r\n\t\tmodule.setSRStyleToggleVisibility(true); // no source\r\n\t}\r\n\r\n\tvar srstyleHideLock = RESUtils.createMultiLock();\r\n\r\n\tmodule.setSRStyleToggleVisibility = function(visible, source) {\r\n\t\t/// When showing/hiding popups which could overlay the \"Use subreddit style\" checkbox,\r\n\t\t/// set the checkbox's styling to \"less visible\" or \"more visible\"\r\n\t\t/// @param \tvisible \t\tbool\tmake checkbox \"more visible\" (true) or less (false)\r\n\t\t/// @param \tsource \tstring \tpopup ID, so checkbox stays less visible until that popup's lock is released\r\n\t\tif (!module.styleToggleContainer) return;\r\n\r\n\t\tif (typeof source !== 'undefined') {\r\n\t\t\tif (visible) {\r\n\t\t\t\tsrstyleHideLock.unlock(source);\r\n\t\t\t} else {\r\n\t\t\t\tsrstyleHideLock.lock(source);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tapplyTopmostElementProtection(visible);\r\n\t};\r\n\r\n\tfunction setupElementToggleObservers() {\r\n\t\tif (!window.MutationObserver) return;\r\n\t\tvar elems = document.querySelectorAll('.cover-overlay'),\r\n\t\t\tobserver = new MutationObserver(function(mutations) {\r\n\t\t\t\tmutations.forEach(function(mutation) {\r\n\t\t\t\t\tif (mutation.attributeName === 'style') {\r\n\t\t\t\t\t\tvar mutationID = $(mutation.target).data('mutation-id');\r\n\t\t\t\t\t\tif (typeof mutationID === 'undefined') {\r\n\t\t\t\t\t\t\tmutationID = Math.random();\r\n\t\t\t\t\t\t\t$(mutation.target).data('mutation-id', mutationID);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (mutation.target.style.display === 'none') {\r\n\t\t\t\t\t\t\tmodule.setSRStyleToggleVisibility(true, mutationID);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tmodule.setSRStyleToggleVisibility(false, mutationID);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\tArray.prototype.slice.call(elems).forEach(function(elem) {\r\n\t\t\tobserver.observe(elem, { attributes : true, attributeFilter : ['style'] });\r\n\t\t});\r\n\t}\r\n\r\n\tvar protectedElements;\r\n\r\n\tfunction applyTopmostElementProtection(visible) {\r\n\t\tif (typeof visible === 'undefined') {\r\n\t\t\tvisible = true;\r\n\t\t}\r\n\t\tif (visible && srstyleHideLock.locked()) {\r\n\t\t\tvisible = false;\r\n\t\t}\r\n\r\n\t\t// great, now people are still finding ways to hide this.. these extra declarations are to try and fight that.\r\n\t\t// Sorry, subreddit moderators, but users can disable all subreddit stylesheets if they want - this is a convenience\r\n\t\t// for them and I think taking this functionality away from them is unacceptable.\r\n\r\n\t\tvar zIndex = 'z-index: ' + (visible ? ' 2147483646' : 'auto') + ' !important;';\r\n\r\n\t\tprotectedElements.each(function(index, element) {\r\n\t\t\tvar elementCss = element.getAttribute('data-res-css') || '';\r\n\t\t\tvar css = RESUtils.baseStyleProtection + zIndex + elementCss;\r\n\t\t\telement.setAttribute('style', css);\r\n\t\t});\r\n\t}\r\n\r\n\tmodule.protectElement = function(element, css) {\r\n\t\tvar elements = protectedElements || $();\r\n\t\tprotectedElements = elements.add(element);\r\n\r\n\t\tif (css) {\r\n\t\t\t$(element).attr('data-res-css', css);\r\n\t\t}\r\n\r\n\t\tapplyTopmostElementProtection();\r\n\t\tsetupProtectProtectedElements();\r\n\t};\r\n\r\n\tfunction protectProtectedElements() {\r\n\t\treturn; /* too many dragons\r\n\t\tif (RESUtils.currentSubreddit() === null || RESUtils.currentSubreddit() === undefined) return;\r\n\t\tif (!document.body) {\r\n\t\t\tsetupProtectProtectedElements();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (document.body.classList.contains('multi-page')) return;\r\n\t\tif (!(protectedElements && protectedElements.length)) return;\r\n\t\tif (!module.options.protectRESElements.value) return;\r\n\r\n\t\tvar self = module,\r\n\t\t\t$window = $(window),\r\n\t\t\twindowScroll = {\r\n\t\t\t\tleft: $window.scrollLeft(),\r\n\t\t\t\ttop: $window.scrollTop(),\r\n\t\t\t\twidth: $window.width(),\r\n\t\t\t\theight: $window.height()\r\n\t\t\t},\r\n\t\t\tprotectedElements = protectedElements.filter(':not([data-res-protect-checked])'),\r\n\t\t\tsomeElementNotVisible = false;\r\n\r\n\t\tprotectedElements.each(function(index, element) {\r\n\t\t\tvar $element = $(element);\r\n\t\t\tvar insideHiddenContainer = Array.prototype.some.call($element.parentsUntil('html'), function(elem) { return window.getComputedStyle(elem).display === 'none'; });\r\n\r\n\t\t\tif (!insideHiddenContainer) {\r\n\t\t\t\t//do {\r\n\t\t\t\t\tvar offset = $element.offset();\r\n\t\t\t\t\tvar checkPosition = { x: offset.left, y: offset.top };\r\n\t\t\t\t\tif (!isPositionInViewport(checkPosition)) {\r\n\t\t\t\t\t\tsomeElementNotVisible = true;\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar elementAtProtectedPosition = document.elementFromPoint(checkPosition.x - windowScroll.left, checkPosition.y - windowScroll.top);\r\n\t\t\t\t\t\tvar elementIsTopmost = !elementAtProtectedPosition || $element.is(elementAtProtectedPosition) || $element.has(elementAtProtectedPosition).length;\r\n\t\t\t\t\t\tif (!elementIsTopmost && !$(elementAtProtectedPosition).is('html, body')) {\r\n\t\t\t\t\t\t\t$(elementAtProtectedPosition).remove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t//} while (!elementIsTopmost);\r\n\t\t\t}\r\n\r\n\t\t\telement.setAttribute('data-res-protect-checked', true);  // don't use .attr('data-foo', 'bar') because jQuery converts that to .data('foo', 'bar'), and RES doesn't include :data() selector\r\n\t\t});\r\n\r\n\t\tif (someElementNotVisible) {\r\n\t\t\t// Some elements were not checked, try again later\r\n\t\t\t$(window).on('scroll', setupProtectProtectedElements);\r\n\t\t} else {\r\n\t\t\t$(window).off('scroll', setupProtectProtectedElements);\r\n\t\t}\r\n\r\n\t\tfunction isPositionInViewport(position) {\r\n\t\t\tif (position.x < windowScroll.left)\r\n\t\t\t\treturn false;\r\n\r\n\t\t\tif (windowScroll.left + windowScroll.width < position.x)\r\n\t\t\t\treturn false;\r\n\r\n\t\t\tif (position.y < windowScroll.top)\r\n\t\t\t\treturn false;\r\n\r\n\t\t\tif (windowScroll.top + windowScroll.height < position.y)\r\n\t\t\t\treturn false;\r\n\r\n\t\t\treturn true;\r\n\t\t}*/\r\n\t}\r\n\r\n\tfunction setupProtectProtectedElements() {\r\n\t\tRESUtils.debounce('scroll.styleTweaks.protectElements', 200, protectProtectedElements);\r\n\t}\r\n\r\n\tmodule.toggleSubredditStyle = function(toggle, subreddit) {\r\n\t\tif (toggle) {\r\n\t\t\tenableSubredditStyle(subreddit);\r\n\t\t} else {\r\n\t\t\tdisableSubredditStyle(subreddit);\r\n\t\t}\r\n\t};\r\n\r\n\tvar stylesheetURL;\r\n\r\n\tfunction enableSubredditStyle(subreddit) {\r\n\t\tvar togglesr = subreddit ? subreddit.toLowerCase() : curSubReddit;\r\n\r\n\t\tif (modules['nightMode'].isNightModeOn() &&\r\n\t\t\t\t!modules['nightMode'].isNightmodeCompatible) {\r\n\t\t\tmodules['nightMode'].addSubredditToWhitelist(togglesr);\r\n\t\t} else if (ignoredSubReddits) {\r\n\t\t\tvar index = ignoredSubReddits.indexOf(togglesr);\r\n\r\n\t\t\tif (index !== -1) {\r\n\t\t\t\t// Remove if found\r\n\t\t\t\tignoredSubReddits.splice(index, 1);\r\n\t\t\t}\r\n\r\n\t\t\tRESStorage.setItem('RESmodules.styleTweaks.ignoredSubredditStyles', JSON.stringify(ignoredSubReddits));\r\n\t\t}\r\n\r\n\t\tvar subredditStyleSheet = document.createElement('link');\r\n\t\tsubredditStyleSheet.setAttribute('title', 'applied_subreddit_stylesheet');\r\n\t\tsubredditStyleSheet.setAttribute('rel', 'stylesheet');\r\n\t\tif (stylesheetURL) {\r\n\t\t\tsubredditStyleSheet.setAttribute('href', stylesheetURL);\r\n\t\t} else {\r\n\t\t\tsubredditStyleSheet.setAttribute('href', '/r/' + togglesr + '/stylesheet.css');\r\n\t\t}\r\n\t\tif (!subreddit || (subreddit.toLowerCase() === curSubReddit)) document.head.appendChild(subredditStyleSheet);\r\n\r\n\t\tif (BrowserDetect.isChrome() || BrowserDetect.isFirefox()) {\r\n\t\t\t// in case it was set by the pageAction, be sure to check the checkbox.\r\n\t\t\tif (module.styleToggleCheckbox) {\r\n\t\t\t\tmodule.styleToggleCheckbox.checked = true;\r\n\t\t\t}\r\n\t\t\tRESEnvironment.sendMessage({\r\n\t\t\t\trequestType: 'pageAction',\r\n\t\t\t\taction: 'stateChange',\r\n\t\t\t\tvisible: true\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tfunction disableSubredditStyle(subreddit) {\r\n\t\tvar togglesr = subreddit ? subreddit.toLowerCase() : curSubReddit;\r\n\t\tif (modules['nightMode'].isNightModeOn() &&\r\n\t\t\t\t!modules['nightMode'].isNightmodeCompatible) {\r\n\t\t\tmodules['nightMode'].removeSubredditFromWhitelist(togglesr);\r\n\t\t} else if (ignoredSubReddits) {\r\n\t\t\tvar index = ignoredSubReddits.indexOf(togglesr);\r\n\r\n\t\t\tif (index === -1) {\r\n\t\t\t\t// Add if found\r\n\t\t\t\tignoredSubReddits.push(togglesr);\r\n\t\t\t}\r\n\r\n\t\t\tRESStorage.setItem('RESmodules.styleTweaks.ignoredSubredditStyles', JSON.stringify(ignoredSubReddits));\r\n\t\t}\r\n\r\n\t\tvar subredditStyleSheet = document.head.querySelector('link[title=applied_subreddit_stylesheet]');\r\n\t\tif (!subredditStyleSheet) subredditStyleSheet = document.head.querySelector('style[title=applied_subreddit_stylesheet]');\r\n\t\tif (!subredditStyleSheet) subredditStyleSheet = document.head.querySelector('style[data-apng-original-href]'); // apng extension fix (see #1076)\r\n\t\tif ((subredditStyleSheet) && (!subreddit || (subreddit.toLowerCase() === curSubReddit))) {\r\n\t\t\tstylesheetURL = subredditStyleSheet.href;\r\n\t\t\tsubredditStyleSheet.parentNode.removeChild(subredditStyleSheet);\r\n\t\t}\r\n\r\n\t\tif (BrowserDetect.isChrome() || BrowserDetect.isFirefox()) {\r\n\t\t\t// in case it was set by the pageAction, be sure to uncheck the checkbox\r\n\t\t\tif (module.styleToggleCheckbox) {\r\n\t\t\t\tmodule.styleToggleCheckbox.checked = false;\r\n\t\t\t}\r\n\t\t\tRESEnvironment.sendMessage({\r\n\t\t\t\trequestType: 'pageAction',\r\n\t\t\t\taction: 'stateChange',\r\n\t\t\t\tvisible: false\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tmodule.isSubredditStyleEnabled = function() {\r\n\t\t// TODO: detect if srstyle is disabled by reddit account preference\r\n\r\n\t\tif (module.styleToggleCheckbox) {\r\n\t\t\treturn module.styleToggleCheckbox.checked;\r\n\t\t}\r\n\r\n\t\t// RES didn't disable it, at least\r\n\t\treturn true;\r\n\t};\r\n});\r\n"],"sourceRoot":"/source/"}
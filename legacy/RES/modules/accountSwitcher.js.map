{"version":3,"sources":["modules/accountSwitcher.js"],"names":[],"mappings":"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","file":"modules/accountSwitcher.js","sourcesContent":["addModule('accountSwitcher', function(module, moduleID) {\r\n\tmodule.moduleName = 'Account Switcher';\r\n\tmodule.category = 'My account';\r\n\tmodule.description = 'Store username/password pairs and switch accounts instantly while browsing Reddit!' +\r\n\t\t'\\n\\n<br><br>If you forget a password which is stored in Account Switcher, <a href=\"/r/Enhancement/wiki/faq/passwords\">you can recover them from RES settings</a>. Be aware that RES offers very little protection for stored passwords, so be careful when sharing your computer or settings!';\r\n\tmodule.options = {\r\n\t\tkeepLoggedIn: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Keep me logged in when I restart my browser.'\r\n\t\t},\r\n\t\taccounts: {\r\n\t\t\ttype: 'table',\r\n\t\t\taddRowText: '+add account',\r\n\t\t\tfields: [{\r\n\t\t\t\tname: 'username',\r\n\t\t\t\ttype: 'text'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'password',\r\n\t\t\t\ttype: 'password'\r\n\t\t\t}],\r\n\t\t\tvalue: [],\r\n\t\t\tdescription: 'Set your usernames and passwords below. They are only stored in RES preferences.'\r\n\t\t},\r\n\t\tupdateOtherTabs: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tdescription: 'After switching accounts, show a warning in other tabs.',\r\n\t\t\tvalue: true,\r\n\t\t\tadvanced: true\r\n\t\t},\r\n\t\treloadOtherTabs: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tdescription: 'After switching accounts, automatically reload other tabs.',\r\n\t\t\tvalue: false,\r\n\t\t\tadvanced: true\r\n\t\t},\r\n\t\tshowCurrentUserName: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Show my current user name in the Account Switcher.',\r\n\t\t\tadvanced: true\r\n\t\t},\r\n\t\tdropDownStyle: {\r\n\t\t\ttype: 'enum',\r\n\t\t\tvalues: [{\r\n\t\t\t\tname: 'snoo (alien)',\r\n\t\t\t\tvalue: 'alien'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'simple arrow',\r\n\t\t\t\tvalue: 'arrow'\r\n\t\t\t}],\r\n\t\t\tvalue: 'alien',\r\n\t\t\tdescription: 'Use the \"snoo\" icon, or older style dropdown?',\r\n\t\t\tadvanced: true,\r\n\t\t\tbodyClass: true\r\n\t\t},\r\n\t\tshowUserDetails: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Show details of each account in the Account Switcher, such as karma or gold status.',\r\n\t\t\tadvanced: true\r\n\t\t},\r\n\t\tshowKarma: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Show the link and comment karma of each account in the Account Switcher.',\r\n\t\t\tadvanced: true,\r\n\t\t\tdependsOn: 'showUserDetails'\r\n\t\t},\r\n\t\tshowGold: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Show the gold status of each account in the Account Switcher.',\r\n\t\t\tadvanced: true,\r\n\t\t\tdependsOn: 'showUserDetails'\r\n\t\t}\r\n\t};\r\n\tmodule.go = function() {\r\n\t\tif ((this.isEnabled()) && (this.isMatchURL())) {\r\n\t\t\tthis.userLink = document.querySelector('#header-bottom-right > span.user > a');\r\n\t\t\tif (this.userLink) {\r\n\t\t\t\tthis.userLink.style.marginRight = '2px';\r\n\t\t\t\t// var downArrowIMG = 'data:image/gif;base64,R0lGODlhBwAEALMAAAcHBwgICAoKChERETs7Ozo6OkJCQg0NDRoaGhAQEAwMDDIyMv///wAAAAAAAAAAACH5BAEAAAwALAAAAAAHAAQAAAQQ0BSykADsDAUwY4kQfOT4RQA7';\r\n\t\t\t\tif (this.options.dropDownStyle.value === 'alien') {\r\n\t\t\t\t\tthis.downArrowOverlay = $('<span id=\"RESAccountSwitcherIconOverlay\"></span>');\r\n\t\t\t\t\tthis.downArrow = $('<span id=\"RESAccountSwitcherIcon\"></span>');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.downArrowOverlay = $('<span id=\"RESAccountSwitcherIconOverlay\"><span class=\"downArrow\"></span></span>');\r\n\t\t\t\t\tthis.downArrow = $('<span id=\"RESAccountSwitcherIcon\"><span class=\"downArrow\"></span></span>');\r\n\t\t\t\t}\r\n\t\t\t\tthis.downArrowOverlay.on('click', function() {\r\n\t\t\t\t\ttoggleAccountMenu(false);\r\n\t\t\t\t\tmanageAccounts();\r\n\t\t\t\t}).appendTo(document.body);\r\n\r\n\t\t\t\tthis.downArrow.on('click', function() {\r\n\t\t\t\t\tupdateUserDetails();\r\n\t\t\t\t\ttoggleAccountMenu(true);\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$(this.userLink).after(this.downArrow);\r\n\r\n\t\t\t\tthis.accountMenu = $('<ul id=\"RESAccountSwitcherDropdown\" class=\"RESDropdownList\"></ul>');\r\n\r\n\t\t\t\tvar dropdownTimer;\r\n\t\t\t\tthis.accountMenu.add(this.downArrowOverlay)\r\n\t\t\t\t\t.on('mouseenter', function() {\r\n\t\t\t\t\t\tclearTimeout(dropdownTimer);\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.on('mouseleave', function() {\r\n\t\t\t\t\t\tdropdownTimer = setTimeout(function() {\r\n\t\t\t\t\t\t\ttoggleAccountMenu(false);\r\n\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\tthis.accountMenu.on('click', '.accountName', function(e) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tswitchTo($.data(this, 'username'));\r\n\t\t\t\t});\r\n\t\t\t\tthis.accountMenu.on('click', '.addAccount', function(e) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\ttoggleAccountMenu(false);\r\n\t\t\t\t\tmanageAccounts();\r\n\t\t\t\t});\r\n\t\t\t\t// RESUtils.addStyle(css);\r\n\t\t\t\tvar accounts = this.options.accounts.value;\r\n\t\t\t\tif (accounts !== null) {\r\n\t\t\t\t\tvar accountCount = 0;\r\n\t\t\t\t\tvar loggedInUser = RESUtils.loggedInUser();\r\n\t\t\t\t\taccounts.forEach(function(account) {\r\n\t\t\t\t\t\tvar username = account[0];\r\n\t\t\t\t\t\tif (!loggedInUser || username.toUpperCase() !== loggedInUser.toUpperCase() || this.options.showCurrentUserName.value) {\r\n\t\t\t\t\t\t\taccountCount++;\r\n\t\t\t\t\t\t\tvar $accountLink = $('<li>', {\r\n\t\t\t\t\t\t\t\t'class': 'accountName'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t// Check if user is logged in before comparing\r\n\t\t\t\t\t\t\tif (loggedInUser && username.toUpperCase() === loggedInUser.toUpperCase()) {\r\n\t\t\t\t\t\t\t\t$accountLink.addClass('active');\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t$accountLink.data('username', username)\r\n\t\t\t\t\t\t\t\t.appendTo(this.accountMenu);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this);\r\n\r\n\t\t\t\t\tif (accountCount) {\r\n\t\t\t\t\t\tpopulateUsers();\r\n\t\t\t\t\t\tupdateUserDetails(false);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$('<li>', {\r\n\t\t\t\t\t\t'class': 'addAccount'\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\t.text('+ add account')\r\n\t\t\t\t\t\t.appendTo(this.accountMenu);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$(document.body).append(this.accountMenu);\r\n\t\t\t}\r\n\r\n\r\n\t\t\tmodules['commandLine'].registerCommand(/^sw$/, 'sw [username] - switch users to [username]',\r\n\t\t\t\tfunction(command, val, match) {\r\n\t\t\t\t\tvar found = findMatchingAccount(val, true);\r\n\t\t\t\t\tif (val && found) {\r\n\t\t\t\t\t\treturn 'Switch to username: ' + found[0];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn 'Switch to username: ...';\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfunction(command, val, match, e) {\r\n\t\t\t\t\tif (!val.length) {\r\n\t\t\t\t\t\treturn 'No username specified.';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar found = findMatchingAccount(val, true);\r\n\r\n\t\t\t\t\tif (found) {\r\n\t\t\t\t\t\tswitchTo(found[0]);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmanageAccounts();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t};\r\n\r\n\tfunction populateUsers() {\r\n\t\tmodule.accountMenu.find('.accountName')\r\n\t\t\t.each(function(index, ele) { populateUser(ele); });\r\n\t}\r\n\r\n\tfunction updateUser(username) {\r\n\t\tmodule.accountMenu.find('.accountName')\r\n\t\t\t.filter(function() {\r\n\t\t\t\tvar thisUsername = $(this).data('username');\r\n\t\t\t\treturn username === thisUsername;\r\n\t\t\t})\r\n\t\t\t.each(function(index, ele) { populateUser(ele); });\r\n\t}\r\n\r\n\tvar _userInfo = {};\r\n\r\n\tfunction populateUser(container) {\r\n\t\tvar username = $(container).data('username');\r\n\r\n\t\t// Ignore \"+ add account\"\r\n\t\tif (typeof username === 'undefined') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar userInfo = _userInfo[username] || {};\r\n\r\n\t\tvar contents = document.createDocumentFragment();\r\n\t\tcontents.appendChild(document.createTextNode(username));\r\n\r\n\t\t// Display the karma of the user\r\n\t\tif (typeof userInfo.link_karma !== 'undefined' && module.options.showKarma.value) {\r\n\t\t\tvar karma = $('<span>').safeHtml('(' + userInfo.link_karma + ' &middot; ' + userInfo.comment_karma + ')');\r\n\t\t\tkarma.appendTo(contents);\r\n\t\t}\r\n\r\n\t\tif (userInfo.is_gold && module.options.showGold.value) {\r\n\t\t\t// If the user has gold display the icon and set the title text to the time remaining till it expires\r\n\r\n\t\t\tvar gilded = RESUtils.createElement('span', null, 'gilded-icon');\r\n\t\t\tif (userInfo.gold_expiration) {\r\n\t\t\t\tvar today = new Date();\r\n\t\t\t\tvar expDate = new Date(userInfo.gold_expiration * 1000); // s -> ms\r\n\t\t\t\tgilded.title = 'Until ' + expDate.toDateString() + ' (' + RESUtils.niceDateDiff(today, expDate) + ')';\r\n\t\t\t}\r\n\r\n\t\t\tcontents.appendChild(gilded);\r\n\t\t}\r\n\r\n\t\t$(container).empty().append(contents);\r\n\t}\r\n\r\n\tfunction updateUserDetails(live) {\r\n\t\tif (!module.options.showUserDetails.value) return;\r\n\t\tvar accounts = module.options.accounts.value;\r\n\t\tif (!accounts) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\taccounts.forEach(function(account, index) {\r\n\t\t\tvar username = account[0];\r\n\t\t\tif (_userInfo[username]) return;\r\n\r\n\t\t\t// Respect API burstiness: space out requests\r\n\t\t\tsetTimeout(RESUtils.getUserInfo, 500 * index, addDetails, username, live);\r\n\t\t\tfunction addDetails(response) {\r\n\t\t\t\t// Fail if retrieving the user's info results in an error (such as a 404)\r\n\t\t\t\tif (!response || response.error || !response.data) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_userInfo[username] = response.data;\r\n\t\t\t\tupdateUser(username);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tfunction toggleAccountMenu(open) {\r\n\t\tif (open) {\r\n\t\t\tvar thisHeight = 18,\r\n\t\t\t\tthisX, thisY;\r\n\t\t\tif (module.accountMenu.css('position') !== 'fixed') {\r\n\t\t\t\tthisX = $(module.userLink).offset().left;\r\n\t\t\t\tthisY = $(module.userLink).offset().top;\r\n\t\t\t} else {\r\n\t\t\t\tthisX = $('#header-bottom-right').position().left + $(module.userLink).position().left;\r\n\t\t\t\tthisY = $(module.userLink).position().top;\r\n\t\t\t\tif (modules['betteReddit'].options.pinHeader.value === 'subanduser') {\r\n\t\t\t\t\tthisHeight += $('#sr-header-area').height();\r\n\t\t\t\t} else if (modules['betteReddit'].options.pinHeader.value === 'header') {\r\n\t\t\t\t\tthisHeight += $('#sr-header-area').height();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t$(module.accountMenu).css({\r\n\t\t\t\ttop: (thisY + thisHeight) + 'px',\r\n\t\t\t\tleft: (thisX) + 'px'\r\n\t\t\t});\r\n\t\t\t$(module.accountMenu).show();\r\n\t\t\tthisX = $(module.downArrow).offset().left;\r\n\t\t\tthisY = $(module.downArrow).offset().top;\r\n\t\t\t$(module.downArrowOverlay).css({\r\n\t\t\t\ttop: (thisY - 4) + 'px',\r\n\t\t\t\tleft: (thisX - 3) + 'px'\r\n\t\t\t});\r\n\r\n\t\t\t$(module.downArrowOverlay).show();\r\n\t\t\tmodules['styleTweaks'].setSRStyleToggleVisibility(false, 'accountSwitcher');\r\n\r\n\t\t} else {\r\n\t\t\t$(module.accountMenu).hide();\r\n\t\t\t$(module.downArrowOverlay).hide();\r\n\t\t\tmodules['styleTweaks'].setSRStyleToggleVisibility(true, 'accountSwitcher');\r\n\t\t}\r\n\t}\r\n\r\n\tmodule.closeAccountMenu = function() {\r\n\t\t// this function basically just exists for other modules to call.\r\n\t\tif (!this.accountMenu) return;\r\n\t\t$(this.accountMenu).hide();\r\n\t};\r\n\r\n\tfunction findMatchingAccount(username, partialMatch) {\r\n\t\tvar accounts = module.options.accounts.value;\r\n\t\tvar matched = accounts.find(function(account) {\r\n\t\t\treturn account[0].toUpperCase() === username.toUpperCase();\r\n\t\t});\r\n\r\n\t\tif (matched || !partialMatch) {\r\n\t\t\treturn matched;\r\n\t\t}\r\n\r\n\t\treturn accounts.find(function(account) {\r\n\t\t\treturn account[0].toUpperCase().indexOf(username.toUpperCase()) === 0;\r\n\t\t});\r\n\t}\r\n\r\n\tfunction switchTo(username) {\r\n\t\tvar account = findMatchingAccount(username);\r\n\t\tif (!account) return;\r\n\t\tusername = account[0];\r\n\t\tvar password = account[1];\r\n\t\tvar rem = '';\r\n\t\tif (module.options.keepLoggedIn.value) {\r\n\t\t\trem = '&rem=on';\r\n\t\t}\r\n\r\n\t\tvar loginUrl = 'https://' + location.hostname + '/api/login';\r\n\r\n\t\t// Remove old session cookie (reddit_session)\r\n\t\t// in FF we also need to remove this (secure_session), but it should be safe to remove either way.\r\n\t\tRESEnvironment.deleteCookies(['reddit_session', 'secure_session'], function() {\r\n\t\t\tRESEnvironment.ajax({\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\turl: loginUrl,\r\n\t\t\t\tisLogin: true,\r\n\t\t\t\tdata: 'user=' + encodeURIComponent(username) + '&passwd=' + encodeURIComponent(password) + rem,\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded'\r\n\t\t\t\t},\r\n\t\t\t\tonload: function(response) {\r\n\t\t\t\t\tvar badData = false;\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tJSON.parse(response.responseText);\r\n\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\tbadData = true;\r\n\t\t\t\t\t\tconsole.log(error);\r\n\t\t\t\t\t\tconsole.log(response.responseText);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar wrongAuthDetails = /WRONG_PASSWORD/;\r\n\t\t\t\t\tvar rateLimit = /RATELIMIT/;\r\n\t\t\t\t\tif (badData) {\r\n\t\t\t\t\t\tmodules['notifications'].showNotification({\r\n\t\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\t\tmoduleID: 'accountSwitcher',\r\n\t\t\t\t\t\t\tmessage: 'Could not switch accounts. Reddit may be under heavy load. Please try again in a few moments.'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else if (wrongAuthDetails.test(response.responseText)) {\r\n\t\t\t\t\t\talert('Could not log in as <b>' + username + '</b> because either the username or password is wrong. ' +\r\n\t\t\t\t\t\t\t'<p>Check your settings?</p>',\r\n\t\t\t\t\t\t\tmanageAccounts);\r\n\t\t\t\t\t\tswitchedAccount(false);\r\n\t\t\t\t\t} else if (rateLimit.test(response.responseText)) {\r\n\t\t\t\t\t\talert('Could not log in as <b>' + username + '</b> because reddit is seeing too many requests from you too quickly. Perhaps you\\'ve been trying to log in using the wrong username or password?' +\r\n\t\t\t\t\t\t'<p>Check your settings?</p>',\r\n\t\t\t\t\t\t\tmanageAccounts);\r\n\t\t\t\t\t\tswitchedAccount(false);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tswitchedAccount(username);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tfunction switchedAccount(username) {\r\n\t\tif (module.options.updateOtherTabs.value) {\r\n\t\t\tRESEnvironment.sendMessage({\r\n\t\t\t\trequestType: 'multicast',\r\n\t\t\t\tmoduleID: 'accountSwitcher',\r\n\t\t\t\tmethod: 'switchedAccountElsewhere',\r\n\t\t\t\targuments: [ username ]\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (username) {\r\n\t\t\tlocation.reload();\r\n\t\t}\r\n\t}\r\n\r\n\tvar _usernameElsewhere;\r\n\tmodule.switchedAccountElsewhere = switchedAccountElsewhere;\r\n\tfunction switchedAccountElsewhere(username) {\r\n\t\tvar setup = (_usernameElsewhere === undefined);\r\n\t\t_usernameElsewhere = username;\r\n\t\tif (setup) {\r\n\t\t\twindow.addEventListener('focus', _onFocus);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction _onFocus() {\r\n\t\tvar currentUsername = (RESUtils.loggedInUser() || '').toLowerCase();\r\n\t\tif (currentUsername === _usernameElsewhere) {\r\n\t\t\t_usernameElsewhere = undefined;\r\n\t\t\twindow.removeEventListener('focus', _onFocus);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t_switchedAccountElsewhere();\r\n\t}\r\n\r\n\tfunction _switchedAccountElsewhere() {\r\n\t\tvar username, hasDraft, switchedMessage, reloadMessage, message;\r\n\t\tusername = _usernameElsewhere;\r\n\r\n\t\thasDraft = Array.prototype.slice.call(document.querySelectorAll('textarea'))\r\n\t\t\t.some(function(textarea) {\r\n\t\t\t\treturn textarea.value;\r\n\t\t\t});\r\n\r\n\t\tif (!hasDraft && module.options.reloadOtherTabs.value) {\r\n\t\t\tlocation.reload();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tswitchedMessage = username ?\r\n\t\t\t'You switched to /u/' + username + '.' :\r\n\t\t\t'You have been logged out.';\r\n\t\treloadMessage = hasDraft ?\r\n\t\t\t'However, you haven\\'t finished posting on this page as /u/' + RESUtils.loggedInUser() + '. Do you want to reload the page anyway?' :\r\n\t\t\t'Reload this page now?';\r\n\t\tmessage = [ switchedMessage, reloadMessage ].join('\\n');\r\n\t\talert(message, location.reload.bind(location));\r\n\t}\r\n\r\n\tfunction manageAccounts() {\r\n\t\tmodules['settingsNavigation'].loadSettingsPage('accountSwitcher', 'accounts');\r\n\t}\r\n});\r\n"],"sourceRoot":"/source/"}
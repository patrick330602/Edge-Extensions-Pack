{"version":3,"sources":["modules/neverEndingReddit.js"],"names":[],"mappings":"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","file":"modules/neverEndingReddit.js","sourcesContent":["addModule('neverEndingReddit', function(module, moduleID) {\r\n\tmodule.moduleName = 'Never Ending Reddit';\r\n\tmodule.category = ['Browsing'];\r\n\tmodule.description = 'Inspired by modules like River of Reddit and Auto Pager - gives you a never ending stream of reddit goodness.';\r\n\tmodule.options = {\r\n\t\treturnToPrevPage: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Return to the page you were last on when hitting \"back\" button?'\r\n\t\t},\r\n\t\tautoLoad: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Automatically load new page on scroll (if off, you click to load)'\r\n\t\t},\r\n\t\tnotifyWhenPaused: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Show a reminder to unpause Never-Ending Reddit after pausing',\r\n\t\t\tadvanced: true\r\n\t\t},\r\n\t\treversePauseIcon: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Show \"paused\" bars icon when auto-load is paused and \"play\" wedge icon when active',\r\n\t\t\tadvanced: true\r\n\t\t},\r\n\t\tshowServerInfo: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Show the π server / debug details next to the floating Never-Ending Reddit tools',\r\n\t\t\tadvanced: true,\r\n\t\t\tbodyClass: true\r\n\t\t},\r\n\t\tpauseAfterEvery: {\r\n\t\t\ttype: 'text',\r\n\t\t\tvalue: 0,\r\n\t\t\tdescription: 'After auto-loading a certain number of pages, pause the auto-loader' + '<br><br>0 or a negative number means Never-Ending Reddit will only pause when you click' + ' the play/pause button in the top right corner.'\r\n\t\t},\r\n\t\thideDupes: {\r\n\t\t\ttype: 'enum',\r\n\t\t\tvalue: 'fade',\r\n\t\t\tvalues: [{\r\n\t\t\t\tname: 'Fade',\r\n\t\t\t\tvalue: 'fade'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Hide',\r\n\t\t\t\tvalue: 'hide'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Do not hide',\r\n\t\t\t\tvalue: 'none'\r\n\t\t\t}],\r\n\t\t\tdescription: 'Fade or completely hide duplicate posts already showing on the page.',\r\n\t\t\tbodyClass: true\r\n\t\t}\r\n\t};\r\n\tmodule.exclude = [\r\n\t\t'wiki',\r\n\t\t'comments'\r\n\t];\r\n\r\n\tvar dupeHash = {};\r\n\tvar siteTable, NREPause, isPaused, isLoading, fromBackButton;\r\n\r\n\tmodule.go = function() {\r\n\t\tif ((this.isEnabled()) && (this.isMatchURL())) {\r\n\t\t\t// code inspired by River of Reddit, but rewritten from scratch to work across multiple browsers...\r\n\t\t\t// Original River of Reddit author: reddy kapil\r\n\t\t\t// Original link to Chrome extension: https://chrome.google.com/extensions/detail/bjiggjllfebckflfdjbimogjieeghcpp\r\n\r\n\t\t\t// store access to the siteTable div since that's where we'll append new data...\r\n\t\t\tsiteTable = RESUtils.thingsContainer();\r\n\r\n\t\t\tif (!siteTable) {\r\n\t\t\t\t// Couldn't find anything to work with, abandon ship\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tsiteTable.classList.add('res-ner-listing');\r\n\r\n\t\t\t// modified from a contribution by Peter Siewert, thanks Peter!\r\n\t\t\tvar entries = document.body.querySelectorAll('a.comments');\r\n\t\t\tfor (var i = entries.length - 1; i > -1; i--) {\r\n\t\t\t\tdupeHash[entries[i].href] = 1;\r\n\t\t\t}\r\n\r\n\t\t\tthis.allLinks = RESUtils.$things();\r\n\r\n\r\n\t\t\t// get the first link to the next page of reddit...\r\n\t\t\tvar nextPrevLinks = this.getNextPrevLinks(siteTable);\r\n\t\t\tif (nextPrevLinks) {\r\n\t\t\t\tvar nextLink = nextPrevLinks.next;\r\n\t\t\t\tif (nextLink) {\r\n\t\t\t\t\tthis.nextPageURL = nextLink.getAttribute('href');\r\n\r\n\t\t\t\t\tattachLoaderWidget();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.options.returnToPrevPage.value) {\r\n\t\t\t\t\treturnToPrevPageCheck(location.hash);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// watch for the user scrolling to the bottom of the page.  If they do it, load a new page.\r\n\t\t\t\tif (this.options.autoLoad.value && nextLink) {\r\n\t\t\t\t\twindow.addEventListener('scroll',\r\n\t\t\t\t\t\tRESUtils.debounce.bind(RESUtils, 'scroll.neverEndingReddit', 300, handleScroll),\r\n\t\t\t\t\t\tfalse);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// check if the user has new mail...\r\n\t\t\tNREPause = RESUtils.createElement('div', 'NREPause');\r\n\t\t\tNREPause.setAttribute('title', 'Pause / Restart Never Ending Reddit');\r\n\t\t\tif (this.options.reversePauseIcon.value) NREPause.classList.add('reversePause');\r\n\t\t\tisPaused = !!RESStorage.getItem('RESmodules.neverEndingReddit.isPaused');\r\n\t\t\tif (isPaused) NREPause.classList.add('paused');\r\n\t\t\tNREPause.addEventListener('click', togglePause, false);\r\n\t\t\tmodules['floater'].addElement(NREPause);\r\n\t\t}\r\n\t};\r\n\r\n\tvar pageMarkers = [];\r\n\r\n\tfunction togglePause() {\r\n\t\tisPaused = !isPaused;\r\n\t\tif (isPaused) {\r\n\t\t\tRESStorage.setItem('RESmodules.neverEndingReddit.isPaused', isPaused);\r\n\t\t} else {\r\n\t\t\tRESStorage.removeItem('RESmodules.neverEndingReddit.isPaused');\r\n\t\t}\r\n\t\tif (isPaused) {\r\n\t\t\tNREPause.classList.add('paused');\r\n\t\t\tif (module.options.notifyWhenPaused.value) {\r\n\t\t\t\tvar notification = [];\r\n\t\t\t\tnotification.push('Never-Ending Reddit has been paused. Click the play/pause button to unpause it.');\r\n\t\t\t\tnotification.push('To hide this message, disable Never-Ending Reddit\\'s ' + modules['settingsNavigation'].makeUrlHashLink('neverEndingReddit', 'notifyWhenPaused', 'notifyWhenPaused option <span class=\"gearIcon\" />') + '.');\r\n\t\t\t\tnotification = notification.join('<br><br>');\r\n\t\t\t\tmodules['notifications'].showNotification({\r\n\t\t\t\t\tmoduleID: 'neverEndingReddit',\r\n\t\t\t\t\tmessage: notification\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tNREPause.classList.remove('paused');\r\n\t\t\thandleScroll();\r\n\t\t}\r\n\t\tsetWidgetActionText();\r\n\t}\r\n\r\n\tfunction returnToPrevPageCheck(hash) {\r\n\t\tvar pageRE = /page=(\\d+)/,\r\n\t\t\tmatch = pageRE.exec(hash);\r\n\t\t// Set the current page to page 1...\r\n\t\tmodule.currPage = 1;\r\n\t\tif (match) {\r\n\t\t\tvar backButtonPageNumber = match[1] || 1;\r\n\t\t\tif (backButtonPageNumber > 1) {\r\n\t\t\t\tattachModalWidget();\r\n\t\t\t\tmodule.currPage = backButtonPageNumber;\r\n\t\t\t\tloadNewPage(true);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/*\r\n\t\tif ((sessionStorage.NERpageURL) && (sessionStorage.NERpageURL !== sessionStorage.lastPageURL)) {\r\n\t\t\tvar backButtonPageNumber = sessionStorage.getItem('NERpage') || 1;\r\n\t\t\tif (backButtonPageNumber > 1) {\r\n\t\t \t\tmodule.currPage = backButtonPageNumber;\r\n\t\t\t\tloadNewPage(true);\r\n\t\t\t}\r\n\t\t}\r\n\t\tsessionStorage.lastPageURL = location.href;\r\n\t\t*/\r\n\t}\r\n\r\n\tfunction handleScroll(e) {\r\n\t\tif (modules['settingsConsole'].isOpen) { // avoid console to close when scrolling\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar thisPageNum = 1,\r\n\t\t\tthisMarker, i, len,\r\n\t\t\tthisXY, thisPageType;\r\n\r\n\t\tfor (i = 0, len = pageMarkers.length; i < len; i++) {\r\n\t\t\tthisXY = RESUtils.getXYpos(pageMarkers[i]);\r\n\t\t\tif (thisXY.y < window.pageYOffset) {\r\n\t\t\t\tthisMarker = pageMarkers[i];\r\n\t\t\t\tthisPageNum = thisMarker.getAttribute('id').replace('page-', '');\r\n\t\t\t\tmodule.currPage = thisPageNum;\r\n\t\t\t\tif (thisMarker) {\r\n\t\t\t\t\tthisPageType = RESUtils.pageType() + '.' + RESUtils.currentSubreddit();\r\n\t\t\t\t\tRESStorage.setItem('RESmodules.neverEndingReddit.lastPage.' + thisPageType, thisMarker.getAttribute('url'));\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthisPageType = RESUtils.pageType() + '.' + RESUtils.currentSubreddit();\r\n\t\tif (thisPageNum !== sessionStorage.NERpage) {\r\n\t\t\tif (thisPageNum > 1) {\r\n\t\t\t\t// sessionStorage.NERpageURL = location.href;\r\n\t\t\t\tsessionStorage.NERpage = thisPageNum;\r\n\t\t\t\tlocation.hash = 'page=' + thisPageNum;\r\n\t\t\t} else {\r\n\t\t\t\tif (location.hash.indexOf('page=') !== -1) {\r\n\t\t\t\t\tlocation.hash = 'page=' + thisPageNum;\r\n\t\t\t\t}\r\n\t\t\t\tdelete sessionStorage['NERpage'];\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!fromBackButton && module.options.returnToPrevPage.value) {\r\n\t\t\tfor (i = 0, len = module.allLinks.length; i < len; i++) {\r\n\t\t\t\tif (RESUtils.elementInViewport(module.allLinks[i])) {\r\n\t\t\t\t\tvar thisClassString = module.allLinks[i].getAttribute('class'),\r\n\t\t\t\t\t\tthisClass = thisClassString.match(/id-t[\\d]_[\\w]+/),\r\n\t\t\t\t\t\tthisID;\r\n\r\n\t\t\t\t\tif (thisClass) {\r\n\t\t\t\t\t\tthisID = thisClass[0];\r\n\t\t\t\t\t\tthisPageType = RESUtils.pageType() + '.' + RESUtils.currentSubreddit();\r\n\t\t\t\t\t\tRESStorage.setItem('RESmodules.neverEndingReddit.lastVisibleIndex.' + thisPageType, thisID);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (RESUtils.elementInViewport(module.progressIndicator) && !fromBackButton) {\r\n\t\t\tif (!isPaused) {\r\n\t\t\t\tloadNewPage();\r\n\t\t\t\tpauseAfter(thisPageNum);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tvar pauseAfterPages = null;\r\n\r\n\tfunction pauseAfter(currPageNum) {\r\n\t\tif (pauseAfterPages === null) {\r\n\t\t\tpauseAfterPages = parseInt(module.options.pauseAfterEvery.value, 10);\r\n\t\t}\r\n\r\n\t\tif ((pauseAfterPages > 0) && (currPageNum % pauseAfterPages === 0)) {\r\n\t\t\ttogglePause(true);\r\n\t\t\tvar notification = [];\r\n\t\t\tnotification.push('Time for a break!');\r\n\t\t\tnotification.push('Never-Ending Reddit was paused automatically. ' + modules['settingsNavigation'].makeUrlHashLink('neverEndingReddit', 'pauseAfterEvery', '', 'gearIcon'));\r\n\t\t\tnotification = notification.join('<br><br>');\r\n\t\t\tsetTimeout(modules['notifications'].showNotification.bind(RESUtils, notification, 5000));\r\n\t\t}\r\n\t}\r\n\r\n\tfunction duplicateCheck(newHTML) {\r\n\t\tvar newLinks = newHTML.querySelectorAll('div.link');\r\n\t\tfor (var i = newLinks.length - 1; i > -1; i--) {\r\n\t\t\tvar newLink = newLinks[i];\r\n\t\t\tvar thisCommentLink = newLink.querySelector('a.comments').href;\r\n\t\t\tif (dupeHash[thisCommentLink]) {\r\n\t\t\t\t// let's not remove it altogether, but instead dim it...\r\n\t\t\t\t// newLink.parentElement.removeChild(newLink);\r\n\t\t\t\tnewLink.classList.add('NERdupe');\r\n\t\t\t} else {\r\n\t\t\t\tdupeHash[thisCommentLink] = 1;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn newHTML;\r\n\t}\r\n\r\n\tvar modalWidget, modalContent;\r\n\r\n\tfunction attachModalWidget() {\r\n\t\tmodalWidget = RESUtils.createElement('div', 'NERModal');\r\n\t\t$(modalWidget).html('&nbsp;');\r\n\t\tmodalContent = RESUtils.createElement('div', 'NERContent');\r\n\t\t$(modalContent).html('<div id=\"NERModalClose\" class=\"RESCloseButton\">&times;</div>Never Ending Reddit has detected that you are returning from a page that it loaded. Please give us a moment while we reload that content and return you to where you left off.<br><span class=\"RESThrobber\"></span>');\r\n\t\tdocument.body.appendChild(modalWidget);\r\n\t\tdocument.body.appendChild(modalContent);\r\n\t\t$('#NERModalClose').click(function() {\r\n\t\t\t$(modalWidget).hide();\r\n\t\t\t$(modalContent).hide();\r\n\t\t});\r\n\t}\r\n\r\n\tfunction attachLoaderWidget() {\r\n\t\t// add a widget at the bottom that will be used to detect that we've scrolled to the bottom, and will also serve as a \"loading\" bar...\r\n\t\tmodule.progressIndicator = document.createElement('div');\r\n\t\tsetWidgetActionText();\r\n\t\tmodule.progressIndicator.id = 'progressIndicator';\r\n\t\tmodule.progressIndicator.className = 'neverEndingReddit';\r\n\r\n\t\tmodule.progressIndicator.addEventListener('click', function(e) {\r\n\t\t\tif (e.target.id !== 'NERStaticLink' && !e.target.classList.contains('gearIcon')) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tloadNewPage();\r\n\t\t\t}\r\n\t\t}, false);\r\n\t\tRESUtils.insertAfter(siteTable, module.progressIndicator);\r\n\t}\r\n\r\n\tmodule.getNextPrevLinks = function(ele) {\r\n\t\tele = ele || document.body;\r\n\t\tvar links = {\r\n\t\t\tnext: ele.querySelector('.content .nextprev a[rel~=next]'),\r\n\t\t\tprev: ele.querySelector('.content .nextprev a[rel~=prev]')\r\n\t\t};\r\n\r\n\t\tif (!(links.next || links.prev)) links = false;\r\n\r\n\t\treturn links;\r\n\t};\r\n\r\n\tfunction setWidgetActionText() {\r\n\t\t$(module.progressIndicator).empty();\r\n\t\t$('<h2>Never Ending Reddit</h2>')\r\n\t\t\t.appendTo(module.progressIndicator)\r\n\t\t\t.append(modules['settingsNavigation'].makeUrlHashLink('neverEndingReddit', null, ' ', 'gearIcon'));\r\n\r\n\t\tvar text = 'Click to load the next page';\r\n\t\tif (module.options.autoLoad.value && !isPaused) {\r\n\t\t\ttext = 'scroll or click to load the next page';\r\n\t\t} else if (module.options.autoLoad.value && isPaused) {\r\n\t\t\ttext = 'click to load the next page; or click the \"pause\" button in the top right corner';\r\n\t\t}\r\n\r\n\t\t$('<p class=\"NERWidgetText\" />')\r\n\t\t\t.text(text)\r\n\t\t\t.appendTo(module.progressIndicator);\r\n\r\n\t\tvar nextpage = $('<a id=\"NERStaticLink\">or open next page</a>')\r\n\t\t\t.attr('href', module.nextPageURL);\r\n\t\t$('<p class=\"NERWidgetText\" />').append(nextpage)\r\n\t\t\t.append('&nbsp;(and clear Never-Ending stream)')\r\n\t\t\t.appendTo(module.progressIndicator);\r\n\t}\r\n\r\n\tfunction loadNewPage(fromBackButton, reload) {\r\n\t\tif (!isLoading) {\r\n\t\t\tisLoading = true;\r\n\t\t\tif (fromBackButton) {\r\n\t\t\t\tfromBackButton = true;\r\n\t\t\t\tvar thisPageType = RESUtils.pageType() + '.' + RESUtils.currentSubreddit();\r\n\t\t\t\tvar savePageURL = module.nextPageURL;\r\n\t\t\t\tmodule.nextPageURL = RESStorage.getItem('RESmodules.neverEndingReddit.lastPage.' + thisPageType);\r\n\t\t\t\tif ((module.nextPageURL === 'undefined') || (module.nextPageURL === null)) {\r\n\t\t\t\t\t// something went wrong, probably someone hit refresh. Just revert to the first page...\r\n\t\t\t\t\tfromBackButton = false;\r\n\t\t\t\t\tmodule.nextPageURL = savePageURL;\r\n\t\t\t\t\tmodule.currPage = 1;\r\n\t\t\t\t\tisLoading = false;\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tvar leftCentered = Math.floor((window.innerWidth - 720) / 2);\r\n\t\t\t\tmodalWidget.style.display = 'block';\r\n\t\t\t\tmodalContent.style.display = 'block';\r\n\t\t\t\tmodalContent.style.left = leftCentered + 'px';\r\n\t\t\t\t// remove the progress indicator early, as we don't want the user to scroll past it on accident, loading more content.\r\n\t\t\t\tmodule.progressIndicator.parentNode.removeChild(module.progressIndicator);\r\n\t\t\t} else {\r\n\t\t\t\tfromBackButton = false;\r\n\t\t\t}\r\n\r\n\r\n\t\t\tmodule.progressIndicator.removeEventListener('click', loadNewPage, false);\r\n\t\t\t$(module.progressIndicator).html('<span class=\"NERWidgetText\">Loading next page...</span><span class=\"RESThrobber\"></span>');\r\n\t\t\t// as a sanity check, which should NEVER register true, we'll make sure me.nextPageURL is on the same domain we're browsing...\r\n\t\t\tif (module.nextPageURL && module.nextPageURL.indexOf(location.hostname) === -1) {\r\n\t\t\t\tconsole.log('Next page URL mismatch. Something strange may be afoot.');\r\n\t\t\t\tisLoading = false;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tRESEnvironment.ajax({\r\n\t\t\t\tmethod: 'GET',\r\n\t\t\t\turl: module.nextPageURL,\r\n\t\t\t\tonload: function(response) {\r\n\t\t\t\t\tif (module.progressIndicator.parentNode) {\r\n\t\t\t\t\t\tmodule.progressIndicator.parentNode.removeChild(module.progressIndicator);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// drop the HTML we got back into a div...\r\n\t\t\t\t\tvar thisHTML = response.responseText;\r\n\t\t\t\t\tvar tempDiv = document.createElement('div');\r\n\t\t\t\t\t// clear out any javascript so we don't render it again...\r\n\t\t\t\t\t$(tempDiv).html(thisHTML.replace(/<script(.|\\s)*?\\/script>/g, ''));\r\n\t\t\t\t\t// grab the siteTable out of there...\r\n\t\t\t\t\tvar newHTML = RESUtils.thingsContainer(tempDiv);\r\n\t\t\t\t\t// did we find anything?\r\n\t\t\t\t\tif (newHTML) {\r\n\t\t\t\t\t\tvar firstLen, lastLen;\r\n\t\t\t\t\t\tnewHTML.setAttribute('ID', 'siteTable-' + module.currPage + 1);\r\n\t\t\t\t\t\tfirstLen = $('body').find('.link:last .rank').text().length;\r\n\t\t\t\t\t\tlastLen = $(newHTML).find('.link:last .rank').text().length;\r\n\t\t\t\t\t\tif (lastLen > firstLen) {\r\n\t\t\t\t\t\t\tlastLen = (lastLen * 1.1).toFixed(1);\r\n\t\t\t\t\t\t\tRESUtils.addCSS('body.res > .content .link .rank { width: ' + lastLen + 'ex; }');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tduplicateCheck(newHTML);\r\n\t\t\t\t\t\t// check for new mail\r\n\t\t\t\t\t\tmodules['orangered'].updateFromPage(tempDiv);\r\n\t\t\t\t\t\t// get the new nextLink value for the next page...\r\n\t\t\t\t\t\tvar nextPrevLinks = module.getNextPrevLinks(tempDiv);\r\n\t\t\t\t\t\tif (nextPrevLinks) {\r\n\t\t\t\t\t\t\tif (isNaN(module.currPage)) module.currPage = 1;\r\n\t\t\t\t\t\t\tif (!fromBackButton) module.currPage++;\r\n\t\t\t\t\t\t\tif ((!(fromBackButton)) && (module.options.returnToPrevPage.value)) {\r\n\t\t\t\t\t\t\t\tvar thisPageType = RESUtils.pageType() + '.' + RESUtils.currentSubreddit();\r\n\t\t\t\t\t\t\t\tRESStorage.setItem('RESmodules.neverEndingReddit.lastPage.' + thisPageType, module.nextPageURL);\r\n\t\t\t\t\t\t\t\t// location.hash = 'page='+module.currPage;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar nextLink = nextPrevLinks.next;\r\n\t\t\t\t\t\t\tvar nextPage = module.currPage;\r\n\t\t\t\t\t\t\tvar pageMarker = RESUtils.createElement('div', 'page-' + nextPage);\r\n\t\t\t\t\t\t\tpageMarker.classList.add('NERPageMarker');\r\n\t\t\t\t\t\t\t$(pageMarker).text('Page ' + nextPage);\r\n\t\t\t\t\t\t\tsiteTable.appendChild(pageMarker);\r\n\t\t\t\t\t\t\tpageMarkers.push(pageMarker);\r\n\t\t\t\t\t\t\tsiteTable.appendChild(newHTML);\r\n\t\t\t\t\t\t\tisLoading = false;\r\n\t\t\t\t\t\t\tif (nextLink) {\r\n\t\t\t\t\t\t\t\t// console.log(nextLink);\r\n\t\t\t\t\t\t\t\tpageMarker.setAttribute('url', module.nextPageURL);\r\n\t\t\t\t\t\t\t\tif (nextLink.getAttribute('rel').indexOf('prev') !== -1) {\r\n\t\t\t\t\t\t\t\t\t// remove the progress indicator from the DOM, it needs to go away.\r\n\t\t\t\t\t\t\t\t\tmodule.progressIndicator.style.display = 'none';\r\n\t\t\t\t\t\t\t\t\tvar endOfReddit = RESUtils.createElement('div', 'endOfReddit');\r\n\t\t\t\t\t\t\t\t\t$(endOfReddit).text('You\\'ve reached the last page available.  There are no more pages to load.');\r\n\t\t\t\t\t\t\t\t\tsiteTable.appendChild(endOfReddit);\r\n\t\t\t\t\t\t\t\t\twindow.removeEventListener('scroll', handleScroll, false);\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t// console.log('not over yet');\r\n\t\t\t\t\t\t\t\t\tmodule.nextPageURL = nextLink.getAttribute('href');\r\n\t\t\t\t\t\t\t\t\tattachLoaderWidget();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tmodule.allLinks = RESUtils.$things();\r\n\t\t\t\t\t\t\tif ((fromBackButton) && (module.options.returnToPrevPage.value)) {\r\n\t\t\t\t\t\t\t\t// TODO: it'd be great to figure out a better way than a timeout, but this\r\n\t\t\t\t\t\t\t\t// has considerably helped the accuracy of RES's ability to return you to where\r\n\t\t\t\t\t\t\t\t// you left off.\r\n\t\t\t\t\t\t\t\tsetTimeout(scrollToLastElement, 4000, newHTML);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// If we're on the reddit-browsing page (/reddits or /subreddits), add +shortcut and -shortcut buttons...\r\n\t\t\t\t\t\t\tif (/^https?:\\/\\/www\\.reddit\\.com\\/(?:sub)?reddits\\/?(?:\\?[\\w=&]+)*/.test(location.href)) {\r\n\t\t\t\t\t\t\t\tmodules['subredditManager'].browsingReddits();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// var nextPrevLinks = newHTML && module.getNextPrevLinks(newHTML);\r\n\t\t\t\t\t\tif (!(nextPrevLinks && nextPrevLinks.next)) {\r\n\t\t\t\t\t\t\tvar noresults = tempDiv.querySelector('#noresults');\r\n\t\t\t\t\t\t\tvar noresultsfound = !!noresults;\r\n\t\t\t\t\t\t\tNERFail(noresultsfound);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar e = document.createEvent('Events');\r\n\t\t\t\t\t\te.initEvent('neverEndingLoad', true, true);\r\n\t\t\t\t\t\twindow.dispatchEvent(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tonerror: function(err) {\r\n\t\t\t\t\tNERFail();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\t// console.log('load new page ignored');\r\n\t\t}\r\n\t}\r\n\r\n\tfunction scrollToLastElement(newHTML) {\r\n\t\tmodalWidget.style.display = 'none';\r\n\t\tmodalContent.style.display = 'none';\r\n\t\tvar thisPageType = RESUtils.pageType() + '.' + RESUtils.currentSubreddit();\r\n\t\tvar lastTopScrolledID = RESStorage.getItem('RESmodules.neverEndingReddit.lastVisibleIndex.' + thisPageType);\r\n\t\tvar lastTopScrolledEle = document.body.querySelector('.' + lastTopScrolledID);\r\n\t\tif (!lastTopScrolledEle) {\r\n\t\t\tlastTopScrolledEle = RESUtils.$things(newHTML);\r\n\t\t}\r\n\t\tvar thisXY = RESUtils.getXYpos(lastTopScrolledEle);\r\n\t\tRESUtils.scrollTo(0, thisXY.y);\r\n\t\tfromBackButton = false;\r\n\t}\r\n\r\n\tfunction NERFail(noresults) {\r\n\t\tisLoading = false;\r\n\t\tvar newHTML = RESUtils.createElement('div', 'NERFail');\r\n\t\tvar failureMessage = noresults ? 'There doesn\\'t seem to be anything here!' : 'Couldn\\'t load any more posts';\r\n\t\tvar start = location.href.split('#')[0];\r\n\t\tvar retry = module.nextPageURL;\r\n\t\t$(newHTML).html('\t\\\r\n\t\t\t<h3>\t\\\r\n\t\t\t\t' + failureMessage + '\t\\\r\n\t\t\t\t<a target=\"_blank\" href=\"/r/Enhancement/comments/s72xt/never_ending_reddit_and_reddit_barfing_explained/\">(Why not?)</a>\t\\\r\n\t\t\t</h3>\t\\\r\n\t\t\t<p class=\"nextprev\">\t\\\r\n\t\t\t\t<a href=\"' + start + '\">start over</a>\t\\\r\n\t\t\t\t<a href=\"' + retry + '\">try again</a>\t\\\r\n\t\t\t\t<a href=\"/r/random\">check out a random subreddit</a>\t\\\r\n\t\t\t</p>\t\\\r\n\t\t\t');\r\n\t\tnewHTML.setAttribute('style', 'cursor: auto !important;');\r\n\r\n\r\n\t\tsiteTable.appendChild(newHTML);\r\n\t\tif (modalWidget) {\r\n\t\t\tmodalWidget.style.display = 'none';\r\n\t\t\tmodalContent.style.display = 'none';\r\n\t\t}\r\n\t}\r\n});\r\n"],"sourceRoot":"/source/"}
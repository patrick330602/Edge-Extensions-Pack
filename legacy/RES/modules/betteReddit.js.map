{"version":3,"sources":["modules/betteReddit.js"],"names":[],"mappings":"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","file":"modules/betteReddit.js","sourcesContent":["addModule('betteReddit', function(module, moduleID) {\r\n\tmodule.moduleName = 'betteReddit';\r\n\tmodule.category = ['Appearance'];\r\n\tmodule.description = 'Adds a number of interface enhancements to Reddit, such as \"full comments\" links, the ability to unhide accidentally hidden posts, and more';\r\n\tmodule.options = {\r\n\t\tfullCommentsLink: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Add \"full comments\" link to comment replies, etc.'\r\n\t\t},\r\n\t\tfullCommentsText: {\r\n\t\t\ttype: 'text',\r\n\t\t\tvalue: 'full comments',\r\n\t\t\tdescription: 'Text of full comments link.',\r\n\t\t\tadvanced: true,\r\n\t\t\tdependsOn: 'fullCommentsLink'\r\n\t\t},\r\n\t\tcommentsLinksNewTabs: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Open links found in comments in a new tab.'\r\n\t\t},\r\n\t\tfixHideLinks: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Changes \"hide\" links to read as \"hide\" or \"unhide\" depending on the hide state. Also adds a 5 second delay prior to hiding the link.'\r\n\t\t},\r\n\t\tvideoTimes: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Show lengths of videos when possible',\r\n\t\t\tadvanced: true\r\n\t\t},\r\n\t\tvideoUploaded: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Show upload date of videos when possible',\r\n\t\t\tadvanced: true\r\n\t\t},\r\n\t\tvideoViewed: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Show number of views for a video when possible',\r\n\t\t\tadvanced: true\r\n\t\t},\r\n\t\tpinHeader: {\r\n\t\t\ttype: 'enum',\r\n\t\t\tvalues: [{\r\n\t\t\t\tname: 'None',\r\n\t\t\t\tvalue: 'none'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Subreddit Bar only',\r\n\t\t\t\tvalue: 'sub'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'User Bar',\r\n\t\t\t\tvalue: 'userbar'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Subreddit Bar and User bar',\r\n\t\t\t\tvalue: 'subanduser'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Full Header',\r\n\t\t\t\tvalue: 'header'\r\n\t\t\t}],\r\n\t\t\tvalue: 'none',\r\n\t\t\tdescription: 'Pin the subreddit bar, user menu, or header to top, floating down as you scroll.',\r\n\t\t\tbodyClass: 'pinHeader'\r\n\t\t},\r\n\t\t/*turboSelfText: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Preload selftext data to make selftext expandos faster (preloads after first expando)',\r\n\t\t\tadvanced: true\r\n\t\t},*/\r\n\t\tshowLastEditedTimestamp: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Show the time that a text post/comment was edited, without having to hover the timestamp.',\r\n\t\t\tbodyClass: true\r\n\t\t},\r\n\t\tscoreHiddenTimeLeft: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'When hovering [score hidden] show time left instead of hide duration.'\r\n\t\t},\r\n\t\tshowTimestampPosts: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Show the precise date (Sun Nov 16 20:14:56 2014 UTC) instead of a relative date (7 days ago), for posts.',\r\n\t\t\tbodyClass: true\r\n\t\t},\r\n\t\tshowTimestampComments: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Show the precise date for comments / messages.',\r\n\t\t\tbodyClass: true\r\n\t\t},\r\n\t\tshowTimestampSidebar: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Show the precise date in the sidebar.',\r\n\t\t\tbodyClass: true\r\n\t\t},\r\n\t\tshowTimestampWiki: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Show the precise date in the wiki.',\r\n\t\t\tbodyClass: true\r\n\t\t},\r\n\t\tshowTimestampModerationLog: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Show the precise date in the moderation log (/r/mod/about/log).',\r\n\t\t\tbodyClass: true\r\n\t\t},\r\n\t\trestoreSavedTab: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'The saved tab is now located in the multireddit sidebar. This will restore a \"saved\" link to the header (next to the \"hot\", \"new\", etc. tabs).'\r\n\t\t},\r\n\t\tdoNoCtrlF: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Modify reddit\\'s comment/link buttons (\"perma-link source save...\") such that they don\\'t show up in searches. Disabled by default due to a slight performance impact.'\r\n\t\t}\r\n\t};\r\n\tmodule.go = function() {\r\n\t\tif ((this.isEnabled()) && (this.isMatchURL())) {\r\n\t\t\tif ((RESUtils.pageType() === 'comments') && (this.options.commentsLinksNewTabs.value)) {\r\n\t\t\t\tcommentsLinksNewTabs();\r\n\t\t\t\tRESUtils.watchForElement('newComments', commentsLinksNewTabs);\r\n\t\t\t}\r\n\t\t\t// if (((RESUtils.pageType() === 'inbox') || (RESUtils.pageType() === 'profile') || ((RESUtils.pageType() === 'comments') && (RESUtils.currentSubreddit('friends')))) && (this.options.fullCommentsLink.value)) {\r\n\t\t\t// removed profile pages since Reddit does this natively now for those...\r\n\t\t\tif ((RESUtils.pageType() === 'inbox') && (this.options.fullCommentsLink.value)) {\r\n\t\t\t\tfullComments();\r\n\t\t\t\tRESUtils.watchForElement('siteTable', fullComments);\r\n\t\t\t}\r\n\r\n\t\t\tif (((RESUtils.pageType() === 'linklist') || (RESUtils.pageType() === 'comments')) && (this.options.fixHideLinks.value)) {\r\n\t\t\t\tfixHideLinks();\r\n\t\t\t\tRESUtils.watchForElement('siteTable', fixHideLinks);\r\n\t\t\t}\r\n\t\t\t// temporarily disabling turboselftext because it seems to cause occasional issues\r\n\t\t\t// with video autoplay (only on first, non-turbo expando)\r\n\t\t\t//\r\n\t\t\t// if ((this.options.turboSelfText.value) && (RESUtils.pageType() === 'linklist')) {\r\n\t\t\t//     setUpTurboSelfText();\r\n\t\t\t// }\r\n\r\n\t\t\tif (this.options.doNoCtrlF.value) {\r\n\t\t\t\tif ((RESUtils.pageType() === 'inbox') || (RESUtils.pageType() === 'profile') || (RESUtils.pageType() === 'linklist')) {\r\n\t\t\t\t\tapplyNoCtrlF(document);\r\n\t\t\t\t\tRESUtils.watchForElement('siteTable', applyNoCtrlF);\r\n\t\t\t\t} else if (RESUtils.pageType() === 'comments') {\r\n\t\t\t\t\tapplyNoCtrlF(document);\r\n\t\t\t\t\tRESUtils.watchForElement('newComments', applyNoCtrlF);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif ((module.options.scoreHiddenTimeLeft.value) && (RESUtils.pageType() === 'comments')) {\r\n\t\t\t\t$('.tagline').on('mouseenter', 'span:contains([)', function() {\r\n\t\t\t\t\tvar timeNode;\r\n\t\t\t\t\tif (this.nextSibling && ( timeNode = this.nextSibling.nextSibling) && this.nextSibling.nextSibling.tagName === 'TIME') { // avoid flair with [\r\n\t\t\t\t\t\tif (this.getAttribute('title').indexOf('revealed') === -1) {\r\n\t\t\t\t\t\t\tvar scoreHiddenDuration = parseInt(this.getAttribute('title').match(/[0-9]+/)[0], 10);\r\n\t\t\t\t\t\t\tvar postTime = new Date(timeNode.getAttribute('datetime')).getTime();\r\n\t\t\t\t\t\t\tvar minutesLeft = Math.ceil((postTime + scoreHiddenDuration * 60000 - new Date().getTime()) / 60000);\r\n\t\t\t\t\t\t\tthis.setAttribute('title', 'score will be revealed in ' + minutesLeft + ' minute' + (minutesLeft > 1 ? 's' : ''));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (this.options.showTimestampSidebar.value) {\r\n\t\t\t\tvar subredditAge = document.body.querySelector('.side .age');\r\n\t\t\t\tif (subredditAge) {\r\n\t\t\t\t\tsubredditAge.firstChild.data = 'a community since ';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif ((module.options.restoreSavedTab.value) && (RESUtils.loggedInUser() !== null) && document.querySelector('.with-listing-chooser:not(.profile-page)')) {\r\n\t\t\t\trestoreSavedTab();\r\n\t\t\t}\r\n\t\t\tif ((this.options.videoTimes.value) && ((RESUtils.pageType() === 'linklist') || (RESUtils.pageType() === 'comments'))) {\r\n\t\t\t\tgetVideoTimes();\r\n\t\t\t\tRESUtils.watchForElement('siteTable', getVideoTimes);\r\n\t\t\t}\r\n\t\t\tswitch (this.options.pinHeader.value) {\r\n\t\t\t\tcase 'header':\r\n\t\t\t\t\tpinHeader();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'sub':\r\n\t\t\t\t\tpinSubredditBar();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'subanduser':\r\n\t\t\t\t\tpinSubredditBar();\r\n\t\t\t\t\tpinUserBar();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'userbar':\r\n\t\t\t\t\tpinUserBar();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tfunction commentsLinksNewTabs(ele) {\r\n\t\tele = ele || document.body;\r\n\t\tvar links = ele.querySelectorAll('.thing div.md a');\r\n\t\tArray.prototype.slice.call(links).forEach(function(link) {\r\n\t\t\tlink.target = '_blank';\r\n\t\t});\r\n\t}\r\n\r\n\t// the following is only used by turboSelfText which is disabled.\r\n\t/*var selfTextHash = {};\r\n\tfunction setUpTurboSelfText() {\r\n\t\t// TODO: Turbo selftext seems a little wonky on NER pages\r\n\t\t$('body').on('click', '.expando-button.selftext:not(\".twitter\"):not(.toggleImage)', showSelfText);\r\n\t\t$('#siteTable').data('jsonURL', location.href + '.json');\r\n\r\n\t\tRESUtils.watchForElement('siteTable', setNextSelftextURL);\r\n\t}\r\n\r\n\tfunction setNextSelftextURL(ele) {\r\n\t\tif (modules['neverEndingReddit'].nextPageURL) {\r\n\t\t\tvar jsonURL = modules['neverEndingReddit'].nextPageURL.replace('/?', '/.json?');\r\n\t\t\t$(ele).data('jsonURL', jsonURL);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction showSelfText(event) {\r\n\t\tvar thisID = $(event.target).parent().parent().data('fullname');\r\n\t\tif (typeof selfTextHash[thisID] === 'undefined') {\r\n\t\t\t// we haven't gotten JSON data for this set of links yet... get it, then replace the click listeners with our own...\r\n\t\t\tvar jsonURL = $(event.target).closest('.sitetable.linklisting').data('jsonURL');\r\n\t\t\tgetSelfTextData(jsonURL);\r\n\t\t} else {\r\n\t\t\tif (!$(event.target).hasClass('expanded')) {\r\n\t\t\t\t// the duplicate classes here unfortunately have to exist due to Reddit clobbering things with .collapsed\r\n\t\t\t\t// and no real elegant way that I've thought of to fix the fact that selfText expandos still have that class.\r\n\t\t\t\t$(event.target).removeClass('collapsed collapsedExpando');\r\n\t\t\t\t$(event.target).addClass('expanded');\r\n\t\t\t\t$(event.target).parent().find('.expando').html(\r\n\t\t\t\t\t'<form class=\"usertext\"><div class=\"usertext-body\">' +\r\n\t\t\t\t\t$('<div/>').html(selfTextHash[thisID]).text() +\r\n\t\t\t\t\t'</div></form>'\r\n\t\t\t\t).show();\r\n\t\t\t} else {\r\n\t\t\t\t$(event.target).removeClass('expanded');\r\n\t\t\t\t$(event.target).addClass('collapsedExpando');\r\n\t\t\t\t$(event.target).addClass('collapsed');\r\n\t\t\t\t$(event.target).parent().find('.expando').hide();\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tvar gettingSelfTextData;\r\n\r\n\tfunction getSelfTextData(href) {\r\n\t\tif (!gettingSelfTextData) {\r\n\t\t\tgettingSelfTextData = true;\r\n\t\t\t$.getJSON(href, applyTurboSelfText);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction applyTurboSelfText(data) {\r\n\t\tvar linkList = data.data.children;\r\n\r\n\t\tgettingSelfTextData = undefined;\r\n\t\tlinkList.forEach(function(ele, i) {\r\n\t\t\tvar thisID = ele.data.name;\r\n\t\t\tif (i === 0) {\r\n\t\t\t\tvar thisSiteTable = $('.id-' + thisID).closest('.sitetable.linklisting'),\r\n\t\t\t\t\tnewEle;\r\n\r\n\t\t\t\t// clone the selftext expando button without events, so as to remove\r\n\t\t\t\t// conflicting event listeners.\r\n\t\t\t\t$(thisSiteTable).find('.expando-button.selftext:not(\".twitter\"):not(.toggleImage)').each(function() {\r\n\t\t\t\t\tthis.removeAttribute('onclick');\r\n\t\t\t\t\tnewEle = this.cloneNode(true);\r\n\t\t\t\t\tthis.parentNode.replaceChild(newEle, this);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tselfTextHash[thisID] = ele.data.selftext_html;\r\n\t\t});\r\n\t}*/\r\n\r\n\tvar deprecateFullComments;\r\n\r\n\tfunction fullComments(ele) {\r\n\t\tif (deprecateFullComments) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar root = ele || document,\r\n\t\t\tentries = root.querySelectorAll('#siteTable .entry'),\r\n\t\t\tlinkEle, thisCommentsLink, thisCommentsSplit, linkList, depTest,\r\n\t\t\tfullCommentsLinkContainer, fullCommentsLink;\r\n\r\n\t\t// check if reddit's new native full comments link exists, and if so, deprecate\r\n\t\t// so we no longer run this function.\r\n\t\tif (entries && entries[0]) {\r\n\t\t\tdepTest = entries[0].querySelector('a.full-comments');\r\n\t\t}\r\n\t\tif (depTest) {\r\n\t\t\tdeprecateFullComments = true;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tArray.prototype.slice.call(entries).forEach(function(entry) {\r\n\t\t\tlinkEle = entry.querySelector('a.bylink');\r\n\t\t\tthisCommentsLink = '';\r\n\t\t\tif ((typeof linkEle !== 'undefined') && (linkEle !== null)) {\r\n\t\t\t\tthisCommentsLink = linkEle.getAttribute('href');\r\n\t\t\t}\r\n\t\t\tif (thisCommentsLink !== '') {\r\n\t\t\t\tthisCommentsSplit = thisCommentsLink.split('/');\r\n\t\t\t\tthisCommentsSplit.pop();\r\n\t\t\t\tthisCommentsLink = thisCommentsSplit.join('/');\r\n\t\t\t\tlinkList = entry.querySelector('.flat-list');\r\n\t\t\t\tfullCommentsLinkContainer = document.createElement('li');\r\n\t\t\t\tfullCommentsLink = RESUtils.createElement('a', null, 'redditFullComments');\r\n\t\t\t\tfullCommentsLink.href = thisCommentsLink;\r\n\t\t\t\tfullCommentsLink.textContent = module.options.fullCommentsText.value;\r\n\t\t\t\tfullCommentsLinkContainer.appendChild(fullCommentsLink);\r\n\t\t\t\tlinkList.appendChild(fullCommentsLinkContainer);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tfunction fixHideLinks(ele) {\r\n\t\tvar root = ele || document,\r\n\t\t\thideLinks = root.querySelectorAll('form.hide-button > span > a'),\r\n\t\t\tunhideLinks = document.querySelectorAll('form.unhide-button > span > a');\r\n\r\n\t\tArray.prototype.slice.call(hideLinks).forEach(function(link) {\r\n\t\t\tvar newLink = RESUtils.createElement('a', null, null, 'hide');\r\n\t\t\tnewLink.setAttribute('action', 'hide');\r\n\t\t\tnewLink.setAttribute('href', '#');\r\n\t\t\tnewLink.addEventListener('click', hideLinkEventHandler, false);\r\n\t\t\tvar parent = link.parentNode;\r\n\t\t\tparent.removeChild(link);\r\n\t\t\tparent.appendChild(newLink);\r\n\t\t});\r\n\r\n\t\tArray.prototype.slice.call(unhideLinks).forEach(function(link) {\r\n\t\t\tvar newLink = RESUtils.createElement('a', null, null, 'unhide');\r\n\t\t\tnewLink.setAttribute('action', 'unhide');\r\n\t\t\tnewLink.setAttribute('href', '#');\r\n\t\t\tnewLink.addEventListener('click', hideLinkEventHandler, false);\r\n\t\t\tvar parent = link.parentNode;\r\n\t\t\tparent.removeChild(link);\r\n\t\t\tparent.appendChild(newLink);\r\n\t\t});\r\n\t}\r\n\r\n\tfunction hideLinkEventHandler(e) {\r\n\t\te.preventDefault();\r\n\t\thideLink(e.target);\r\n\t}\r\n\r\n\tvar modhash, hideTimer;\r\n\r\n\tfunction hideLink(clickedLink) {\r\n\t\tif (clickedLink.getAttribute('action') === 'unhide') {\r\n\t\t\t$(clickedLink).text('unhiding...');\r\n\t\t} else {\r\n\t\t\t$(clickedLink).text('hiding...');\r\n\t\t}\r\n\t\tif (modhash) {\r\n\t\t\tvar action = clickedLink.getAttribute('action'),\r\n\t\t\t\tparentThing = clickedLink.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode,\r\n\t\t\t\tidRe = /id-([\\w]+)/i,\r\n\t\t\t\tgetLinkid = idRe.exec(parentThing.getAttribute('class')),\r\n\t\t\t\tlinkid = getLinkid[1],\r\n\t\t\t\texecuted, apiURL, params;\r\n\r\n\t\t\tif (action === 'unhide') {\r\n\t\t\t\texecuted = 'unhidden';\r\n\t\t\t\tapiURL = location.protocol + '//' + location.hostname + '/api/unhide';\r\n\t\t\t} else {\r\n\t\t\t\texecuted = 'hidden';\r\n\t\t\t\tapiURL = location.protocol + '//' + location.hostname + '/api/hide';\r\n\t\t\t}\r\n\t\t\tparams = 'id=' + linkid + '&executed=' + executed + '&uh=' + modhash + '&renderstyle=html';\r\n\r\n\t\t\tRESEnvironment.ajax({\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\turl: apiURL,\r\n\t\t\t\tdata: params,\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded'\r\n\t\t\t\t},\r\n\t\t\t\tonload: function(response) {\r\n\t\t\t\t\tif (response.status === 200) {\r\n\t\t\t\t\t\tif (clickedLink.getAttribute('action') === 'unhide') {\r\n\t\t\t\t\t\t\t$(clickedLink).text('hide');\r\n\t\t\t\t\t\t\tclickedLink.setAttribute('action', 'hide');\r\n\t\t\t\t\t\t\tif (typeof hideTimer !== 'undefined') {\r\n\t\t\t\t\t\t\t\tclearTimeout(hideTimer);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$(clickedLink).text('unhide');\r\n\t\t\t\t\t\t\tclickedLink.setAttribute('action', 'unhide');\r\n\t\t\t\t\t\t\thideTimer = setTimeout(function() {\r\n\t\t\t\t\t\t\t\thideFader(clickedLink);\r\n\t\t\t\t\t\t\t}, 5000);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmodhash = undefined;\r\n\t\t\t\t\t\talert('Sorry, there was an error trying to ' + clickedLink.getAttribute('action') + ' your submission. Try clicking again.');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tRESEnvironment.ajax({\r\n\t\t\t\tmethod: 'GET',\r\n\t\t\t\turl: location.protocol + '//' + location.hostname + '/api/me.json?app=res',\r\n\t\t\t\tonload: function(response) {\r\n\t\t\t\t\tvar data = safeJSON.parse(response.responseText);\r\n\t\t\t\t\tif (typeof data.data === 'undefined') {\r\n\t\t\t\t\t\talert('Sorry, there was an error trying to ' + clickedLink.getAttribute('action') + ' your submission. You may have third party cookies disabled. You will need to either enable third party cookies, or add an exception for *.reddit.com');\r\n\t\t\t\t\t} else if ((typeof data.data.modhash !== 'undefined') && (data.data.modhash)) {\r\n\t\t\t\t\t\tmodhash = data.data.modhash;\r\n\t\t\t\t\t\thideLink(clickedLink);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tfunction hideFader(ele) {\r\n\t\tvar parentThing = ele.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;\r\n\t\tRESUtils.fadeElementOut(parentThing, 0.3);\r\n\t}\r\n\r\n\tvar youtubeLinkIDs, youtubeLinkRefs;\r\n\r\n\tfunction getVideoTimes(obj) {\r\n\t\tobj = obj || document;\r\n\t\tvar youtubeLinks = obj.querySelectorAll('a.title[href*=\"youtube.com\"], a.title[href*=\"youtu.be\"]'),\r\n\t\t\ttitleHasTimeRegex = /[\\[|\\(][0-9]*:[0-9]*[\\]|\\)]/;\r\n\t\tif (youtubeLinks) {\r\n\t\t\tyoutubeLinks = Array.prototype.slice.call(youtubeLinks).filter(function(link) {\r\n\t\t\t\treturn !titleHasTimeRegex.test(link.textContent);\r\n\t\t\t});\r\n\t\t\tvar getYoutubeIDRegex = /\\/?[\\&|\\?]?v\\/?=?([\\w\\-]{11})&?/i,\r\n\t\t\t\tgetShortenedYoutubeIDRegex = /([\\w\\-]{11})&?/i,\r\n\t\t\t\tgetYoutubeStartTimeRegex = /\\[[\\d]+:[\\d]+\\]/i,\r\n\t\t\t\ttempIDs = [];\r\n\t\t\tyoutubeLinkIDs = {};\r\n\t\t\tyoutubeLinkRefs = [];\r\n\t\t\tyoutubeLinks.forEach(function(link) {\r\n\t\t\t\tvar match = getYoutubeIDRegex.exec(link.getAttribute('href')),\r\n\t\t\t\t\tshortened = /youtu\\.be/i,\r\n\t\t\t\t\tisShortened = shortened.exec(link.getAttribute('href')),\r\n\t\t\t\t\tthisYTID;\r\n\t\t\t\tif (isShortened) {\r\n\t\t\t\t\tvar smatch = getShortenedYoutubeIDRegex.exec(link.getAttribute('href'));\r\n\t\t\t\t\tif (smatch) {\r\n\t\t\t\t\t\tthisYTID = '\"' + smatch[1] + '\"';\r\n\t\t\t\t\t\tyoutubeLinkIDs[thisYTID] = link;\r\n\t\t\t\t\t\tyoutubeLinkRefs.push([thisYTID, link]);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (match) {\r\n\t\t\t\t\t// add quotes so URL creation is doable with just a join...\r\n\t\t\t\t\tthisYTID = '\"' + match[1] + '\"';\r\n\t\t\t\t\tyoutubeLinkIDs[thisYTID] = link;\r\n\t\t\t\t\tyoutubeLinkRefs.push([thisYTID, link]);\r\n\t\t\t\t}\r\n\t\t\t\tvar timeMatch = getYoutubeStartTimeRegex.exec(link.getAttribute('href'));\r\n\t\t\t\tvar titleMatch = titleHasTimeRegex.test(link.textContent);\r\n\t\t\t\tif (timeMatch && !titleMatch) {\r\n\t\t\t\t\tlink.textContent += ' (@' + timeMatch[1] + ')';\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tfor (var id in youtubeLinkIDs) {\r\n\t\t\t\t// for security since these will become URL parameters, encodeURIComponent:\r\n\t\t\t\ttempIDs.push(encodeURIComponent(id));\r\n\t\t\t}\r\n\t\t\tyoutubeLinkIDs = tempIDs;\r\n\t\t\tgetVideoJSON();\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getVideoJSON() {\r\n\t\tvar thisBatch = youtubeLinkIDs.splice(0, 8);\r\n\t\tif (thisBatch.length) {\r\n\t\t\tvar thisIDString = thisBatch.join('%7C');\r\n\t\t\t// var jsonURL = 'http://gdata.youtube.com/feeds/api/videos?q='+thisIDString+'&fields=entry(id,media:group(yt:duration))&alt=json';\r\n\r\n\t\t\t// SECURITY NOTE:\r\n\t\t\t// youtubeLinkIDs list is already run through encodeURIComponent\r\n\t\t\t// so we don't want to double-run that in this request\r\n\t\t\tvar jsonURL = 'http://gdata.youtube.com/feeds/api/videos?q=' + thisIDString + '&v=2&fields=entry(id,title,media:group(yt:duration,yt:videoid,yt:uploaded),yt:statistics)&alt=json';\r\n\t\t\tRESEnvironment.ajax({\r\n\t\t\t\tmethod: 'GET',\r\n\t\t\t\turl: jsonURL,\r\n\t\t\t\tonload: function(response) {\r\n\t\t\t\t\tvar data = safeJSON.parse(response.responseText, null, true);\r\n\t\t\t\t\tif ((typeof data.feed !== 'undefined') && (typeof data.feed.entry !== 'undefined')) {\r\n\t\t\t\t\t\tdata.feed.entry.forEach(function(entry) {\r\n\t\t\t\t\t\t\tvar thisYTID = '\"' + entry['media$group']['yt$videoid']['$t'] + '\"',\r\n\t\t\t\t\t\t\t\tthisTotalSecs = entry['media$group']['yt$duration']['seconds'],\r\n\t\t\t\t\t\t\t\tthisTitle = entry['title']['$t'],\r\n\t\t\t\t\t\t\t\tthisMins = Math.floor(thisTotalSecs / 60),\r\n\t\t\t\t\t\t\t\tthisSecs = (thisTotalSecs % 60),\r\n\t\t\t\t\t\t\t\tthisUploaded, thisViewed, thisTime;\r\n\r\n\t\t\t\t\t\t\tif (thisSecs < 10) {\r\n\t\t\t\t\t\t\t\tthisSecs = '0' + thisSecs;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthisTime = ' - [' + thisMins + ':' + thisSecs + ']';\r\n\t\t\t\t\t\t\tif (module.options.videoUploaded.value) {\r\n\t\t\t\t\t\t\t\tthisUploaded = entry['media$group']['yt$uploaded']['$t'];\r\n\t\t\t\t\t\t\t\tthisUploaded = thisUploaded.match(/[^T]*/);\r\n\t\t\t\t\t\t\t\tthisTime += '[' + thisUploaded + ']';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (module.options.videoViewed.value) {\r\n\t\t\t\t\t\t\t\tthisViewed = entry['yt$statistics']['viewCount'];\r\n\t\t\t\t\t\t\t\tthisTime += '[Views: ' + thisViewed + ']';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tyoutubeLinkRefs.forEach(function(linkRef) {\r\n\t\t\t\t\t\t\t\tif (linkRef[0] === thisYTID) {\r\n\t\t\t\t\t\t\t\t\tlinkRef[1].textContent += ' ' + thisTime;\r\n\t\t\t\t\t\t\t\t\tlinkRef[1].setAttribute('title', 'YouTube title: ' + thisTitle);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t// wait a bit, make another request...\r\n\t\t\t\t\t\tsetTimeout(getVideoJSON, 500);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tfunction pinSubredditBar() {\r\n\t\t// Make the subreddit bar at the top of the page a fixed element\r\n\t\t// The subreddit manager code changes the document's structure\r\n\t\tvar sm = modules['subredditManager'].isEnabled();\r\n\r\n\t\tvar sb = document.getElementById('sr-header-area');\r\n\t\tif (sb === null) {\r\n\t\t\treturn; // reddit is under heavy load\r\n\t\t}\r\n\t\tvar header = document.getElementById('header');\r\n\r\n\t\t// add a dummy <div> inside the header to replace the subreddit bar (for spacing)\r\n\t\tvar spacer = document.createElement('div');\r\n\t\t// null parameter is necessary for FF3.6 compatibility.\r\n\t\tspacer.style.paddingTop = window.getComputedStyle(sb, null).paddingTop;\r\n\t\tspacer.style.paddingBottom = window.getComputedStyle(sb, null).paddingBottom;\r\n\r\n\t\t// HACK: for some reason, if the SM is enabled, the SB gets squeezed horizontally,\r\n\t\t//       and takes up three rows of vertical space (even at low horizontal resolution).\r\n\t\tif (sm) {\r\n\t\t\tspacer.style.height = (parseInt(window.getComputedStyle(sb, null).height, 10) / 3 - 3) + 'px';\r\n\t\t} else {\r\n\t\t\tspacer.style.height = window.getComputedStyle(sb, null).height;\r\n\t\t}\r\n\r\n\t\t//window.setTimeout(function(){\r\n\t\t// add the spacer; take the subreddit bar out of the header and put it above\r\n\t\theader.insertBefore(spacer, sb);\r\n\t\tdocument.body.insertBefore(sb, header);\r\n\r\n\t\t// make it fixed\r\n\t\t// RESUtils.addCSS('div#sr-header-area {position: fixed; z-index: 10000 !important; left: 0; right: 0; box-shadow: 0 2px 2px #AAA;}');\r\n\t\t// something changed on Reddit on 1/31/2012 that made this header-bottom-left margin break subreddit stylesheets... commenting out seems to fix it?\r\n\t\t// and now later on 1/31 they've changed it back and I need to add this line back in...\r\n\t\tRESUtils.addCSS('#header-bottom-left { margin-top: 19px; }');\r\n\t\tRESUtils.addCSS('div#sr-header-area {position: fixed; z-index: 10000 !important; left: 0; right: 0; }');\r\n\t\tpinCommonElements(sm);\r\n\t}\r\n\r\n\tfunction pinUserBar() {\r\n\t\t// Make the user bar at the top of the page a fixed element\r\n\t\tvar userBarElement = document.getElementById('header-bottom-right');\r\n\t\tvar thisHeight = $('#header-bottom-right').height();\r\n\t\tRESUtils.addCSS('#header-bottom-right:hover { opacity: 1 !important;  }');\r\n\t\tRESUtils.addCSS('#header-bottom-right { height: ' + parseInt(thisHeight + 1, 10) + 'px; }');\r\n\t\t// make the account switcher menu fixed\r\n\t\twindow.addEventListener('scroll', RESUtils.debounce.bind(RESUtils, 'scroll.betteReddit', 300, handleScroll, userBarElement), false);\r\n\t\tpinCommonElements();\r\n\t}\r\n\r\n\tfunction handleScroll(userBarElement, e) {\r\n\t\tif (RESUtils.elementInViewport(userBarElement)) {\r\n\t\t\tuserBarElement.setAttribute('style', '');\r\n\t\t\tif (typeof modules['accountSwitcher'].accountMenu !== 'undefined') {\r\n\t\t\t\t$(modules['accountSwitcher'].accountMenu).attr('style', 'position: absolute;');\r\n\t\t\t}\r\n\t\t} else if (module.options.pinHeader.value === 'subanduser') {\r\n\t\t\tif (typeof modules['accountSwitcher'].accountMenu !== 'undefined') {\r\n\t\t\t\t$(modules['accountSwitcher'].accountMenu).attr('style', 'position: fixed;');\r\n\t\t\t}\r\n\t\t\tuserBarElement.setAttribute('style', 'position: fixed; z-index: 10000 !important; top: 19px !important; right: 0; opacity: 0.6; -webkit-transition:opacity 0.3s ease-in; -moz-transition:opacity 0.3s ease-in; -o-transition:opacity 0.3s ease-in; -ms-transition:opacity 0.3s ease-in; -transition:opacity 0.3s ease-in;');\r\n\t\t} else {\r\n\t\t\tif (typeof modules['accountSwitcher'].accountMenu !== 'undefined') {\r\n\t\t\t\t$(modules['accountSwitcher'].accountMenu).attr('style', 'position: fixed;');\r\n\t\t\t}\r\n\t\t\tuserBarElement.setAttribute('style', 'position: fixed; z-index: 10000 !important; top: 0 !important; right: 0; opacity: 0.6; -webkit-transition:opacity 0.3s ease-in; -moz-transition:opacity 0.3s ease-in; -o-transition:opacity 0.3s ease-in; -ms-transition:opacity 0.3s ease-in; -transition:opacity 0.3s ease-in;');\r\n\t\t}\r\n\t}\r\n\r\n\tfunction pinHeader() {\r\n\t\t// Makes the Full header a fixed element\r\n\r\n\t\t// the subreddit manager code changes the document's structure\r\n\t\tvar sm = modules['subredditManager'].isEnabled();\r\n\r\n\t\tvar header = document.getElementById('header');\r\n\t\tif (header === null) {\r\n\t\t\treturn; // reddit is under heavy load\r\n\t\t}\r\n\r\n\t\t// add a dummy <div> to the document for spacing\r\n\t\tvar spacer = document.createElement('div');\r\n\t\tspacer.id = 'RESPinnedHeaderSpacer';\r\n\r\n\t\t// without the next line, the subreddit manager would make the subreddit bar three lines tall and very narrow\r\n\t\tRESUtils.addCSS('#sr-header-area {left: 0; right: 0;}');\r\n\t\tspacer.style.height = $('#header').outerHeight() + 'px';\r\n\r\n\t\t// insert the spacer\r\n\t\tdocument.body.insertBefore(spacer, header.nextSibling);\r\n\r\n\t\t// make the header fixed\r\n\t\tRESUtils.addCSS('#header, #RESAccountSwitcherDropdown {position:fixed;}');\r\n\t\t// RESUtils.addCSS('#header {left: 0; right: 0; box-shadow: 0 2px 2px #AAA;}');\r\n\t\tRESUtils.addCSS('#header {left: 0; right: 0; }');\r\n\t\tvar headerHeight = $('#header').height() + 15;\r\n\t\tRESUtils.addCSS('#RESNotifications { top: ' + headerHeight + 'px } ');\r\n\t\tpinCommonElements(sm);\r\n\r\n\t\t// TODO Needs testing\r\n\t\t// Sometimes this gets executed before the subreddit logo has finished loading. When that\r\n\t\t// happens, the spacer gets created too short, so when the SR logo finally loads, the header\r\n\t\t// grows and overlaps the top of the page, potentially obscuring the first link. This checks\r\n\t\t// to see if the image is finished loading. If it is, then the spacer's height is set. Otherwise,\r\n\t\t// it pauses, then loops.\r\n\t\t// added a check that this element exists, so it doesn't error out RES.\r\n\t\tif (document.getElementById('header-img') && (!document.getElementById('header-img').complete)) {\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tif (document.getElementById('header-img').complete) {\r\n\t\t\t\t\t// null parameter is necessary for FF3.6 compatibility.\r\n\t\t\t\t\tdocument.getElementById('RESPinnedHeaderSpacer').style.height = window.getComputedStyle(document.getElementById('header'), null).height;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetTimeout(arguments.callee, 10);\r\n\t\t\t\t}\r\n\t\t\t}, 10);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction pinCommonElements(sm) {\r\n\t\t// pin the elements common to both pinHeader() and pinSubredditBar()\r\n\t\tif (sm) {\r\n\t\t\t// RES's subreddit menu\r\n\t\t\tRESUtils.addCSS('#RESSubredditGroupDropdown, #srList, #RESShortcutsAddFormContainer, #editShortcutDialog {position: fixed !important;}');\r\n\t\t} else {\r\n\t\t\tRESUtils.addCSS('#sr-more-link: {position: fixed;}');\r\n\t\t}\r\n\t}\r\n\r\n\tfunction restoreSavedTab() {\r\n\t\tvar tabmenu = document.querySelector('#header .tabmenu');\r\n\r\n\t\tif (!tabmenu) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar\tli = document.createElement('li'),\r\n\t\t\ta = document.createElement('a'),\r\n\t\t\tuser = RESUtils.loggedInUser();\r\n\t\ta.textContent = 'saved';\r\n\t\ta.href = '/user/' + user + '/saved/';\r\n\t\tli.appendChild(a);\r\n\t\ttabmenu.appendChild(li);\r\n\t}\r\n\r\n\tfunction applyNoCtrlF(searchIn) {\r\n\t\tvar elems = searchIn.querySelectorAll('ul.flat-list.buttons li a:not(.noCtrlF)');\r\n\t\tRESUtils.forEachChunked(elems, 25, 100, function(e) {\r\n\t\t\te.classList.add('noCtrlF');\r\n\t\t\te.setAttribute('data-text', e.textContent);\r\n\t\t\te.textContent = '';\r\n\t\t});\r\n\t}\r\n});\r\n"],"sourceRoot":"/source/"}
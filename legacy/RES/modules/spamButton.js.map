{"version":3,"sources":["modules/spamButton.js"],"names":[],"mappings":";;AAAA,UAAU,YAAV,EAAwB,UAAS,MAAT,EAAiB,QAAjB,EAA2B;AAClD,QAAO,UAAP,GAAoB,aAApB,CADkD;AAElD,QAAO,QAAP,GAAkB,aAAlB,CAFkD;AAGlD,QAAO,iBAAP,GAA2B,IAA3B,CAHkD;AAIlD,QAAO,WAAP,GAAqB,iDAArB,CAJkD;AAKlD,QAAO,EAAP,GAAY,YAAW;AACtB,MAAI,IAAC,CAAK,SAAL,EAAD,IAAuB,KAAK,UAAL,EAAvB,EAA2C;;;AAG9C,OAAI,QAAQ,WAAW,OAAX,CAAmB,6BAAnB,CAAR,CAH0C;AAI9C,OAAI,CAAC,KAAD,EAAQ;AACX,eAAW,OAAX,CAAmB,6BAAnB,EAAkD,MAAlD,EADW;AAEX,aAAS,OAAT,CAAiB,YAAjB,CAA8B,YAA9B,EAA4C,KAA5C,EAFW;IAAZ;;;;AAJ8C,OAW1C,SAAS,YAAT,OAA4B,SAAS,kBAAT,EAA5B,EAA2D;AAC9D,aAAS,eAAT,CAAyB,WAAzB,EAAsC,cAAtC,EAD8D;AAE9D,aAAS,eAAT,CAAyB,aAAzB,EAAwC,cAAxC,EAF8D;AAG9D,qBAH8D;IAA/D;GAXD;EADW,CALsC;;AAyBlD,UAAS,cAAT,CAAwB,GAAxB,EAA6B;AAC5B,QAAM,OAAO,QAAP,CADsB;AAE5B,MAAI,QAAC,CAAS,QAAT,OAAwB,UAAxB,IAAwC,SAAS,QAAT,OAAwB,UAAxB,IAAwC,SAAS,QAAT,OAAwB,SAAxB,EAAoC;AACxH,OAAI,WAAW,IAAI,gBAAJ,CAAqB,+EAArB,CAAX,CADoH;AAExH,QAAK,IAAI,IAAI,CAAJ,EAAO,MAAM,SAAS,MAAT,EAAiB,IAAI,GAAJ,EAAS,GAAhD,EAAqD;AACpD,QAAI,OAAO,SAAS,aAAT,CAAuB,IAAvB,CAAP;;;AADgD,YAIpD,CAAS,CAAT,EAAY,SAAZ,CAAsB,UAAtB,CAAiC,YAAjC,CAA8C,IAA9C,EAAoD,SAAS,CAAT,EAAY,SAAZ,CAApD;;;AAJoD,QAOhD,IAAI,SAAS,aAAT,CAAuB,GAAvB,CAAJ,CAPgD;AAQpD,MAAE,YAAF,CAAe,OAAf,EAAwB,QAAxB,EARoD;AASpD,MAAE,YAAF,CAAe,OAAf,EAAwB,+BAAxB,EAToD;AAUpD,MAAE,gBAAF,CAAmB,OAAnB,EAA4B,UAA5B,EAAwC,KAAxC,EAVoD;AAWpD,MAAE,YAAF,CAAe,MAAf,EAAuB,GAAvB,EAXoD;AAYpD,MAAE,WAAF,GAAgB,KAAhB,CAZoD;AAapD,MAAE,KAAF,GAAU,MAAV,CAboD;AAcpD,SAAK,WAAL,CAAiB,CAAjB,EAdoD;IAArD;GAFD;EAFD;;AAuBA,UAAS,UAAT,CAAoB,CAApB,EAAuB;AACtB,MAAI,IAAI,EAAE,MAAF,CADc;AAEtB,MAAI,yBAAyB,EAAE,UAAF,CAAa,UAAb,CAAwB,UAAxB,CAFP;AAGtB,MAAI,oBAAoB,uBAAuB,aAAvB,CAAqC,SAArC,CAApB,CAHkB;AAItB,MAAI,OAAO,kBAAkB,IAAlB,CAJW;AAKtB,MAAI,aAAa,kBAAkB,WAAlB,CALK;AAMtB,IAAE,YAAF,CAAe,MAAf,EAAuB,wBAAwB,IAAxB,GAA+B,sBAA/B,GAAwD,UAAxD,CAAvB,CANsB;AAOtB,IAAE,YAAF,CAAe,QAAf,EAAyB,QAAzB,EAPsB;EAAvB;CAhDuB,CAAxB","file":"modules/spamButton.js","sourcesContent":["addModule('spamButton', function(module, moduleID) {\r\n\tmodule.moduleName = 'Spam Button';\r\n\tmodule.category = 'Submissions';\r\n\tmodule.disabledByDefault = true;\r\n\tmodule.description = 'Adds a Spam button to posts for easy reporting.';\r\n\tmodule.go = function() {\r\n\t\tif ((this.isEnabled()) && (this.isMatchURL())) {\r\n\t\t\t// check if the spam button was on by default from an old install of RES.  Per Reddit Admin request, this is being\r\n\t\t\t// disabled by default due to excess misuse, but people who want to purposefully re-enable it may do so.\r\n\t\t\tvar reset = RESStorage.getItem('RESmodules.spamButton.reset');\r\n\t\t\tif (!reset) {\r\n\t\t\t\tRESStorage.setItem('RESmodules.spamButton.reset', 'true');\r\n\t\t\t\tRESUtils.options.enableModule('spamButton', false);\r\n\t\t\t}\r\n\r\n\t\t\t// credit to tico24 for the idea, here: http://userscripts.org/scripts/review/84454\r\n\t\t\t// code adapted for efficiency...\r\n\t\t\tif (RESUtils.loggedInUser() !== RESUtils.currentUserProfile()) {\r\n\t\t\t\tRESUtils.watchForElement('siteTable', addSpamButtons);\r\n\t\t\t\tRESUtils.watchForElement('newComments', addSpamButtons);\r\n\t\t\t\taddSpamButtons();\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tfunction addSpamButtons(ele) {\r\n\t\tele = ele || document;\r\n\t\tif ((RESUtils.pageType() === 'linklist') || (RESUtils.pageType() === 'comments') || (RESUtils.pageType() === 'profile')) {\r\n\t\t\tvar allLists = ele.querySelectorAll('.thing:not(.deleted):not(.morerecursion):not(.morechildren) > .entry .buttons');\r\n\t\t\tfor (var i = 0, len = allLists.length; i < len; i++) {\r\n\t\t\t\tvar spam = document.createElement('li');\r\n\t\t\t\t// insert spam button second to last in the list... this is a bit hacky and assumes singleClick is enabled...\r\n\t\t\t\t// it should probably be made smarter later, but there are so many variations of configs, etc, that it's a bit tricky.\r\n\t\t\t\tallLists[i].lastChild.parentNode.insertBefore(spam, allLists[i].lastChild);\r\n\r\n\t\t\t\t// it's faster to figure out the author only if someone actually clicks the link, so we're modifying the code to listen for clicks and not do all that queryselector stuff.\r\n\t\t\t\tvar a = document.createElement('a');\r\n\t\t\t\ta.setAttribute('class', 'option');\r\n\t\t\t\ta.setAttribute('title', 'Report this user as a spammer');\r\n\t\t\t\ta.addEventListener('click', reportPost, false);\r\n\t\t\t\ta.setAttribute('href', '#');\r\n\t\t\t\ta.textContent = 'rts';\r\n\t\t\t\ta.title = 'spam';\r\n\t\t\t\tspam.appendChild(a);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction reportPost(e) {\r\n\t\tvar a = e.target;\r\n\t\tvar authorProfileContainer = a.parentNode.parentNode.parentNode;\r\n\t\tvar authorProfileLink = authorProfileContainer.querySelector('.author');\r\n\t\tvar href = authorProfileLink.href;\r\n\t\tvar authorName = authorProfileLink.textContent;\r\n\t\ta.setAttribute('href', '/r/spam/submit?url=' + href + '&title=overview for ' + authorName);\r\n\t\ta.setAttribute('target', '_blank');\r\n\t}\r\n});\r\n"],"sourceRoot":"/source/"}
{"version":3,"sources":["modules/menu.js"],"names":[],"mappings":"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","file":"modules/menu.js","sourcesContent":["addModule('RESMenu', function(module, moduleID) {\r\n\tmodule.moduleName = 'RES Menu';\r\n\tmodule.category = ['Core'];\r\n\tmodule.description = 'The <span class=\"gearIcon\"></span> dropdown menu to manage RES settings and quick options';\r\n\tmodule.alwaysEnabled = true;\r\n\tmodule.hidden = true;\r\n\r\n\tmodule.beforeLoad = function() {\r\n\t\trenderConsoleLink();\r\n\t};\r\n\r\n\tmodule.go = function() {\r\n\t\taddConsoleLink();\r\n\t};\r\n\r\n\r\n\tmodule.afterLoad = function() {\r\n\t\taddLegacyStyling();\r\n\t};\r\n\r\n\tvar menuItems = $();\r\n\r\n\tfunction renderConsoleLink() {\r\n\t\tvar RESPrefsLink = $('<span id=\"openRESPrefs\"><span id=\"RESSettingsButton\" title=\"RES Settings\" class=\"gearIcon\"></span>')\r\n\t\t\t.mouseenter(module.showPrefsDropdown.bind(module));\r\n\t\tmodule.RESPrefsLink = RESPrefsLink[0];\r\n\t}\r\n\r\n\tfunction addConsoleLink() {\r\n\t\tmodule.userMenu = document.querySelector('#header-bottom-right');\r\n\t\t$(module.userMenu).find('ul').after(module.RESPrefsLink).after('<span class=\"separator\">|</span>');\r\n\t}\r\n\r\n\tmodule.showPrefsDropdown = function() {\r\n\t\tmodules['hover'].dropdownList(moduleID, modules['hover'].HIDDEN_FROM_SETTINGS)\r\n\t\t\t.options({\r\n\t\t\t\topenDelay: 200,\r\n\t\t\t\tfadeDelay: 200,\r\n\t\t\t\tfadeSpeed: 0.2\r\n\t\t\t})\r\n\t\t\t.populateWith(populateDropdown)\r\n\t\t\t.target(module.RESPrefsLink.querySelector('#RESSettingsButton')) // workaround subreddit stylings where the container ends up super tall\r\n\t\t\t.begin();\r\n\t};\r\n\tmodule.hidePrefsDropdown = function() {\r\n\t\tmodules['hover'].dropdownList(moduleID).close(true);\r\n\t};\r\n\r\n\tfunction populateDropdown(def, base, context) {\r\n\t\tdef.resolve(menuItems);\r\n\t}\r\n\r\n\tmodule.addMenuItem = function(ele, onClick, prepend) {\r\n\t\tvar menuItem = $(ele);\r\n\t\tif (!menuItem.is('li')) {\r\n\t\t\tmenuItem = $('<li />').append(ele);\r\n\t\t}\r\n\t\tmenuItem[0].addEventListener('click', onClick);\r\n\r\n\t\tif (prepend) {\r\n\t\t\tmenuItems = menuItem.add(menuItems);\r\n\t\t} else {\r\n\t\t\tmenuItems = menuItems.add(menuItem);\r\n\t\t}\r\n\t};\r\n\r\n\tfunction getMenuButton() {\r\n\t\treturn $(module.RESPrefsLink).find('.gearIcon');\r\n\t}\r\n\r\n\tmodule.setNewNotification = function(callback, isImportant) {\r\n\t\tvar gearIcon = getMenuButton();\r\n\t\tgearIcon.addClass('newNotification');\r\n\t\tmodule.onClickMenuButton(callback, isImportant);\r\n\t\tif (isImportant) {\r\n\t\t\tgearIcon.addClass('important');\r\n\t\t}\r\n\t};\r\n\r\n\tvar onClickMenuButton;\r\n\tmodule.onClickMenuButton = function(callback, isImportant) {\r\n\t\tvar menuButton = getMenuButton();\r\n\t\tif (!onClickMenuButton || (isImportant && !onClickMenuButton.isImportant)) {\r\n\t\t\tonClickMenuButton = $.Callbacks();\r\n\t\t\tonClickMenuButton.add(module.hidePrefsDropdown.bind(module));\r\n\r\n\t\t\tif (isImportant) {\r\n\t\t\t\tonClickMenuButton.isImportant = isImportant;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (isImportant || !onClickMenuButton.isImportant) {\r\n\t\t\tonClickMenuButton.add(callback);\r\n\t\t}\r\n\r\n\t\tmenuButton.on('click', onClickMenuButton.fire);\r\n\t};\r\n\r\n\tfunction addLegacyStyling() {\r\n\t\tvar gearIcon = module.RESPrefsLink.querySelector('.gearIcon'),\r\n\t\t\tbackgroundImage = window.getComputedStyle(gearIcon).backgroundImage;\r\n\t\tif (modules['styleTweaks'].isSubredditStyleEnabled() && backgroundImage && backgroundImage !== 'none') {\r\n\t\t\tgearIcon.classList.add('res-gearIcon-legacy');\r\n\t\t}\r\n\t}\r\n});\r\n"],"sourceRoot":"/source/"}
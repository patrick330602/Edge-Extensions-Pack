{"version":3,"sources":["modules/hosts/minus.js"],"names":[],"mappings":";;AAAA,WAAW,YAAX,EAAyB,OAAzB,EAAkC;AACjC,OAAM,QAAN;AACA,UAAS,CAAC,QAAD,CAAT;AACA,SAAQ,gBAAS,IAAT,EAAe,IAAf,EAAqB;AAC5B,SAAO,KAAK,OAAL,CAAa,QAAb,MAA2B,CAAC,CAAD,IAAM,KAAK,OAAL,CAAa,OAAb,MAA0B,CAAC,CAAD,CADtC;EAArB;AAGR,aAAY,oBAAS,IAAT,EAAe;AAC1B,MAAI,MAAM,EAAE,QAAF,EAAN;MACH,QAAQ,uBAAR;MACA,SAAS,yCAAT;MACA,OAAO,KAAK,IAAL,CAAU,KAAV,CAAgB,GAAhB,EAAqB,CAArB,CAAP;;;AAEA,WAAS,KAAK,KAAL,CAAW,GAAX,CAAT;MACA,MAAO,OAAO,MAAP,GAAgB,CAAhB,GAAoB,OAAO,OAAO,MAAP,GAAgB,CAAhB,CAAP,CAA0B,WAA1B,EAApB,GAA8D,EAA9D,CAPkB;AAQ1B,MAAI,MAAM,IAAN,CAAW,GAAX,CAAJ,EAAqB;AACpB,OAAI,SAAS,OAAO,IAAP,CAAY,IAAZ,CAAT,CADgB;AAEpB,OAAI,UAAU,CAAC,OAAO,CAAP,CAAD,EAAY;AACzB,QAAI,OAAO,OAAO,CAAP,CAAP,CADqB;AAEzB,QAAI,KAAK,MAAL,CAAY,CAAZ,EAAe,CAAf,MAAsB,GAAtB,EAA2B;AAC9B,SAAI,SAAS,gCAAgC,mBAAmB,IAAnB,CAAhC,CADiB;AAE9B,oBAAe,IAAf,CAAoB;AACnB,cAAQ,KAAR;AACA,WAAK,MAAL;AACA,cAAQ,gBAAS,QAAT,EAAmB;AAC1B,WAAI;AACH,YAAI,OAAO,KAAK,KAAL,CAAW,SAAS,YAAT,CAAlB,CADD;AAEH,YAAI,OAAJ,CAAY,IAAZ,EAAkB,IAAlB,EAFG;QAAJ,CAGE,OAAO,CAAP,EAAU;AACX,YAAI,MAAJ,GADW;QAAV;OAJK;AAQR,eAAS,iBAAS,QAAT,EAAmB;AAC3B,WAAI,MAAJ,GAD2B;OAAnB;MAXV,EAF8B;KAA/B,MAiBO;;AACN,SAAI,MAAJ,GADM;KAjBP;IAFD,MAsBO;AACN,QAAI,MAAJ,GADM;IAtBP;GAFD,MA2BO;AACN,OAAI,MAAJ,GADM;GA3BP;AA8BA,SAAO,IAAI,OAAJ,EAAP,CAtC0B;EAAf;AAwCZ,aAAY,oBAAS,IAAT,EAAe,IAAf,EAAqB;AAChC,MAAI,MAAM,EAAE,QAAF,EAAN;;;AAD4B,MAI5B,mBAAmB,IAAnB,EAAyB;AAC5B,OAAI,KAAK,aAAL,CAAmB,MAAnB,GAA4B,CAA5B,EAA+B;AAClC,SAAK,IAAL,GAAY,SAAZ,CADkC;AAElC,SAAK,GAAL,GAAW;AACV,UAAK,KAAK,aAAL;KADN,CAFkC;IAAnC,MAKO;AACN,SAAK,IAAL,GAAY,OAAZ,CADM;AAEN,QAAI,SAAS,QAAT,OAAwB,UAAxB,EAAoC;AACvC,OAAE,IAAF,EAAQ,OAAR,CAAgB,QAAhB,EAA0B,IAA1B,CAA+B,YAA/B,EAA6C,IAA7C,CAAkD,MAAlD,EAA0D,KAAK,IAAL,CAA1D,CADuC;KAAxC;AAGA,SAAK,GAAL,GAAW,KAAK,aAAL,CAAmB,CAAnB,CAAX,CALM;IALP;AAYA,OAAI,OAAJ,CAAY,IAAZ,EAb4B;GAA7B,MAcO;AACN,OAAI,MAAJ,GADM;GAdP;AAiBA,SAAO,IAAI,OAAJ,EAAP,CArBgC;EAArB;CA9Cb","file":"modules/hosts/minus.js","sourcesContent":["addLibrary('mediaHosts', 'minus', {\r\n\tname: 'min.us',\r\n\tdomains: ['min.us'],\r\n\tdetect: function(href, elem) {\r\n\t\treturn href.indexOf('min.us') !== -1 && href.indexOf('blog.') === -1;\r\n\t},\r\n\thandleLink: function(elem) {\r\n\t\tvar def = $.Deferred(),\r\n\t\t\timgRe = /\\.(jpg|jpeg|gif|png)/i,\r\n\t\t\thashRe = /^http:\\/\\/min\\.us\\/([\\w]+)(?:#[\\d+])?$/i,\r\n\t\t\thref = elem.href.split('?')[0],\r\n\t\t\t//TODO: just make default run first and remove this\r\n\t\t\tgetExt = href.split('.'),\r\n\t\t\text = (getExt.length > 1 ? getExt[getExt.length - 1].toLowerCase() : '');\r\n\t\tif (imgRe.test(ext)) {\r\n\t\t\tvar groups = hashRe.exec(href);\r\n\t\t\tif (groups && !groups[2]) {\r\n\t\t\t\tvar hash = groups[1];\r\n\t\t\t\tif (hash.substr(0, 1) === 'm') {\r\n\t\t\t\t\tvar apiURL = 'http://min.us/api/GetItems/' + encodeURIComponent(hash);\r\n\t\t\t\t\tRESEnvironment.ajax({\r\n\t\t\t\t\t\tmethod: 'GET',\r\n\t\t\t\t\t\turl: apiURL,\r\n\t\t\t\t\t\tonload: function(response) {\r\n\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\tvar json = JSON.parse(response.responseText);\r\n\t\t\t\t\t\t\t\tdef.resolve(elem, json);\r\n\t\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t\tdef.reject();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tonerror: function(response) {\r\n\t\t\t\t\t\t\tdef.reject();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} else { // if not 'm', not a gallery, we can't do anything with the API.\r\n\t\t\t\t\tdef.reject();\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tdef.reject();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tdef.reject();\r\n\t\t}\r\n\t\treturn def.promise();\r\n\t},\r\n\thandleInfo: function(elem, info) {\r\n\t\tvar def = $.Deferred();\r\n\t\t//TODO: Handle titles\r\n\t\t//TODO: Handle possibility of flash items\r\n\t\tif ('ITEMS_GALLERY' in info) {\r\n\t\t\tif (info.ITEMS_GALLERY.length > 1) {\r\n\t\t\t\telem.type = 'GALLERY';\r\n\t\t\t\telem.src = {\r\n\t\t\t\t\tsrc: info.ITEMS_GALLERY\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\telem.type = 'IMAGE';\r\n\t\t\t\tif (RESUtils.pageType() === 'linklist') {\r\n\t\t\t\t\t$(elem).closest('.thing').find('.thumbnail').attr('href', elem.href);\r\n\t\t\t\t}\r\n\t\t\t\telem.src = info.ITEMS_GALLERY[0];\r\n\t\t\t}\r\n\t\t\tdef.resolve(elem);\r\n\t\t} else {\r\n\t\t\tdef.reject();\r\n\t\t}\r\n\t\treturn def.promise();\r\n\t}\r\n});\r\n"],"sourceRoot":"/source/"}
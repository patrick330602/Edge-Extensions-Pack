{"version":3,"sources":["modules/hosts/github.js"],"names":[],"mappings":";;AAAA,WAAW,YAAX,EAAyB,QAAzB,EAAmC;AAClC,UAAS,CAAC,iBAAD,CAAT;AACA,OAAM,cAAN;AACA,SAAQ,gBAAS,IAAT,EAAe,IAAf,EAAqB;AAC5B,SAAO,KAAK,OAAL,CAAa,kBAAb,MAAqC,CAAC,CAAD,CADhB;EAArB;AAGR,aAAY,oBAAS,IAAT,EAAe;AAC1B,MAAI,MAAM,EAAE,QAAF,EAAN;MACH,SAAS,mEAAqE,IAArE,CAA0E,KAAK,IAAL,CAAnF,CAFyB;AAG1B,MAAI,MAAJ,EAAY;AACX,kBAAe,IAAf,CAAoB;AACnB,YAAQ,KAAR;AACA,SAAK,kCAAkC,OAAO,CAAP,CAAlC;AACL,qBAAiB,IAAjB;AACA,YAAQ,gBAAS,QAAT,EAAmB;AAC1B,SAAI,SAAS,MAAT,KAAoB,GAApB,EAAyB;AAC5B,UAAI;AACH,WAAI,OAAO,KAAK,KAAL,CAAW,SAAS,YAAT,CAAlB,CADD;AAEH,WAAI,OAAJ,CAAY,IAAZ,EAAkB,IAAlB,EAFG;OAAJ,CAGE,OAAO,KAAP,EAAc;AACf,WAAI,MAAJ,GADe;OAAd;MAJH,MAOO;AACN,UAAI,SAAS,MAAT,KAAoB,GAApB,IAA2B,SAAS,YAAT,CAAsB,OAAtB,CAA8B,YAA9B,MAAgD,CAAC,CAAD,EAAI;AAClF,eAAQ,KAAR,CAAc,0BAAd,EADkF;OAAnF;AAGA,UAAI,MAAJ,GAJM;MAPP;KADO;AAeR,aAAS,iBAAS,KAAT,EAAgB;AACxB,SAAI,MAAJ,GADwB;KAAhB;IAnBV,EADW;GAAZ,MAwBO;AACN,OAAI,MAAJ,GADM;GAxBP;AA2BA,SAAO,IAAI,OAAJ,EAAP,CA9B0B;EAAf;AAgCZ,aAAY,oBAAS,IAAT,EAAe,IAAf,EAAqB;AAChC,MAAI,MAAM,EAAE,QAAF,EAAN,CAD4B;AAEhC,OAAK,IAAL,GAAY,MAAZ,CAFgC;AAGhC,OAAK,UAAL,GAAkB,KAAK,WAAL,CAHc;AAIhC,OAAK,GAAL,GAAW,EAAX,CAJgC;AAKhC,OAAK,IAAI,QAAJ,IAAgB,KAAK,KAAL,EAAY;AAChC,OAAI,OAAO,KAAK,KAAL,CAAW,QAAX,CAAP,CAD4B;AAEhC,QAAK,GAAL,IAAY,SAAS,QAAT,GAAoB,QAApB,CAFoB;AAGhC,OAAI,KAAK,QAAL,KAAkB,UAAlB,EAA8B;AACjC,SAAK,GAAL,IAAY,OAAO,OAAP,CAAe,SAAf,GAA2B,MAA3B,CAAkC,KAAK,OAAL,CAA9C,CADiC;IAAlC,MAEO;AACN,SAAK,GAAL,IAAY,gBAAgB,WAAW,KAAK,OAAL,CAA3B,GAA2C,eAA3C,CADN;IAFP;AAKA,OAAI,KAAK,SAAL,EAAgB;AACnB,SAAK,GAAL,IAAY,+BAAZ,CADmB;IAApB;GARD;AAYA,MAAI,OAAJ,CAAY,IAAZ,EAjBgC;AAkBhC,SAAO,IAAI,OAAJ,EAAP,CAlBgC;EAArB;CAtCb","file":"modules/hosts/github.js","sourcesContent":["addLibrary('mediaHosts', 'github', {\r\n\tdomains: ['gist.github.com'],\r\n\tname: 'github gists',\r\n\tdetect: function(href, elem) {\r\n\t\treturn href.indexOf('gist.github.com/') !== -1;\r\n\t},\r\n\thandleLink: function(elem) {\r\n\t\tvar def = $.Deferred(),\r\n\t\t\tgroups = (/^https?:\\/\\/gist\\.github\\.com\\/(?:[\\w-]+\\/)?([a-z0-9]{20,}|\\d+)/i).exec(elem.href);\r\n\t\tif (groups) {\r\n\t\t\tRESEnvironment.ajax({\r\n\t\t\t\tmethod: 'GET',\r\n\t\t\t\turl: 'https://api.github.com/gists/' + groups[1],\r\n\t\t\t\taggressiveCache: true,\r\n\t\t\t\tonload: function(response) {\r\n\t\t\t\t\tif (response.status === 200) {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tvar json = JSON.parse(response.responseText);\r\n\t\t\t\t\t\t\tdef.resolve(elem, json);\r\n\t\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\t\tdef.reject();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (response.status === 403 && response.responseText.indexOf('rate limit') !== -1) {\r\n\t\t\t\t\t\t\tconsole.error('GitHub API limit reached');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdef.reject();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tonerror: function(error) {\r\n\t\t\t\t\tdef.reject();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tdef.reject();\r\n\t\t}\r\n\t\treturn def.promise();\r\n\t},\r\n\thandleInfo: function(elem, info) {\r\n\t\tvar def = $.Deferred();\r\n\t\telem.type = 'TEXT';\r\n\t\telem.imageTitle = info.description;\r\n\t\telem.src = '';\r\n\t\tfor (var filename in info.files) {\r\n\t\t\tvar file = info.files[filename];\r\n\t\t\telem.src += '<h5>' + filename + ':</h5>';\r\n\t\t\tif (file.language === 'Markdown') {\r\n\t\t\t\telem.src += window.SnuOwnd.getParser().render(file.content);\r\n\t\t\t} else {\r\n\t\t\t\telem.src += '<pre><code>' + escapeHTML(file.content) + '</code></pre>';\r\n\t\t\t}\r\n\t\t\tif (file.truncated) {\r\n\t\t\t\telem.src += '<p>&lt;file truncated&gt;</p>';\r\n\t\t\t}\r\n\t\t}\r\n\t\tdef.resolve(elem);\r\n\t\treturn def.promise();\r\n\t}\r\n});\r\n"],"sourceRoot":"/source/"}
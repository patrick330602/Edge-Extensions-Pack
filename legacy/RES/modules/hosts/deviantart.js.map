{"version":3,"sources":["modules/hosts/deviantart.js"],"names":[],"mappings":";;AAAA,WAAW,YAAX,EAAyB,YAAzB,EAAuC;AACtC,OAAM,YAAN;AACA,UAAS,CAAC,gBAAD,EAAmB,QAAnB,CAAT;AACA,UAAS,+EAAT;AACA,SAAQ,gBAAS,IAAT,EAAe,IAAf,EAAqB;AAC5B,SAAO,QAAQ,YAAR,EAAsB,WAAtB,CAAkC,YAAlC,EAAgD,OAAhD,CAAwD,IAAxD,CAA6D,KAAK,IAAL,CAApE,CAD4B;EAArB;AAGR,aAAY,oBAAS,IAAT,EAAe;AAC1B,MAAI,MAAM,EAAE,QAAF,EAAN,CADsB;AAE1B,MAAI,SAAS,8CAA8C,mBAAmB,KAAK,IAAL,CAAjE,CAFa;AAG1B,iBAAe,IAAf,CAAoB;AACnB,WAAQ,KAAR;AACA,QAAK,MAAL;;AAEA,WAAQ,gBAAS,QAAT,EAAmB;AAC1B,QAAI;AACH,SAAI,OAAO,KAAK,KAAL,CAAW,SAAS,YAAT,CAAlB,CADD;AAEH,SAAI,OAAJ,CAAY,IAAZ,EAAkB,IAAlB,EAFG;KAAJ,CAGE,OAAO,KAAP,EAAc;AACf,SAAI,MAAJ,GADe;KAAd;IAJK;AAQR,YAAS,iBAAS,QAAT,EAAmB;AAC3B,QAAI,MAAJ,GAD2B;IAAnB;GAZV,EAH0B;AAmB1B,SAAO,IAAI,OAAJ,EAAP,CAnB0B;EAAf;AAqBZ,aAAY,oBAAS,IAAT,EAAe,IAAf,EAAqB;AAChC,MAAI,MAAM,EAAE,QAAF,EAAN;MACH,QAAQ,uBAAR,CAF+B;AAGhC,UAAQ,KAAK,IAAL;AACP,QAAK,OAAL;AACC,SAAK,UAAL,GAAkB,KAAK,KAAL,CADnB;AAEC,QAAI,MAAM,IAAN,CAAW,KAAK,GAAL,CAAf,EAA0B;AACzB,UAAK,GAAL,GAAW,KAAK,GAAL,CADc;KAA1B,MAEO;AACN,UAAK,GAAL,GAAW,KAAK,aAAL,CADL;KAFP;AAKA,QAAI,SAAS,QAAT,OAAwB,UAAxB,EAAoC;AACvC,OAAE,IAAF,EAAQ,OAAR,CAAgB,QAAhB,EAA0B,IAA1B,CAA+B,YAA/B,EAA6C,IAA7C,CAAkD,MAAlD,EAA0D,KAAK,IAAL,CAA1D,CADuC;KAAxC;;AAPD,QAWC,CAAK,OAAL,GAAe,sBAAsB,KAAK,UAAL,GAAkB,IAAxC,GAA+C,KAAK,WAAL,GAAmB,mBAAlE,CAXhB;AAYC,SAAK,IAAL,GAAY,OAAZ,CAZD;AAaC,QAAI,OAAJ,CAAY,IAAZ,EAbD;AAcC,UAdD;AADD,QAgBM,MAAL;AACC,SAAK,IAAL,GAAY,MAAZ,CADD;AAEC,SAAK,UAAL,GAAkB,KAAK,KAAL,CAFnB;AAGC,SAAK,GAAL,GAAW,KAAK,IAAL,IAAa,cAAgB,IAAhB,CAAqB,KAAK,IAAL,CAArB,GAAkC,KAAlC,GAA0C,EAA1C,CAAb,CAHZ;AAIC,SAAK,OAAL,GAAe,cAAc,KAAK,IAAL,GAAY,gEAA1B,GAA6F,KAAK,UAAL,GAAkB,IAA/G,GAAsH,KAAK,WAAL,GAAmB,mBAAzI,CAJhB;AAKC,QAAI,OAAJ,CAAY,IAAZ,EALD;AAMC,UAND;AAhBD;AAwBE,QAAI,MAAJ,GADD;AAvBD,GAHgC;AA6BhC,SAAO,IAAI,OAAJ,EAAP,CA7BgC;EAArB;CA5Bb","file":"modules/hosts/deviantart.js","sourcesContent":["addLibrary('mediaHosts', 'deviantart', {\r\n\tname: 'deviantART',\r\n\tdomains: ['deviantart.com', 'fav.me'],\r\n\tmatchRe: /^http:\\/\\/(?:fav\\.me\\/.*|(?:.+\\.)?deviantart\\.com\\/(?:art\\/.*|[^#]*#\\/d.*))$/i,\r\n\tdetect: function(href, elem) {\r\n\t\treturn modules['showImages'].siteModules['deviantart'].matchRe.test(elem.href);\r\n\t},\r\n\thandleLink: function(elem) {\r\n\t\tvar def = $.Deferred();\r\n\t\tvar apiURL = 'http://backend.deviantart.com/oembed?url=' + encodeURIComponent(elem.href);\r\n\t\tRESEnvironment.ajax({\r\n\t\t\tmethod: 'GET',\r\n\t\t\turl: apiURL,\r\n\t\t\t// aggressiveCache: true,\r\n\t\t\tonload: function(response) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tvar json = JSON.parse(response.responseText);\r\n\t\t\t\t\tdef.resolve(elem, json);\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tdef.reject();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tonerror: function(response) {\r\n\t\t\t\tdef.reject();\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn def.promise();\r\n\t},\r\n\thandleInfo: function(elem, info) {\r\n\t\tvar def = $.Deferred(),\r\n\t\t\timgRe = /\\.(jpg|jpeg|gif|png)/i;\r\n\t\tswitch (info.type) {\r\n\t\t\tcase 'photo':\r\n\t\t\t\telem.imageTitle = info.title;\r\n\t\t\t\tif (imgRe.test(info.url)) {\r\n\t\t\t\t\telem.src = info.url;\r\n\t\t\t\t} else {\r\n\t\t\t\t\telem.src = info.thumbnail_url;\r\n\t\t\t\t}\r\n\t\t\t\tif (RESUtils.pageType() === 'linklist') {\r\n\t\t\t\t\t$(elem).closest('.thing').find('.thumbnail').attr('href', elem.href);\r\n\t\t\t\t}\r\n\t\t\t\t// elem.credits = 'Original link: <a href=\"'+original_url+'\">'+original_url+'</a><br>Art by: <a href=\"'+info.author_url+'\">'+info.author_name+'</a> @ deviantART';\r\n\t\t\t\telem.credits = 'Art by: <a href=\"' + info.author_url + '\">' + info.author_name + '</a> @ deviantART';\r\n\t\t\t\telem.type = 'IMAGE';\r\n\t\t\t\tdef.resolve(elem);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'rich':\r\n\t\t\t\telem.type = 'TEXT';\r\n\t\t\t\telem.imageTitle = info.title;\r\n\t\t\t\telem.src = info.html + ((/[^\\s\\.]\\s*$/).test(info.html) ? '...' : '');\r\n\t\t\t\telem.credits = '<a href=\"' + elem.href + '\">Click here to read the full text</a> - Written By: <a href=\"' + info.author_url + '\">' + info.author_name + '</a> @ deviantART';\r\n\t\t\t\tdef.resolve(elem);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tdef.reject();\r\n\t\t}\r\n\t\treturn def.promise();\r\n\t}\r\n});\r\n"],"sourceRoot":"/source/"}
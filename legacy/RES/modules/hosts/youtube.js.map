{"version":3,"sources":["modules/hosts/youtube.js"],"names":[],"mappings":";;AAAA,WAAW,YAAX,EAAyB,SAAzB,EAAoC;AACnC,OAAM,SAAN;AACA,UAAS,CAAC,aAAD,EAAgB,UAAhB,CAAT;AACA,SAAQ,gBAAS,IAAT,EAAe,IAAf,EAAqB;;AAE5B,SAAO,EAAE,IAAF,EAAQ,OAAR,CAAgB,QAAhB,EAA0B,IAA1B,CAA+B,wCAA/B,EAAyE,MAAzE,KAAoF,CAApF,CAFqB;EAArB;AAIR,aAAY,oBAAS,IAAT,EAAe;AAC1B,MAAI,MAAM,EAAE,QAAF,EAAN,CADsB;;AAG1B,MAAI,SAAS,kEAAT,CAHsB;AAI1B,MAAI,YAAY,6CAAZ,CAJsB;;AAM1B,MAAI,SAAS,OAAO,IAAP,CAAY,KAAK,IAAL,CAArB,CANsB;AAO1B,MAAI,CAAC,MAAD,EAAS,SAAS,UAAU,IAAV,CAAe,KAAK,IAAL,CAAxB,CAAb;;AAEA,MAAI,MAAJ,EAAY;;;AAGX,OAAI,aAAa,iBAAb,CAHO;AAIX,OAAI,YAAY,CAAZ;OAAe,iBAAiB,WAAW,IAAX,CAAgB,KAAK,IAAL,CAAjC,CAJR;;AAMX,OAAI,mBAAmB,IAAnB,EAAyB;AAC5B,QAAI,cAAc,EAAC,KAAI,IAAJ,EAAU,KAAI,EAAJ,EAAQ,KAAI,CAAJ,EAAjC;QACH,SAAS,eAAT;;;AAF2B,QAKxB,YAAY,eAAe,CAAf,EAAkB,KAAlB,CAAwB,MAAxB,CAAZ,CALwB;AAM5B,QAAI,SAAJ,EAAe;AACd,eAAU,OAAV,CAAkB,UAAS,EAAT,EAAY;AAC7B,UAAI,OAAO,YAAY,GAAG,MAAH,CAAU,GAAG,MAAH,GAAU,CAAV,CAAtB,CAAP,CADyB;AAE7B,UAAI,SAAS,SAAS,GAAG,KAAH,CAAS,CAAT,EAAY,CAAC,CAAD,CAArB,EAA0B,EAA1B,CAAT;;AAFyB,eAI7B,IAAa,OAAO,MAAP,CAJgB;MAAZ,CAAlB,CADc;KAAf,MAOO;;AAEN,iBAAY,SAAS,eAAe,CAAf,EAAkB,OAAlB,CAA0B,IAA1B,EAAgC,EAAhC,CAAT,EAA8C,EAA9C,CAAZ,CAFM;AAGN,SAAI,MAAM,SAAN,CAAJ,EAAsB,YAAY,CAAZ,CAAtB;KAVD;IAND;AAmBA,OAAI,OAAJ,CAAY,IAAZ,EAAkB,6BAA6B,OAAO,CAAP,CAA7B,GAAyC,uCAAzC,GAAmF,SAAnF,CAAlB,CAzBW;GAAZ,MA0BO;AACN,OAAI,MAAJ,GADM;GA1BP;;AA8BA,SAAO,IAAI,OAAJ,EAAP,CAvC0B;EAAf;AAyCZ,aAAY,oBAAS,IAAT,EAAe,IAAf,EAAqB;;AAEhC,MAAI,QAAQ,YAAR,EAAsB,OAAtB,CAA8B,aAA9B,CAA4C,KAA5C,EAAmD;;AAEtD,OAAI,EAAE,IAAF,EAAQ,OAAR,CAAgB,KAAhB,EAAuB,IAAvB,CAA4B,uBAA5B,EAAqD,MAArD,KAAgE,CAAhE,EAAmE,QAAQ,aAAR,CAAvE;GAFD;;AAKA,OAAK,IAAL,GAAY,QAAZ,CAPgC;AAQhC,OAAK,YAAL,CAAkB,YAAlB,EAAgC,IAAhC,EARgC;AAShC,OAAK,YAAL,CAAkB,YAAlB,EAAgC,mDAAhC,EATgC;AAUhC,OAAK,YAAL,CAAkB,WAAlB,EAA+B,kDAA/B,EAVgC;;AAYhC,SAAO,EAAE,QAAF,GAAa,OAAb,CAAqB,IAArB,EAA2B,OAA3B,EAAP,CAZgC;EAArB;CAhDb","file":"modules/hosts/youtube.js","sourcesContent":["addLibrary('mediaHosts', 'youtube', {\r\n\tname: 'youtube',\r\n\tdomains: ['youtube.com', 'youtu.be'],\r\n\tdetect: function(href, elem) {\r\n\t\t// Ignore links with expandos\r\n\t\treturn $(elem).closest('.entry').find('.expando-button.video:not(.commentImg)').length === 0;\r\n\t},\r\n\thandleLink: function(elem) {\r\n\t\tvar def = $.Deferred();\r\n\r\n\t\tvar hashRe = /^https?:\\/\\/(?:www\\.|m\\.)?youtube\\.com\\/watch.*?[?&]v=([\\w\\-]+)/i;\r\n\t\tvar altHashRe = /^https?:\\/\\/(?:www\\.)?youtu\\.be\\/([\\w\\-]+)/i;\r\n\r\n\t\tvar groups = hashRe.exec(elem.href);\r\n\t\tif (!groups) groups = altHashRe.exec(elem.href);\r\n\r\n\t\tif (groups) {\r\n\r\n\t\t\t// Check url for timecode e.g t=1h23m15s\r\n\t\t\tvar timecodeRe = /t=(.*?)(?:$|&)/i;\r\n\t\t\tvar starttime = 0, timecodeResult = timecodeRe.exec(elem.href);\r\n\r\n\t\t\tif (timecodeResult !== null) {\r\n\t\t\t\tvar time_blocks = {'h':3600, 'm':60, 's':1},\r\n\t\t\t\t\ttimeRE = /[0-9]+[hms]/ig;\r\n\r\n\t\t\t\t// Get each segment e.g. 8m and calculate its value in seconds\r\n\t\t\t\tvar timeMatch = timecodeResult[0].match(timeRE);\r\n\t\t\t\tif (timeMatch) {\r\n\t\t\t\t\ttimeMatch.forEach(function(ts){\r\n\t\t\t\t\t\tvar unit = time_blocks[ts.charAt(ts.length-1)];\r\n\t\t\t\t\t\tvar amount = parseInt(ts.slice(0, -1), 10);\r\n\t\t\t\t\t\t// Add each unit to starttime\r\n\t\t\t\t\t\tstarttime += unit * amount;\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// support direct timestamp e.g. t=200\r\n\t\t\t\t\tstarttime = parseInt(timecodeResult[0].replace('t=', ''), 10);\r\n\t\t\t\t\tif (isNaN(starttime)) starttime = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdef.resolve(elem, '//www.youtube.com/embed/' + groups[1] + '?enablejsapi=1&enablecastapi=1&start=' + starttime);\r\n\t\t} else {\r\n\t\t\tdef.reject();\r\n\t\t}\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\thandleInfo: function(elem, info) {\r\n\r\n\t\tif (modules['showImages'].options.autoplayVideo.value) {\r\n\t\t\t// Avoid auto playing more than 1 item\r\n\t\t\tif ($(elem).closest('.md').find('.expando-button.video').length === 0) info += '&autoplay=1';\r\n\t\t}\r\n\r\n\t\telem.type = 'IFRAME';\r\n\t\telem.setAttribute('data-embed', info);\r\n\t\telem.setAttribute('data-pause', '{\"event\":\"command\",\"func\":\"pauseVideo\",\"args\":\"\"}');\r\n\t\telem.setAttribute('data-play', '{\"event\":\"command\",\"func\":\"playVideo\",\"args\":\"\"}');\r\n\r\n\t\treturn $.Deferred().resolve(elem).promise();\r\n\t}\r\n});\r\n"],"sourceRoot":"/source/"}
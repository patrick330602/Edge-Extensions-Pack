{"version":3,"sources":["modules/hosts/photobucket.js"],"names":[],"mappings":";;AAAA,WAAW,YAAX,EAAyB,aAAzB,EAAwC;AACvC,UAAS,CAAC,iBAAD,CAAT;AACA,KAAI,cAAW,EAAX;AACJ,SAAQ,gBAAS,IAAT,EAAe,IAAf,EAAqB;AAC5B,SAAO,KAAK,OAAL,CAAa,iBAAb,MAAoC,CAAC,CAAD,CADf;EAArB;AAGR,aAAY,oBAAS,IAAT,EAAe;AAC1B,MAAI,MAAM,EAAE,QAAF,EAAN,CADsB;AAE1B,MAAI,OAAO,KAAK,IAAL,CAFe;AAG1B,MAAI,SAAS,sDAAT,CAHsB;AAI1B,MAAI,SAAS,kDAAT,CAJsB;AAK1B,MAAI,QAAQ,KAAK,KAAL,CAAW,MAAX,CAAR,CALsB;AAM1B,MAAI,KAAJ,EAAW;AACV,OAAI,KAAK,WAAL,CAAiB,OAAjB,MAA8B,CAAC,CAAD,EAAI;AACrC,WAAO,KAAK,OAAL,CAAa,OAAb,EAAsB,EAAtB,CAAP,CADqC;IAAtC;;AADU,OAKN,MAAM,CAAN,EAAS,OAAT,CAAiB,GAAjB,MAA0B,CAAC,CAAD,EAAI;AACjC,QAAI,OAAJ,CAAY,IAAZ,EAAkB,IAAlB,EADiC;IAAlC,MAEO;AACN,QAAI,aAAa,mBAAmB,IAAnB,CAAb,CADE;AAEN,mBAAe,IAAf,CAAoB;AACnB,aAAQ,KAAR;AACA,UAAK,SAAS,UAAT;AACL,aAAQ,gBAAS,QAAT,EAAmB;AAC1B,UAAI;AACH,WAAI,SAAS,MAAT,KAAoB,GAApB,EAAyB;AAC5B,YAAI,OAAO,KAAK,KAAL,CAAW,SAAS,YAAT,CAAlB,CADwB;AAE5B,YAAI,OAAJ,CAAY,IAAZ,EAAkB,IAAlB,EAF4B;QAA7B,MAGO;AACN,YAAI,MAAJ,GADM;QAHP;OADD,CAOE,OAAO,CAAP,EAAU;AACX,WAAI,MAAJ,GADW;OAAV;MARK;AAYR,cAAS,iBAAS,QAAT,EAAmB;AAC3B,UAAI,MAAJ,GAD2B;MAAnB;KAfV,EAFM;IAFP;GALD,MA6BO;AACN,OAAI,MAAJ,GADM;GA7BP;AAgCA,SAAO,IAAI,OAAJ,EAAP,CAtC0B;EAAf;AAwCZ,aAAY,oBAAS,IAAT,EAAe,IAAf,EAAqB;AAChC,OAAK,IAAL,GAAY,OAAZ,CADgC;AAEhC,MAAI,gBAAgB,MAAhB,EAAwB;AAC3B,QAAK,GAAL,GAAW,KAAK,QAAL,CADgB;GAA5B,MAEO;AACN,QAAK,GAAL,GAAW,IAAX,CADM;GAFP;;AAMA,MAAI,SAAS,QAAT,OAAwB,UAAxB,EAAoC;AACvC,KAAE,IAAF,EAAQ,OAAR,CAAgB,QAAhB,EAA0B,IAA1B,CAA+B,YAA/B,EAA6C,IAA7C,CAAkD,MAAlD,EAA0D,KAAK,IAAL,CAA1D,CADuC;GAAxC;;AAIA,SAAO,EAAE,QAAF,GAAa,OAAb,CAAqB,IAArB,EAA2B,OAA3B,EAAP,CAZgC;EAArB;CA9Cb","file":"modules/hosts/photobucket.js","sourcesContent":["addLibrary('mediaHosts', 'photobucket', {\r\n\tdomains: ['photobucket.com'],\r\n\tgo: function() {},\r\n\tdetect: function(href, elem) {\r\n\t\treturn href.indexOf('photobucket.com') !== -1;\r\n\t},\r\n\thandleLink: function(elem) {\r\n\t\tvar def = $.Deferred();\r\n\t\tvar href = elem.href;\r\n\t\tvar hashRe = /((i|s|)[0-9]{1,})|media|smg|img(?=.photobucket.com)/i;\r\n\t\tvar apiUrl = 'http://api.photobucket.com/v2/media/fromurl?url=';\r\n\t\tvar match = href.match(hashRe);\r\n\t\tif (match) {\r\n\t\t\tif (href.lastIndexOf('.html') !== -1) {\r\n\t\t\t\thref = href.replace('.html', '');\r\n\t\t\t}\r\n\t\t\t//user linked direct image so no need to hit API\r\n\t\t\tif (match[0].indexOf('i') !== -1) {\r\n\t\t\t\tdef.resolve(elem, href);\r\n\t\t\t} else {\r\n\t\t\t\tvar encodedUrl = encodeURIComponent(href);\r\n\t\t\t\tRESEnvironment.ajax({\r\n\t\t\t\t\tmethod: 'GET',\r\n\t\t\t\t\turl: apiUrl + encodedUrl,\r\n\t\t\t\t\tonload: function(response) {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tif (response.status === 200) {\r\n\t\t\t\t\t\t\t\tvar json = JSON.parse(response.responseText);\r\n\t\t\t\t\t\t\t\tdef.resolve(elem, json);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tdef.reject();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\tdef.reject();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonerror: function(response) {\r\n\t\t\t\t\t\tdef.reject();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tdef.reject();\r\n\t\t}\r\n\t\treturn def.promise();\r\n\t},\r\n\thandleInfo: function(elem, info) {\r\n\t\telem.type = 'IMAGE';\r\n\t\tif (info instanceof Object) {\r\n\t\t\telem.src = info.imageUrl;\r\n\t\t} else {\r\n\t\t\telem.src = info;\r\n\t\t}\r\n\r\n\t\tif (RESUtils.pageType() === 'linklist') {\r\n\t\t\t$(elem).closest('.thing').find('.thumbnail').attr('href', elem.href);\r\n\t\t}\r\n\r\n\t\treturn $.Deferred().resolve(elem).promise();\r\n\t}\r\n});\r\n"],"sourceRoot":"/source/"}
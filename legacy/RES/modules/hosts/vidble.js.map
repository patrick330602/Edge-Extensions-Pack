{"version":3,"sources":["modules/hosts/vidble.js"],"names":[],"mappings":";;AAAA,WAAW,YAAX,EAAyB,QAAzB,EAAmC;AAClC,UAAS,CAAC,YAAD,CAAT;AACA,SAAQ,gBAAS,IAAT,EAAe,IAAf,EAAqB;AAC5B,SAAO,KAAK,OAAL,CAAa,YAAb,IAA6B,CAA7B,CADqB;EAArB;AAGR,aAAY,oBAAS,IAAT,EAAe;AAC1B,MAAI,MAAM,EAAE,QAAF,EAAN;MACH,SAAS,sDAAT;MACA,cAAc,uDAAd;MACA,YAAY,SAAS,QAAT,GAAoB,qBAApB;MACZ,SAAS,OAAO,IAAP,CAAY,KAAK,IAAL,CAArB,CALyB;;AAO1B,MAAI,MAAJ,EAAY;AACX,OAAI,OAAJ,CAAY,IAAZ,EAAkB,SAAS,QAAT,GAAoB,eAApB,GAAsC,OAAO,CAAP,CAAtC,GAAkD,UAAlD,CAAlB,CADW;GAAZ,MAEO;AACN,OAAI,cAAc,YAAY,IAAZ,CAAiB,KAAK,IAAL,CAA/B,CADE;AAEN,OAAI,WAAJ,EAAiB;AAChB,QAAI,SAAS,YAAY,QAAZ,GAAuB,mBAAmB,YAAY,CAAZ,CAAnB,CAAvB,GAA4D,SAA5D,CADG;AAEhB,SAAK,OAAL,GAAe,YAAY,CAAZ,CAAf,CAFgB;;AAIhB,mBAAe,IAAf,CAAoB;AACnB,aAAQ,KAAR;AACA,UAAK,MAAL;;AAEA,aAAQ,gBAAS,QAAT,EAAmB;AAC1B,UAAI,SAAS,MAAT,KAAoB,GAApB,EAAyB;AAC5B,cAAO,IAAI,MAAJ,EAAP,CAD4B;OAA7B;AAGA,UAAI;AACH,WAAI,OAAO,KAAK,KAAL,CAAW,SAAS,YAAT,CAAlB,CADD;AAEH,WAAI,OAAJ,CAAY,IAAZ,EAAkB,IAAlB,EAFG;OAAJ,CAGE,OAAO,KAAP,EAAc;AACf,WAAI,MAAJ,GADe;OAAd;MAPK;AAWR,cAAS,iBAAS,QAAT,EAAmB;AAC3B,UAAI,MAAJ,GAD2B;MAAnB;KAfV,EAJgB;IAAjB;GAJD;AA6BA,SAAO,IAAI,OAAJ,EAAP,CApC0B;EAAf;AAsCZ,aAAY,oBAAS,IAAT,EAAe,IAAf,EAAqB;AAChC,MAAI,OAAO,IAAP,KAAgB,QAAhB,EAA0B;;AAE7B,QAAK,IAAL,GAAY,OAAZ,CAF6B;AAG7B,QAAK,GAAL,GAAW,IAAX,CAH6B;AAI7B,OAAI,SAAS,QAAT,OAAwB,UAAxB,EAAoC;AACvC,MAAE,IAAF,EAAQ,OAAR,CAAgB,QAAhB,EAA0B,IAA1B,CAA+B,YAA/B,EAA6C,IAA7C,CAAkD,MAAlD,EAA0D,KAAK,IAAL,CAA1D,CADuC;IAAxC;GAJD,MAOO;;AAEN,WAAQ,YAAR,EAAsB,WAAtB,CAAkC,QAAlC,EAA4C,aAA5C,CAA0D,IAA1D,EAAgE,IAAhE,EAFM;GAPP;AAWA,SAAO,EAAE,QAAF,GAAa,OAAb,CAAqB,IAArB,EAA2B,OAA3B,EAAP,CAZgC;EAArB;AAcZ,gBAAe,uBAAS,IAAT,EAAe,IAAf,EAAqB;AACnC,OAAK,GAAL,GAAW,KAAK,IAAL,CAAU,GAAV,CAAc,UAAS,CAAT,EAAY,CAAZ,EAAe,CAAf,EAAkB;AAC1C,UAAO;AACN,SAAK,SAAS,QAAT,GAAoB,CAApB;AACL,UAAM,SAAS,QAAT,GAAoB,CAApB;IAFP,CAD0C;GAAlB,CAAzB,CADmC;AAOnC,OAAK,IAAL,GAAY,SAAZ,CAPmC;AAQnC,SAAO,EAAE,QAAF,GAAa,OAAb,CAAqB,IAArB,EAA2B,OAA3B,EAAP,CARmC;EAArB;CAzDhB","file":"modules/hosts/vidble.js","sourcesContent":["addLibrary('mediaHosts', 'vidble', {\r\n\tdomains: ['vidble.com'],\r\n\tdetect: function(href, elem) {\r\n\t\treturn href.indexOf('vidble.com') > 0;\r\n\t},\r\n\thandleLink: function(elem) {\r\n\t\tvar def = $.Deferred(),\r\n\t\t\thashRe = /^https?:\\/\\/(?:www\\.)?vidble.com\\/show\\/([a-z0-9]+)/i,\r\n\t\t\talbumHashRe = /^https?:\\/\\/(?:www\\.)?vidble.com\\/album\\/([a-z0-9]+)/i,\r\n\t\t\tapiPrefix = location.protocol + '//vidble.com/album/',\r\n\t\t\tgroups = hashRe.exec(elem.href);\r\n\r\n\t\tif (groups) {\r\n\t\t\tdef.resolve(elem, location.protocol + '//vidble.com/' + groups[1] + '_med.jpg');\r\n\t\t} else {\r\n\t\t\tvar albumGroups = albumHashRe.exec(elem.href);\r\n\t\t\tif (albumGroups) {\r\n\t\t\t\tvar apiURL = apiPrefix + 'album/' + encodeURIComponent(albumGroups[1]) + '?json=1';\r\n\t\t\t\telem.imgHash = albumGroups[1];\r\n\r\n\t\t\t\tRESEnvironment.ajax({\r\n\t\t\t\t\tmethod: 'GET',\r\n\t\t\t\t\turl: apiURL,\r\n\t\t\t\t\t// aggressiveCache: true,\r\n\t\t\t\t\tonload: function(response) {\r\n\t\t\t\t\t\tif (response.status === 404) {\r\n\t\t\t\t\t\t\treturn def.reject();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tvar json = JSON.parse(response.responseText);\r\n\t\t\t\t\t\t\tdef.resolve(elem, json);\r\n\t\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\t\tdef.reject();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonerror: function(response) {\r\n\t\t\t\t\t\tdef.reject();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn def.promise();\r\n\t},\r\n\thandleInfo: function(elem, info) {\r\n\t\tif (typeof info === 'string') {\r\n\t\t\t// direct image link\r\n\t\t\telem.type = 'IMAGE';\r\n\t\t\telem.src = info;\r\n\t\t\tif (RESUtils.pageType() === 'linklist') {\r\n\t\t\t\t$(elem).closest('.thing').find('.thumbnail').attr('href', elem.href);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// album link\r\n\t\t\tmodules['showImages'].siteModules['vidble'].handleGallery(elem, info);\r\n\t\t}\r\n\t\treturn $.Deferred().resolve(elem).promise();\r\n\t},\r\n\thandleGallery: function(elem, info) {\r\n\t\telem.src = info.pics.map(function(e, i, a) {\r\n\t\t\treturn {\r\n\t\t\t\tsrc: location.protocol + e,\r\n\t\t\t\thref: location.protocol + e\r\n\t\t\t};\r\n\t\t});\r\n\t\telem.type = 'GALLERY';\r\n\t\treturn $.Deferred().resolve(elem).promise();\r\n\t}\r\n});\r\n"],"sourceRoot":"/source/"}
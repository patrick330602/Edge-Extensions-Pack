{"version":3,"sources":["modules/hosts/giphy.js"],"names":[],"mappings":";;AAAA,WAAW,YAAX,EAAyB,OAAzB,EAAkC;AACjC,UAAS,CAAC,WAAD,CAAT;AACA,SAAQ,gBAAS,IAAT,EAAe,IAAf,EAAqB;AAC5B,SAAO,KAAK,OAAL,CAAa,WAAb,MAA8B,CAAC,CAAD,CADT;EAArB;AAGR,aAAY,oBAAS,IAAT,EAAe;AAC1B,MAAI,MAAM,EAAE,QAAF,EAAN,CADsB;;AAG1B,MAAI,SAAS,yDAAT,CAHsB;AAI1B,MAAI,SAAS,OAAO,IAAP,CAAY,KAAK,IAAL,CAArB,CAJsB;;AAM1B,MAAI,CAAC,MAAD,EAAS,OAAO,IAAI,MAAJ,EAAP,CAAb;;AAEA,MAAI,UAAU,MAAC,CAAO,CAAP,CAAD,GAAc,IAAd,GAAqB,KAArB,CARY;AAS1B,MAAI,WAAW,SAAS,QAAT,GAAoB,mBAApB,GAA0C,OAAO,CAAP,CAA1C,CATW;AAU1B,MAAI,SAAS,SAAS,QAAT,GAAoB,0BAApB,GAAiD,OAAO,CAAP,CAAjD,GAA6D,YAA7D,CAVa;AAW1B,MAAI,SAAS,SAAS,QAAT,GAAoB,0BAApB,GAAiD,OAAO,CAAP,CAAjD,GAA6D,YAA7D,CAXa;;AAa1B,MAAI,OAAJ,CAAY,IAAZ,EAAkB,EAAE,SAAS,OAAT,EAAkB,UAAU,QAAV,EAAoB,QAAQ,MAAR,EAAgB,QAAQ,MAAR,EAA1E,EAb0B;;AAe1B,SAAO,IAAI,OAAJ,EAAP,CAf0B;EAAf;AAiBZ,aAAY,oBAAS,IAAT,EAAe,IAAf,EAAqB;AAChC,MAAI,KAAK,OAAL,EAAc;;;AAGjB,OAAI,WAAW,SAAX,QAAW,CAAS,OAAT,EAAkB;AAChC,QAAI,WAAW,aAAa,OAAb,CAAqB,SAArB,CAAX,CAD4B;AAEhC,QAAI,QAAQ;AACX,WAAM,IAAN;AACA,eAAU,IAAV;AACA,YAAO,IAAP;AACA,eAAU,KAAK,QAAL;AACV,YAAO;AACN,aAAO,KAAK,QAAL;AACP,cAAQ,OAAR;AACA,aAAO,EAAP;MAHD;KALG,CAF4B;AAahC,UAAM,OAAN,GAAgB,CACf;AACC,eAAU,KAAK,MAAL;AACV,aAAQ,WAAR;KAHc,CAAhB,CAbgC;AAmBhC,QAAI,UAAU,SAAS,IAAT,CAAc,KAAd,EAAqB,CAArB,CAAV,CAnB4B;AAoBhC,QAAI,WAAJ,CAAgB,OAAhB,EApBgC;AAqBhC,WAAO,OAAP,CArBgC;IAAlB,CAHE;;AA2BjB,QAAK,IAAL,GAAY,iBAAZ,CA3BiB;AA4BjB,QAAK,YAAL,GAAoB,cAApB,CA5BiB;AA6BjB,QAAK,cAAL,GAAsB;AACrB,cAAU,QAAV;AACA,WAAO,IAAP;IAFD,CA7BiB;GAAlB,MAkCO;;;AAGN,QAAK,IAAL,GAAY,OAAZ,CAHM;AAIN,QAAK,GAAL,GAAW,KAAK,MAAL,CAJL;GAlCP;;AAyCA,MAAI,SAAS,QAAT,OAAwB,UAAxB,EAAoC;AACvC,KAAE,IAAF,EAAQ,OAAR,CAAgB,QAAhB,EAA0B,IAA1B,CAA+B,YAA/B,EAA6C,IAA7C,CAAkD,MAAlD,EAA0D,KAAK,IAAL,CAA1D,CADuC;GAAxC;AAGA,SAAO,EAAE,QAAF,GAAa,OAAb,CAAqB,IAArB,EAA2B,OAA3B,EAAP,CA7CgC;EAArB;CAtBb","file":"modules/hosts/giphy.js","sourcesContent":["addLibrary('mediaHosts', 'giphy', {\r\n\tdomains: ['giphy.com'],\r\n\tdetect: function(href, elem) {\r\n\t\treturn href.indexOf('giphy.com') !== -1;\r\n\t},\r\n\thandleLink: function(elem) {\r\n\t\tvar def = $.Deferred();\r\n\r\n\t\tvar hashRe = /^http:\\/\\/(?:www\\.)?giphy\\.com\\/gifs\\/(.*?)(\\/html5)?$/i;\r\n\t\tvar groups = hashRe.exec(elem.href);\r\n\r\n\t\tif (!groups) return def.reject();\r\n\r\n\t\tvar isHtml5 = (groups[2]) ? true : false;\r\n\t\tvar giphyUrl = location.protocol + '//giphy.com/gifs/' + groups[1];\r\n\t\tvar mp4Url = location.protocol + '//media.giphy.com/media/' + groups[1] + '/giphy.mp4';\r\n\t\tvar gifUrl = location.protocol + '//media.giphy.com/media/' + groups[1] + '/giphy.gif';\r\n\r\n\t\tdef.resolve(elem, { isHtml5: isHtml5, giphyUrl: giphyUrl, mp4Url: mp4Url, gifUrl: gifUrl });\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\thandleInfo: function(elem, info) {\r\n\t\tif (info.isHtml5) {\r\n\r\n\t\t\t// html5 video player\r\n\t\t\tvar generate = function(options) {\r\n\t\t\t\tvar template = RESTemplates.getSync('GiphyUI');\r\n\t\t\t\tvar video = {\r\n\t\t\t\t\tloop: true,\r\n\t\t\t\t\tautoplay: true,\r\n\t\t\t\t\tmuted: true,\r\n\t\t\t\t\tgiphyUrl: info.giphyUrl,\r\n\t\t\t\t\tbrand: {\r\n\t\t\t\t\t\t'url': info.giphyUrl,\r\n\t\t\t\t\t\t'name': 'Giphy',\r\n\t\t\t\t\t\t'img': ''\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tvideo.sources = [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t'source': info.mp4Url,\r\n\t\t\t\t\t\t'type': 'video/mp4'\r\n\t\t\t\t\t}\r\n\t\t\t\t];\r\n\t\t\t\tvar element = template.html(video)[0];\r\n\t\t\t\tnew MediaPlayer(element);\r\n\t\t\t\treturn element;\r\n\t\t\t};\r\n\r\n\t\t\telem.type = 'GENERIC_EXPANDO';\r\n\t\t\telem.expandoClass = ' video-muted';\r\n\t\t\telem.expandoOptions = {\r\n\t\t\t\tgenerate: generate,\r\n\t\t\t\tmedia: info\r\n\t\t\t};\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// gif\r\n\t\t\telem.type = 'IMAGE';\r\n\t\t\telem.src = info.gifUrl;\r\n\t\t}\r\n\r\n\t\tif (RESUtils.pageType() === 'linklist') {\r\n\t\t\t$(elem).closest('.thing').find('.thumbnail').attr('href', elem.href);\r\n\t\t}\r\n\t\treturn $.Deferred().resolve(elem).promise();\r\n\t}\r\n});\r\n"],"sourceRoot":"/source/"}
{"version":3,"sources":["modules/userTagger.js"],"names":[],"mappings":";;AAAA,UAAU,YAAV,EAAwB,UAAS,MAAT,EAAiB,QAAjB,EAA2B;AAClD,QAAO,UAAP,GAAoB,aAApB,CADkD;AAElD,QAAO,QAAP,GAAkB,OAAlB,CAFkD;AAGlD,QAAO,WAAP,GAAqB,0LAArB,CAHkD;AAIlD,QAAO,OAAP,GAAiB;;;;;;;;AAQhB,cAAY;AACX,SAAM,SAAN;AACA,UAAO,KAAP;AACA,gBAAa,gJAAb;GAHD;AAKA,aAAW;AACV,SAAM,SAAN;AACA,UAAO,IAAP;AACA,gBAAa,qDAAb;AACA,aAAU,IAAV;GAJD;AAMA,mBAAiB;AAChB,SAAM,SAAN;AACA,UAAO,IAAP;AACA,gBAAa,mEAAb;AACA,aAAU,IAAV;GAJD;AAMA,2BAAyB;AACxB,SAAM,SAAN;AACA,UAAO,IAAP;AACA,gBAAa,0IAAb;AACA,aAAU,IAAV;GAJD;AAMA,YAAU;AACT,SAAM,SAAN;AACA,UAAO,IAAP;AACA,gBAAa,8CAAb;AACA,aAAU,IAAV;GAJD;AAMA,aAAW;AACV,SAAM,SAAN;AACA,UAAO,IAAP;AACA,gBAAa,kEAAb;AACA,aAAU,IAAV;GAJD;EArCD,CAJkD;;AAiDlD,QAAO,UAAP,GAAoB,uBAApB,CAjDkD;AAkDlD,KAAI,iBAAJ,EAAuB,aAAvB,EAAsC,eAAtC,EAAuD,iBAAvD,EAA0E,cAA1E,CAlDkD;;AAoDlD,QAAO,EAAP,GAAY,YAAW;AACtB,MAAI,IAAC,CAAK,SAAL,EAAD,IAAuB,KAAK,UAAL,EAAvB,EAA2C;;AAE9C,QAAK,IAAL,GAAY,SAAS,KAAT,CAAe,WAAW,OAAX,CAAmB,4BAAnB,CAAf,EAAiE,4BAAjE,EAA+F,IAA/F,KAAwG,EAAxG;;;AAFkC,OAK1C,SAAS,gBAAT,CAA0B,WAA1B,CAAJ,EAA4C;;AAE3C,YAAQ,WAAR,EAAqB,MAArB,CAA4B,oBAA5B,EAAkD,cAAlD;;AAF2C,QAIvC,UAAU,EAAE,+BAAF,CAAV,CAJuC;AAK3C,QAAI,YAAY,EAAE,yFAAF,CAAZ,CALuC;AAM3C,MAAE,OAAF,EAAW,MAAX,CAAkB,SAAlB,EAN2C;AAO3C,MAAE,qBAAF,EAAyB,MAAzB,CAAgC,OAAhC,EAP2C;AAQ3C,MAAE,YAAF,EAAgB,MAAhB,CAAuB,YAAW;AACjC,wBADiC;KAAX,CAAvB,CAR2C;;AAY3C,QAAI,cAAc,SAAS,QAAQ,WAAR,EAAqB,OAArB,CAA6B,aAA7B,EAA4C,KAA5C,EAAmD,EAA5D,CAAd,CAZuC;AAa3C,QAAI,WAAJ,EAAiB;AAChB,SAAI,iBAAiB,SAAS,aAAT,CAAuB,KAAvB,CAAjB,CADY;AAEhB,oBAAe,EAAf,GAAoB,iBAApB,CAFgB;AAGhB,oBAAe,SAAf,GAA2B,oBAA3B,CAHgB;AAIhB,oBAAe,IAAf,GAAsB,CAAtB,CAJgB;AAKhB,oBAAe,SAAf,GAA2B,CAA3B,CALgB;;AAOhB,SAAI,aAAa,SAAS,aAAT,CAAuB,GAAvB,CAAb,CAPY;AAQhB,gBAAW,SAAX,GAAuB,mBAAvB,CARgB;AAShB,gBAAW,gBAAX,CAA4B,OAA5B,EAAqC,UAAS,CAAT,EAAY;AAChD,UAAI,eAAe,IAAf,KAAwB,CAAxB,EAA2B;AAC9B,sBAAe,IAAf,GAAsB,eAAe,SAAf,CADQ;OAA/B,MAEO;AACN,sBAAe,IAAf,GADM;OAFP;AAKA,yBANgD;MAAZ,CAArC,CATgB;AAiBhB,OAAE,cAAF,EAAkB,MAAlB,CAAyB,OAAzB,EAjBgB;AAkBhB,oBAAe,WAAf,CAA2B,UAA3B,EAlBgB;;AAoBhB,SAAI,WAAW,SAAS,aAAT,CAAuB,MAAvB,CAAX,CApBY;AAqBhB,cAAS,SAAT,GAAqB,iBAArB,CArBgB;AAsBhB,cAAS,WAAT,GAAuB,QAAvB,CAtBgB;AAuBhB,oBAAe,WAAf,CAA2B,QAA3B,EAvBgB;;AAyBhB,SAAI,cAAc,SAAS,aAAT,CAAuB,GAAvB,CAAd,CAzBY;AA0BhB,iBAAY,SAAZ,GAAwB,eAAxB,CA1BgB;AA2BhB,iBAAY,gBAAZ,CAA6B,OAA7B,EAAsC,UAAS,CAAT,EAAY;AACjD,UAAI,eAAe,IAAf,KAAwB,eAAe,SAAf,EAA0B;AACrD,sBAAe,IAAf,GAAsB,CAAtB,CADqD;OAAtD,MAEO;AACN,sBAAe,IAAf,GADM;OAFP;AAKA,yBANiD;MAAZ,CAAtC,CA3BgB;AAmChB,oBAAe,WAAf,CAA2B,WAA3B,EAnCgB;;AAqChB,OAAE,qBAAF,EAAyB,MAAzB,CAAgC,cAAhC,EArCgB;KAAjB;AAuCA,QAAI,YAAY,EAAE,gCAAF,CAAZ,CApDuC;AAqD3C,MAAE,SAAF,EAAa,MAAb,CAAoB,wOAApB,EArD2C;AAsD3C,MAAE,qBAAF,EAAyB,MAAzB,CAAgC,SAAhC,EAtD2C;AAuD3C,MAAE,2BAAF,EAA+B,KAA/B,CAAqC,UAAS,CAAT,EAAY;AAChD,OAAE,cAAF,GADgD;AAEhD,SAAI,QAAQ,EAAE,IAAF,CAAR,CAF4C;;AAIhD,SAAI,MAAM,QAAN,CAAe,QAAf,CAAJ,EAA8B;AAC7B,aAAO,KAAP,CAD6B;MAA9B;AAGA,SAAI,MAAM,QAAN,CAAe,QAAf,CAAJ,EAA8B;AAC7B,YAAM,WAAN,CAAkB,YAAlB,EAD6B;MAA9B;AAGA,WAAM,QAAN,CAAe,QAAf,EAVgD;AAWhD,WAAM,QAAN,GAAiB,WAAjB,CAA6B,QAA7B,EAAuC,IAAvC,CAA4C,MAA5C,EAAoD,MAApD,GAXgD;AAYhD,WAAM,IAAN,CAAW,qBAAX,EAAkC,MAAlC,GAZgD;AAahD,WAAM,MAAN,CAAa,EAAE,EAAE,MAAF,CAAF,CAAY,QAAZ,CAAqB,YAArB,IACZ,2BADY,GAEZ,0BAFY,CAAb,CAbgD;AAgBhD,sBAAiB,EAAE,EAAE,MAAF,CAAF,CAAY,IAAZ,CAAiB,MAAjB,CAAjB,EAA2C,EAAE,EAAE,MAAF,CAAF,CAAY,QAAZ,CAAqB,YAArB,CAA3C,EAhBgD;KAAZ,CAArC,CAvD2C;AAyE3C,uBAzE2C;IAA5C;;AA4EA,OAAI,KAAK,OAAL,CAAa,SAAb,CAAuB,KAAvB,EAA8B;AACjC,uBAAmB,SAAS,IAAT,CAAnB,CADiC;IAAlC;;AAjF8C,oBAqF9C,GAAoB,SAAS,aAAT,CAAuB,KAAvB,EAA8B,mBAA9B,EAAmD,gBAAnD,CAApB,CArF8C;AAsF9C,OAAI,WAAW,uFAAX,CAtF0C;AAuF9C,eAAY,0FAAZ,CAvF8C;AAwF9C,eAAY,wFAAZ,CAxF8C;AAyF9C,eAAY,gEAAZ,CAzF8C;AA0F9C,eAAY,0EAAZ,CA1F8C;AA2F9C,QAAK,IAAI,KAAJ,IAAa,gBAAlB,EAAoC;AACnC,QAAI,UAAU,KAAC,KAAU,MAAV,GAAoB,aAArB,GAAqC,KAArC,CADqB;AAEnC,gBAAY,sCAAsC,OAAtC,GAAgD,WAAhD,GAA8D,iBAAiB,KAAjB,CAA9D,GAAwF,uBAAxF,GAAkH,KAAlH,GAA0H,IAA1H,GAAiI,KAAjI,GAAyI,WAAzI,CAFuB;IAApC;AAIA,eAAY,WAAZ,CA/F8C;AAgG9C,eAAY,qFAAZ,CAhG8C;AAiG9C,eAAY,0CAA0C,QAAQ,oBAAR,EAA8B,eAA9B,CAA8C,YAA9C,EAA4D,YAA5D,EAA0E,GAA1E,EAA+E,UAA/E,CAA1C,GAAuI,UAAvI;AAjGkC,WAkG9C,IAAY,oPAAZ,CAlG8C;AAmG9C,eAAY,gTAAZ,CAnG8C;AAoG9C,eAAY,wKAAZ,CApG8C;AAqG9C,KAAE,iBAAF,EAAqB,IAArB,CAA0B,QAA1B,EArG8C;AAsG9C,OAAI,cAAc,kBAAkB,aAAlB,CAAgC,6BAAhC,CAAd,CAtG0C;AAuG9C,YAAS,WAAT,CAAqB,WAArB,EAAkC,SAAS,aAAT,CAAuB,YAAvB,CAAoC,IAApC,EAA0C,kBAA1C,EAA8D,KAA9D,EAAqE,IAArE,EAA2E,KAA3E,CAAlC,EAvG8C;AAwG9C,mBAAgB,kBAAkB,aAAlB,CAAgC,gBAAhC,CAAhB,CAxG8C;AAyG9C,iBAAc,gBAAd,CAA+B,OAA/B,EAAwC,gBAAxC,EAA0D,KAA1D,EAzG8C;AA0G9C,qBAAkB,kBAAkB,aAAlB,CAAgC,kBAAhC,CAAlB,CA1G8C;AA2G9C,mBAAgB,gBAAhB,CAAiC,QAAjC,EAA2C,gBAA3C,EAA6D,KAA7D,EA3G8C;AA4G9C,uBAAoB,kBAAkB,aAAlB,CAAgC,oBAAhC,CAApB,CA5G8C;AA6G9C,OAAI,iBAAiB,kBAAkB,aAAlB,CAAgC,iBAAhC,CAAjB,CA7G0C;AA8G9C,kBAAe,gBAAf,CAAgC,OAAhC,EAAyC,UAAS,CAAT,EAAY;AACpD,mBAAe,cAAf,EADoD;IAAZ,EAEtC,KAFH,EA9G8C;AAiH9C,OAAI,iBAAiB,kBAAkB,aAAlB,CAAgC,uBAAhC,CAAjB,CAjH0C;AAkH9C,kBAAe,gBAAf,CAAgC,OAAhC,EAAyC,UAAS,CAAT,EAAY;AACpD,QAAI,QAAQ,eAAe,KAAf,CAAqB,KAArB,CAA2B,IAA3B,CAAR,CADgD;AAEpD,SAAK,IAAI,IAAI,MAAM,MAAN,GAAe,CAAf,EAAkB,IAAI,CAAJ,EAAO,GAAtC,EAA2C;AAC1C,oBAAe,gBAAf,CAAgC,MAAM,CAAN,CAAhC,EAD0C;KAA3C;IAFwC,CAAzC,CAlH8C;AAwH9C,OAAI,iBAAiB,kBAAkB,aAAlB,CAAgC,iBAAhC,CAAjB,CAxH0C;AAyH9C,kBAAe,YAAf,CAA4B,MAA5B,EAAoC,QAApC,EAzH8C;AA0H9C,kBAAe,YAAf,CAA4B,OAA5B,EAAqC,YAArC,EA1H8C;AA2H9C,kBAAe,gBAAf,CAAgC,OAAhC,EAAyC,UAAS,CAAT,EAAY;AACpD,MAAE,cAAF,GADoD;AAEpD,kBAFoD;IAAZ,EAGtC,KAHH,EA3H8C;AA+H9C,OAAI,kBAAkB,kBAAkB,aAAlB,CAAgC,kBAAhC,CAAlB,CA/H0C;AAgI9C,mBAAgB,gBAAhB,CAAiC,OAAjC,EAA0C,UAAS,CAAT,EAAY;AACrD,yBADqD;IAAZ,EAEvC,KAFH;;AAhI8C,iBAoI9C,GAAiB,kBAAkB,aAAlB,CAAgC,MAAhC,CAAjB,CApI8C;AAqI9C,kBAAe,gBAAf,CAAgC,QAAhC,EAA0C,UAAS,CAAT,EAAY;AACrD,MAAE,cAAF,GADqD;AAErD,kBAFqD;IAAZ,EAGvC,IAHH,EArI8C;AAyI9C,YAAS,IAAT,CAAc,WAAd,CAA0B,iBAA1B,EAzI8C;;AA2I9C,qBAAkB,aAAlB,CAAgC,gBAAhC,EAAkD,gBAAlD,CAAmE,SAAnE,EAA8E,UAAS,CAAT,EAAY;AACzF,QAAI,EAAE,OAAF,KAAc,EAAd,EAAkB;;AAErB,0BAFqB;KAAtB;IAD6E,EAK3E,IALH;;AA3I8C,YAkJ9C;;AAlJ8C,OAoJ1C,SAAS,QAAT,OAAwB,UAAxB,EAAoC;AACvC,aAAS,eAAT,CAAyB,aAAzB,EAAwC,2BAAxC,EADuC;AAEvC,aAAS,eAAT,CAAyB,aAAzB,EAAwC,SAAxC,EAFuC;IAAxC,MAGO;AACN,aAAS,eAAT,CAAyB,WAAzB,EAAsC,kBAAtC,EADM;AAEN,aAAS,eAAT,CAAyB,WAAzB,EAAsC,SAAtC,EAFM;IAHP;;AAQA,OAAI,SAAS,OAAT,CAAiB,OAAjB,CAAyB,IAAzB,CAA8B,SAAS,IAAT,CAAlC,EAAkD;AACjD,QAAI,eAAe,SAAS,aAAT,CAAuB,gCAAvB,CAAf,CAD6C;AAEjD,QAAI,OAAQ,YAAP,KAAwB,WAAxB,IAAyC,iBAAiB,IAAjB,EAAwB;AACrE,SAAI,cAAc,SAAS,aAAT,CAAuB,UAAvB,CAAd;SACH,iBADD,CADqE;AAGrE,SAAI,OAAQ,WAAP,KAAuB,WAAvB,IAAwC,gBAAgB,IAAhB,EAAuB;AACnE,0BAAoB,YAAY,YAAZ,CAAyB,OAAzB,CAApB,CADmE;AAEnE,0BAAoB,iBAAC,KAAsB,IAAtB,GAA8B,kBAAkB,SAAlB,CAA4B,CAA5B,EAA+B,kBAAkB,MAAlB,GAA2B,CAA3B,CAA9D,GAA8F,EAA9F,CAF+C;MAApE,MAGO;AACN,0BAAoB,EAApB,CADM;MAHP;KAHD;IAFD;;AAcA,yBA1K8C;GAA/C;EADW,CApDsC;;AAmOlD,UAAS,mBAAT,GAA+B;AAC9B,UAAQ,aAAR,EAAuB,eAAvB,CAAuC,KAAvC,EAA8C,qEAA9C,EACC,UAAS,OAAT,EAAkB,GAAlB,EAAuB,KAAvB,EAA8B;AAC7B,OAAI,UAAU,kBAAV,CADyB;AAE7B,OAAI,OAAJ,EAAa;AACZ,QAAI,MAAM,cAAc,QAAQ,YAAR,CAAqB,UAArB,CAAd,CADE;AAEZ,QAAI,GAAJ,EAAS;AACR,YAAO,UAAU,GAAV,CADC;KAAT;AAGA,WAAO,GAAP,CALY;IAAb,MAMO;AACN,WAAO,2CAAP,CADM;IANP;GAFD,EAYA,UAAS,OAAT,EAAkB,GAAlB,EAAuB,KAAvB,EAA8B,CAA9B,EAAiC;AAChC,OAAI,UAAU,kBAAV,CAD4B;AAEhC,OAAI,OAAJ,EAAa;AACZ,aAAS,KAAT,CAAe,OAAf,EADY;AAEZ,eAAW,YAAW;AACrB,SAAI,QAAQ,EAAR,EAAY;AACf,eAAS,cAAT,CAAwB,eAAxB,EAAyC,KAAzC,GAAiD,GAAjD,CADe;MAAhB;KADU,EAIR,EAJH,EAFY;IAAb,MAOO;AACN,WAAO,2CAAP,CADM;IAPP;GAFD,CAbD,CAD8B;;AA6B9B,WAAS,gBAAT,GAA4B;AAC3B,OAAI,WAAW,QAAQ,eAAR,EAAyB,QAAzB,EAAX,CADuB;AAE3B,OAAI,aAAa,WAAW,SAAS,KAAT,GAAiB,SAAS,IAAT,CAFlB;;AAI3B,OAAI,UAAU,WAAW,aAAX,CAAyB,eAAzB,CAAV,CAJuB;AAK3B,UAAO,OAAP,CAL2B;GAA5B;EA7BD;;AAsCA,UAAS,2BAAT,CAAqC,OAArC,EAA8C;AAC7C,MAAI,MAAM,EAAE,OAAF,EAAW,OAAX,CAAmB,QAAnB,EAA6B,CAA7B,CAAN;;AADyC,oBAG7C,CAAmB,GAAnB,EAAwB,CAAxB,EAH6C;EAA9C;;AAMA,UAAS,kBAAT,CAA4B,GAA5B,EAAiC,QAAjC,EAA2C;AAC1C,MAAI,CAAC,SAAS,YAAT,EAAD,EAA0B,OAA9B;;AAEA,MAAI,cAAc,IAAI,gBAAJ,CAAqB,gBAArB,CAAd,CAHsC;AAI1C,MAAI,QAAJ,EAAc;AACb,iBAAc,MAAM,SAAN,CAAgB,KAAhB,CAAsB,IAAtB,CAA2B,WAA3B,EAAwC,CAAxC,EAA2C,WAAW,CAAX,CAAzD,CADa;GAAd,MAEO;AACN,iBAAc,MAAM,SAAN,CAAgB,KAAhB,CAAsB,IAAtB,CAA2B,WAA3B,CAAd,CADM;GAFP;AAKA,cAAY,OAAZ,CAAoB,UAAS,UAAT,EAAqB;AACxC,cAAW,gBAAX,CAA4B,OAA5B,EAAqC,eAArC,EAAsD,IAAtD,EADwC;GAArB,CAApB,CAT0C;EAA3C;;AAcA,UAAS,eAAT,CAAyB,CAAzB,EAA4B;AAC3B,MAAI,OAAO,WAAW,OAAX,CAAmB,4BAAnB,CAAP,CADuB;AAE3B,MAAI,OAAO,IAAP,KAAgB,WAAhB,EAA6B;AAChC,UAAO,IAAP,GAAc,SAAS,KAAT,CAAe,IAAf,EAAqB,4BAArB,EAAmD,IAAnD,KAA4D,EAA5D,CADkB;GAAjC;;AAIA,MAAI,QAAQ,EAAE,IAAF,CAAR,CANuB;AAO3B,MAAI,cAAc,MAAM,QAAN,CAAe,QAAf,CAAd,CAPuB;AAQ3B,MAAI,QAAQ,IAAI,SAAS,KAAT,CAAe,IAAnB,CAAR,CARuB;AAS3B,MAAI,aAAa,MAAM,SAAN,EAAb;;;AATuB,MAYvB,MAAM,QAAN,CAAe,UAAf,KAA8B,CAAC,UAAD,IAAe,eAAe,SAAS,YAAT,EAAf,EAAwC;AACxF,UADwF;GAAzF;;AAIA,MAAI,YAAY,MAAM,aAAN,CAAoB,aAApB,CAAZ,CAhBuB;;AAkB3B,eAAa,WAAW,WAAX,EAAb,CAlB2B;;AAoB3B,MAAI,QAAQ,CAAR,CApBuB;AAqB3B,MAAI,OAAO,OAAO,IAAP,CAAY,UAAZ,CAAP,KAAmC,WAAnC,EAAgD;AACnD,OAAI,OAAO,OAAO,IAAP,CAAY,UAAZ,EAAwB,KAAxB,KAAkC,WAAzC,EAAsD;AACzD,YAAQ,SAAS,OAAO,IAAP,CAAY,UAAZ,EAAwB,KAAxB,EAA+B,EAAxC,CAAR,CADyD;IAA1D;GADD,MAIO;AACN,UAAO,IAAP,CAAY,UAAZ,IAA0B,EAA1B,CADM;GAJP;;;;;;;;;;AArB2B,MAqCvB,MAAM,QAAN,CAAe,IAAf,CAAJ,EAA0B;;AAEzB,WAFyB;AAGzB,OAAI,YAAY,QAAZ,CAAqB,SAArB,CAAJ,EAAqC;;AAEpC,YAFoC;IAArC;GAHD,MAOO,IAAI,MAAM,QAAN,CAAe,OAAf,CAAJ,EAA6B;;AAEnC,WAFmC;GAA7B,MAGA,IAAI,MAAM,QAAN,CAAe,MAAf,CAAJ,EAA4B;;AAElC,WAFkC;AAGlC,OAAI,YAAY,QAAZ,CAAqB,OAArB,CAAJ,EAAmC;;AAElC,YAFkC;IAAnC;GAHM,MAOA,IAAI,MAAM,QAAN,CAAe,SAAf,CAAJ,EAA+B;;AAErC,WAFqC;GAA/B;AAIP,SAAO,IAAP,CAAY,UAAZ,EAAwB,KAAxB,GAAgC,KAAhC,CA1D2B;AA2D3B,aAAW,OAAX,CAAmB,4BAAnB,EAAiD,KAAK,SAAL,CAAe,OAAO,IAAP,CAAhE,EA3D2B;AA4D3B,YAAU,SAAV,EAAqB,UAArB,EAAiC,KAAjC,EA5D2B;EAA5B;;AA+DA,KAAI,iBAAJ,EAAuB,YAAvB,CA5VkD;;AA8VlD,UAAS,gBAAT,CAA0B,UAA1B,EAAsC,UAAtC,EAAkD;AACjD,sBAAoB,cAAc,iBAAd,CAD6B;AAEjD,iBAAe,OAAQ,UAAP,KAAsB,WAAtB,IAAqC,eAAe,IAAf,GAAuB,YAA7D,GAA4E,UAA5E,CAFkC;AAGjD,MAAI,cAAc,EAAd,CAH6C;AAIjD,MAAI,aAAa,EAAE,YAAF,EAAgB,GAAhB,EAAb,CAJ6C;AAKjD,OAAK,IAAI,QAAJ,IAAgB,OAAO,IAAP,EAAa;AACjC,OAAI,eAAe,cAAf,EAA+B;AAClC,QAAI,OAAO,OAAO,IAAP,CAAY,QAAZ,EAAsB,GAAtB,KAA8B,WAArC,EAAkD;AACrD,iBAAY,IAAZ,CAAiB,QAAjB,EADqD;KAAtD;IADD,MAIO;AACN,gBAAY,IAAZ,CAAiB,QAAjB,EADM;IAJP;GADD;AASA,UAAQ,iBAAR;AACC,QAAK,KAAL;AACC,gBAAY,IAAZ,CAAiB,UAAS,CAAT,EAAY,CAAZ,EAAe;AAC/B,SAAI,OAAO,OAAQ,OAAO,IAAP,CAAY,CAAZ,EAAe,GAAf,KAAuB,WAA9B,GAA6C,OAA9C,GAAwD,OAAO,IAAP,CAAY,CAAZ,EAAe,GAAf,CAAmB,WAAnB,EAAxD,CADoB;AAE/B,SAAI,OAAO,OAAQ,OAAO,IAAP,CAAY,CAAZ,EAAe,GAAf,KAAuB,WAA9B,GAA6C,OAA9C,GAAwD,OAAO,IAAP,CAAY,CAAZ,EAAe,GAAf,CAAmB,WAAnB,EAAxD,CAFoB;AAG/B,YAAO,IAAC,GAAO,IAAP,GAAe,CAAhB,GAAoB,IAAC,GAAO,IAAP,GAAe,CAAC,CAAD,GAAK,CAArB,CAHI;KAAf,CAAjB,CADD;AAMC,QAAI,YAAJ,EAAkB;AACjB,iBAAY,OAAZ,GADiB;KAAlB;AAGA,UATD;AADD,QAWM,QAAL;AACC,gBAAY,IAAZ,CAAiB,UAAS,CAAT,EAAY,CAAZ,EAAe;AAC/B,SAAI,OAAO,OAAQ,OAAO,IAAP,CAAY,CAAZ,EAAe,MAAf,KAA0B,WAAjC,GAAgD,GAAjD,GAAuD,GAAvD,CADoB;AAE/B,SAAI,OAAO,OAAQ,OAAO,IAAP,CAAY,CAAZ,EAAe,MAAf,KAA0B,WAAjC,GAAgD,GAAjD,GAAuD,GAAvD,CAFoB;AAG/B,YAAO,IAAC,GAAO,IAAP,GAAe,CAAhB,GAAoB,IAAC,GAAO,IAAP,GAAe,CAAC,CAAD,GAAK,CAArB,CAHI;KAAf,CAAjB,CADD;AAMC,QAAI,YAAJ,EAAkB;AACjB,iBAAY,OAAZ,GADiB;KAAlB;AAGA,UATD;AAXD,QAqBM,OAAL;AACC,gBAAY,IAAZ,CAAiB,UAAS,CAAT,EAAY,CAAZ,EAAe;AAC/B,SAAI,SAAS,OAAQ,OAAO,IAAP,CAAY,CAAZ,EAAe,KAAf,KAAyB,WAAhC,GAA+C,OAAhD,GAA0D,OAAO,IAAP,CAAY,CAAZ,EAAe,KAAf,CAAqB,WAArB,EAA1D,CADkB;AAE/B,SAAI,SAAS,OAAQ,OAAO,IAAP,CAAY,CAAZ,EAAe,KAAf,KAAyB,WAAhC,GAA+C,OAAhD,GAA0D,OAAO,IAAP,CAAY,CAAZ,EAAe,KAAf,CAAqB,WAArB,EAA1D,CAFkB;AAG/B,YAAO,MAAC,GAAS,MAAT,GAAmB,CAApB,GAAwB,MAAC,GAAS,MAAT,GAAmB,CAAC,CAAD,GAAK,CAAzB,CAHA;KAAf,CAAjB,CADD;AAMC,QAAI,YAAJ,EAAkB;AACjB,iBAAY,OAAZ,GADiB;KAAlB;AAGA,UATD;AArBD,QA+BM,OAAL;AACC,gBAAY,IAAZ,CAAiB,UAAS,CAAT,EAAY,CAAZ,EAAe;AAC/B,SAAI,OAAO,OAAQ,OAAO,IAAP,CAAY,CAAZ,EAAe,KAAf,KAAyB,WAAhC,GAA+C,CAAhD,GAAoD,OAAO,IAAP,CAAY,CAAZ,EAAe,KAAf,CADhC;AAE/B,SAAI,OAAO,OAAQ,OAAO,IAAP,CAAY,CAAZ,EAAe,KAAf,KAAyB,WAAhC,GAA+C,CAAhD,GAAoD,OAAO,IAAP,CAAY,CAAZ,EAAe,KAAf,CAFhC;AAG/B,YAAO,IAAC,GAAO,IAAP,GAAe,CAAhB,GAAoB,IAAC,GAAO,IAAP,GAAe,CAAC,CAAD,GAAM,EAAE,WAAF,KAAkB,EAAE,WAAF,EAAlB,CAHlB;KAAf,CAAjB,CADD;AAMC,QAAI,YAAJ,EAAkB;AACjB,iBAAY,OAAZ,GADiB;KAAlB;AAGA,UATD;AA/BD,QAyCM,UAAL;;AAzCD;;AA6CE,gBAAY,IAAZ,CAAiB,UAAS,CAAT,EAAY,CAAZ,EAAe;AAC/B,YAAO,CAAC,CAAE,WAAF,KAAkB,EAAE,WAAF,EAAlB,GAAqC,CAAtC,GAA0C,CAAC,CAAE,WAAF,KAAkB,EAAE,WAAF,EAAlB,GAAqC,CAAC,CAAD,GAAK,CAA3C,CADlB;KAAf,CAAjB,CAFD;AAKC,QAAI,YAAJ,EAAkB;AACjB,iBAAY,OAAZ,GADiB;KAAlB;AAGA,UARD;AA3CD,GAdiD;AAmEjD,IAAE,wBAAF,EAA4B,IAA5B,CAAiC,EAAjC,EAnEiD;AAoEjD,MAAI,cAAc,SAAS,QAAQ,WAAR,EAAqB,OAArB,CAA6B,aAA7B,EAA4C,KAA5C,EAAmD,EAA5D,CAAd,CApE6C;AAqEjD,MAAI,QAAQ,YAAY,MAAZ,CArEqC;AAsEjD,MAAI,QAAQ,CAAR,CAtE6C;AAuEjD,MAAI,MAAM,KAAN,CAvE6C;;AAyEjD,MAAI,WAAJ,EAAiB;AAChB,OAAI,cAAc,EAAE,kBAAF,CAAd,CADY;AAEhB,OAAI,OAAO,YAAY,IAAZ,CAAiB,MAAjB,CAAP,CAFY;AAGhB,OAAI,QAAQ,KAAK,IAAL,CAAU,QAAQ,WAAR,CAAlB,CAHY;AAIhB,UAAO,KAAK,GAAL,CAAS,IAAT,EAAe,KAAf,CAAP,CAJgB;AAKhB,UAAO,KAAK,GAAL,CAAS,IAAT,EAAe,CAAf,CAAP,CALgB;AAMhB,eAAY,IAAZ,CAAiB,MAAjB,EAAyB,IAAzB,EAA+B,IAA/B,CAAoC,WAApC,EAAiD,KAAjD,EANgB;AAOhB,eAAY,IAAZ,CAAiB,kBAAjB,EAAqC,IAArC,CAA0C,OAAO,MAAP,GAAgB,KAAhB,CAA1C,CAPgB;AAQhB,WAAQ,eAAe,OAAO,CAAP,CAAf,CARQ;AAShB,SAAM,KAAK,GAAL,CAAS,KAAT,EAAgB,cAAc,IAAd,CAAtB,CATgB;GAAjB;;AAYA,OAAK,IAAI,YAAY,KAAZ,EAAmB,YAAY,GAAZ,EAAiB,WAA7C,EAA0D;AACzD,OAAI,WAAW,YAAY,SAAZ,CAAX,CADqD;AAEzD,OAAI,UAAU,OAAQ,OAAO,IAAP,CAAY,QAAZ,EAAsB,GAAtB,KAA8B,WAArC,GAAoD,EAArD,GAA0D,OAAO,IAAP,CAAY,QAAZ,EAAsB,GAAtB,CAFf;AAGzD,OAAI,YAAY,OAAQ,OAAO,IAAP,CAAY,QAAZ,EAAsB,KAAtB,KAAgC,WAAvC,GAAsD,CAAvD,GAA2D,OAAO,IAAP,CAAY,QAAZ,EAAsB,KAAtB,CAHlB;AAIzD,OAAI,YAAY,OAAQ,OAAO,IAAP,CAAY,QAAZ,EAAsB,KAAtB,KAAgC,WAAvC,GAAsD,EAAvD,GAA4D,OAAO,IAAP,CAAY,QAAZ,EAAsB,KAAtB,CAJnB;AAKzD,OAAI,aAAa,OAAQ,OAAO,IAAP,CAAY,QAAZ,EAAsB,MAAtB,KAAiC,WAAxC,GAAuD,IAAxD,GAA+D,KAA/D,CALwC;;AAOzD,OAAI,cAAc,SAAS,aAAT,CAAuB,GAAvB,CAAd,CAPqD;AAQzD,OAAI,YAAY,EAAZ,EAAgB;;AAEnB,gBAAY,YAAZ,CAAyB,OAAzB,EAAkC,6BAAlC,EAFmB;IAApB,MAGO;AACN,gBAAY,YAAZ,CAAyB,OAAzB,EAAkC,oBAAlC,EADM;IAHP;AAMA,KAAE,WAAF,EAAe,IAAf,CAAoB,OAApB,EAdyD;AAezD,OAAI,SAAJ,EAAe;AACd,QAAI,UAAU,SAAC,KAAc,MAAd,GAAwB,aAAzB,GAAyC,SAAzC,CADA;AAEd,gBAAY,YAAZ,CAAyB,OAAzB,EAAkC,uBAAuB,OAAvB,GAAiC,WAAjC,GAA+C,iBAAiB,SAAjB,CAA/C,GAA6E,cAA7E,CAAlC,CAFc;IAAf;AAIA,eAAY,YAAZ,CAAyB,UAAzB,EAAqC,QAArC,EAnByD;AAoBzD,eAAY,YAAZ,CAAyB,OAAzB,EAAkC,WAAlC,EApByD;AAqBzD,eAAY,YAAZ,CAAyB,MAAzB,EAAiC,mBAAjC;AArByD,cAsBzD,CAAY,gBAAZ,CAA6B,OAA7B,EAAsC,UAAS,CAAT,EAAY;AACjD,MAAE,cAAF,GADiD;AAEjD,sBAAkB,EAAE,MAAF,EAAU,KAAK,YAAL,CAAkB,UAAlB,CAA5B,EAFiD;IAAZ,EAGnC,IAHH,EAtByD;;AA2BzD,KAAE,wBAAF,EAA4B,MAA5B,CAAmC,2CAA2C,QAA3C,GAAsD,IAAtD,GAA6D,QAA7D,GAAwE,8EAAxE,GAAyJ,QAAzJ,GAAoK,4BAApK,GAAmM,SAAnM,GAA+M,wBAA/M,GAA0O,SAA1O,GAAsP,IAAtP,GAA6P,UAA7P,GAA0Q,+BAA1Q,GAA4S,SAA5S,GAAwT,IAAxT,GAA+T,SAA/T,GAA2U,kBAA3U,GAAgW,SAAhW,GAA4W,YAA5W,CAAnC,CA3ByD;AA4BzD,KAAE,UAAU,SAAV,CAAF,CAAuB,MAAvB,CAA8B,WAA9B,EA5ByD;GAA1D;AA8BA,IAAE,oCAAF,EAAwC,KAAxC,CAA8C,UAAS,CAAT,EAAY;AACzD,OAAI,WAAW,EAAE,IAAF,EAAQ,IAAR,CAAa,MAAb,EAAqB,WAArB,EAAX,CADqD;AAEzD,OAAI,SAAS,EAAE,IAAF,CAAT,CAFqD;AAGzD,SAAM,uDAAuD,QAAvD,GAAkE,GAAlE,EACL,UAAS,CAAT,EAAW;AACV,WAAO,OAAO,IAAP,CAAY,QAAZ,CAAP,CADU;AAEV,eAAW,OAAX,CAAmB,4BAAnB,EAAiD,KAAK,SAAL,CAAe,OAAO,IAAP,CAAhE,EAFU;AAGV,WAAO,OAAP,CAAe,IAAf,EAAqB,MAArB,GAHU;IAAX,CADD,CAHyD;GAAZ,CAA9C,CAnHiD;EAAlD;;AAgIA,UAAS,WAAT,GAAuB;AACtB,MAAI,WAAW,SAAS,cAAT,CAAwB,gBAAxB,EAA0C,KAA1C,CADO;AAEtB,MAAI,UAAU,SAAS,cAAT,CAAwB,eAAxB,EAAyC,KAAzC,CAFQ;AAGtB,MAAI,YAAY,SAAS,cAAT,CAAwB,iBAAxB,EAA2C,KAA3C,CAHM;AAItB,MAAI,aAAa,SAAS,cAAT,CAAwB,kBAAxB,EAA4C,OAA5C,CAJK;AAKtB,MAAI,WAAW,SAAS,cAAT,CAAwB,gBAAxB,EAA0C,KAA1C,CALO;AAMtB,MAAI,YAAY,SAAS,SAAS,cAAT,CAAwB,sBAAxB,EAAgD,KAAhD,EAAuD,EAAhE,CAAZ,CANkB;AAOtB,MAAI,MAAM,SAAN,CAAJ,EAAsB;AACrB,eAAY,CAAZ,CADqB;GAAtB;AAGA,aAAW,QAAX,EAAqB,OAArB,EAA8B,SAA9B,EAAyC,UAAzC,EAAqD,QAArD,EAA+D,SAA/D,EAVsB;EAAvB;;AAaA,KAAI,mBAAmB;AACtB,UAAQ,SAAR;AACA,UAAQ,OAAR;AACA,WAAS,OAAT;AACA,UAAQ,OAAR;AACA,aAAW,OAAX;AACA,UAAQ,OAAR;AACA,UAAQ,OAAR;AACA,WAAS,OAAT;AACA,UAAQ,OAAR;AACA,YAAU,OAAV;AACA,UAAQ,OAAR;AACA,WAAS,OAAT;AACA,YAAU,OAAV;AACA,YAAU,OAAV;AACA,SAAO,QAAP;AACA,YAAU,OAAV;AACA,UAAQ,OAAR;AACA,WAAS,OAAT;AACA,YAAU,OAAV;EAnBG,CA3e8C;;AAigBlD,KAAI,UAAJ,CAjgBkD;;AAmgBlD,UAAS,iBAAT,CAA2B,GAA3B,EAAgC,QAAhC,EAA0C;AACzC,MAAI,SAAS,SAAS,QAAT,CAAkB,GAAlB,CAAT,CADqC;AAEzC,aAAW,SAAS,WAAT,EAAX,CAFyC;AAGzC,eAAa,GAAb,CAHyC;AAIzC,MAAI,SAAS,SAAS,aAAT,CAAuB,uBAAvB,CAAT,CAJqC;AAKzC,SAAO,WAAP,GAAqB,SAAS,QAAT,CALoB;AAMzC,WAAS,cAAT,CAAwB,gBAAxB,EAA0C,KAA1C,GAAkD,QAAlD,CANyC;AAOzC,MAAI,OAAO,OAAO,IAAP,CAAY,QAAZ,CAAP,KAAiC,WAAjC,EAA8C;AACjD,OAAI,OAAO,OAAO,IAAP,CAAY,QAAZ,EAAsB,IAAtB,KAA+B,WAAtC,EAAmD;AACtD,aAAS,cAAT,CAAwB,gBAAxB,EAA0C,KAA1C,GAAkD,OAAO,IAAP,CAAY,QAAZ,EAAsB,IAAtB,CADI;IAAvD,MAEO;AACN,aAAS,cAAT,CAAwB,gBAAxB,EAA0C,KAA1C,GAAkD,EAAlD,CADM;IAFP;AAKA,OAAI,OAAO,OAAO,IAAP,CAAY,QAAZ,EAAsB,GAAtB,KAA8B,WAArC,EAAkD;AACrD,aAAS,cAAT,CAAwB,eAAxB,EAAyC,KAAzC,GAAiD,OAAO,IAAP,CAAY,QAAZ,EAAsB,GAAtB,CADI;IAAtD,MAEO;AACN,aAAS,cAAT,CAAwB,eAAxB,EAAyC,KAAzC,GAAiD,EAAjD,CADM;AAEN,QAAI,OAAO,OAAO,IAAP,CAAY,QAAZ,EAAsB,IAAtB,KAA+B,WAAtC,EAAmD;;;AAGtD,+BAA0B,GAA1B,EAHsD;KAAvD;IAJD;AAUA,OAAI,UAAU,OAAO,OAAO,IAAP,CAAY,QAAZ,EAAsB,MAAtB,KAAiC,WAAxC,GAAsD,OAAO,IAAP,CAAY,QAAZ,EAAsB,MAAtB,GAA+B,KAArF,CAhBmC;AAiBjD,YAAS,cAAT,CAAwB,kBAAxB,EAA4C,OAA5C,GAAsD,OAAtD,CAjBiD;AAkBjD,YAAS,cAAT,CAAwB,2BAAxB,EAAqD,SAArD,CAA+D,MAA/D,CAAsE,SAAtE,EAAiF,OAAjF,EAlBiD;AAmBjD,OAAI,OAAO,OAAO,IAAP,CAAY,QAAZ,EAAsB,KAAtB,KAAgC,WAAvC,EAAoD;AACvD,aAAS,cAAT,CAAwB,sBAAxB,EAAgD,KAAhD,GAAwD,OAAO,IAAP,CAAY,QAAZ,EAAsB,KAAtB,CADD;IAAxD,MAEO;AACN,aAAS,cAAT,CAAwB,sBAAxB,EAAgD,KAAhD,GAAwD,EAAxD,CADM;IAFP;AAKA,OAAI,OAAO,OAAO,IAAP,CAAY,QAAZ,EAAsB,KAAtB,KAAgC,WAAvC,EAAoD;AACvD,MAAE,kBAAF,EAAsB,GAAtB,CAA0B,OAAO,IAAP,CAAY,QAAZ,EAAsB,KAAtB,CAA1B,CADuD;IAAxD,MAEO;AACN,aAAS,cAAT,CAAwB,iBAAxB,EAA2C,aAA3C,GAA2D,CAA3D,CADM;IAFP;GAxBD,MA6BO;AACN,YAAS,cAAT,CAAwB,eAAxB,EAAyC,KAAzC,GAAiD,EAAjD,CADM;AAEN,YAAS,cAAT,CAAwB,kBAAxB,EAA4C,OAA5C,GAAsD,KAAtD,CAFM;AAGN,YAAS,cAAT,CAAwB,2BAAxB,EAAqD,SAArD,CAA+D,MAA/D,CAAsE,SAAtE,EAHM;AAIN,YAAS,cAAT,CAAwB,sBAAxB,EAAgD,KAAhD,GAAwD,EAAxD,CAJM;AAKN,YAAS,cAAT,CAAwB,gBAAxB,EAA0C,KAA1C,GAAkD,EAAlD,CALM;AAMN,OAAI,OAAO,OAAP,CAAe,eAAf,CAA+B,KAA/B,EAAsC;AACzC,8BAA0B,GAA1B,EADyC;IAA1C;AAGA,YAAS,cAAT,CAAwB,iBAAxB,EAA2C,aAA3C,GAA2D,CAA3D,CATM;GA7BP;AAwCA,oBAAkB,YAAlB,CAA+B,OAA/B,EAAwC,0BAA0B,OAAO,CAAP,GAAW,YAArC,GAAoD,OAAO,CAAP,GAAW,kBAA/D,CAAxC,CA/CyC;AAgDzC,WAAS,cAAT,CAAwB,eAAxB,EAAyC,KAAzC,GAhDyC;AAiDzC,iBAAe,SAAS,cAAT,CAAwB,gBAAxB,CAAf,EAjDyC;AAkDzC,qBAlDyC;AAmDzC,SAAO,KAAP,CAnDyC;EAA1C;;AAsDA,UAAS,yBAAT,CAAmC,GAAnC,EAAwC;AACvC,MAAI,eAAe,EAAE,GAAF,EAAO,OAAP,CAAe,QAAf,CAAf;MACH,YAAY,EAAZ,CAFsC;;AAIvC,MAAI,CAAC,OAAO,OAAP,CAAe,uBAAf,CAAuC,KAAvC,EAA8C;AAClD,eAAY,EAAE,YAAF,EAAgB,IAAhB,CAAqB,SAArB,CAAZ,CADkD;GAAnD;;AAJuC,MAQnC,CAAC,UAAU,MAAV,EAAkB;AACtB,eAAY,EAAE,YAAF,EAAgB,IAAhB,CAAqB,UAArB,CAAZ,CADsB;GAAvB;AAGA,MAAI,UAAU,MAAV,EAAkB;AACrB,YAAS,cAAT,CAAwB,gBAAxB,EAA0C,KAA1C,GAAkD,EAAE,SAAF,EAAa,IAAb,CAAkB,MAAlB,CAAlD,CADqB;GAAtB,MAEO;AACN,OAAI,YAAY,EAAE,YAAF,EAAgB,IAAhB,CAAqB,+BAArB,CAAZ,CADE;AAEN,OAAI,UAAU,MAAV,EAAkB;AACrB,aAAS,cAAT,CAAwB,gBAAxB,EAA0C,KAA1C,GAAkD,EAAE,SAAF,EAAa,IAAb,CAAkB,MAAlB,CAAlD,CADqB;IAAtB;GAJD;EAXD;;AAqBA,UAAS,gBAAT,GAA4B;AAC3B,IAAE,iBAAF,EAAqB,IAArB,CAA0B,cAAc,KAAd,CAA1B,CAD2B;AAE3B,MAAI,UAAU,gBAAgB,gBAAgB,aAAhB,CAAhB,CAA+C,KAA/C,CAFa;AAG3B,oBAAkB,KAAlB,CAAwB,eAAxB,GAA0C,OAAC,KAAY,MAAZ,GAAsB,aAAvB,GAAuC,OAAvC,CAHf;AAI3B,oBAAkB,KAAlB,CAAwB,KAAxB,GAAgC,iBAAiB,OAAjB,CAAhC,CAJ2B;EAA5B;;AAOA,UAAS,cAAT,CAAwB,cAAxB,EAAwC;AACvC,MAAI,eAAe,KAAf,EAAsB;AACzB,OAAI,eAAe,kBAAkB,aAAlB,CAAgC,qBAAhC,CAAf,CADqB;AAEzB,gBAAa,KAAb,CAAmB,OAAnB,GAA6B,QAA7B,CAFyB;AAGzB,gBAAa,oBAAb,CAAkC,GAAlC,EAAuC,CAAvC,EAA0C,IAA1C,GAAiD,eAAe,KAAf,CAAqB,KAArB,CAA2B,IAA3B,EAAiC,CAAjC,CAAjD,CAHyB;GAA1B,MAIO;AACN,qBAAkB,aAAlB,CAAgC,qBAAhC,EAAuD,KAAvD,CAA6D,OAA7D,GAAuE,MAAvE,CADM;GAJP;EADD;;AAUA,UAAS,kBAAT,GAA8B;AAC7B,oBAAkB,YAAlB,CAA+B,OAA/B,EAAwC,eAAxC,EAD6B;AAE7B,MAAI,QAAQ,aAAR,EAAuB,SAAvB,EAAJ,EAAwC;AACvC,OAAI,SAAS,kBAAkB,gBAAlB,CAAmC,eAAnC,CAAT;;AADmC,QAGvC,CAAM,SAAN,CAAgB,KAAhB,CAAsB,IAAtB,CAA2B,MAA3B,EAAmC,OAAnC,CAA2C,UAAS,KAAT,EAAgB;AAC1D,UAAM,IAAN,GAD0D;IAAhB,CAA3C,CAHuC;GAAxC;EAFD;;AAWA,UAAS,UAAT,CAAoB,QAApB,EAA8B,GAA9B,EAAmC,KAAnC,EAA0C,MAA1C,EAAkD,IAAlD,EAAwD,KAAxD,EAA+D,OAA/D,EAAwE;AACvE,aAAW,SAAS,WAAT,EAAX,CADuE;AAEvE,MAAI,GAAE,KAAQ,IAAR,IAAkB,QAAQ,EAAR,IAAiB,MAArC,EAA8C;AACjD,OAAI,QAAQ,EAAR,EAAY;AACf,UAAM,SAAN,CADe;IAAhB;AAGA,OAAI,OAAO,OAAO,IAAP,CAAY,QAAZ,CAAP,KAAiC,WAAjC,EAA8C;AACjD,WAAO,IAAP,CAAY,QAAZ,IAAwB,EAAxB,CADiD;IAAlD;AAGA,UAAO,IAAP,CAAY,QAAZ,EAAsB,GAAtB,GAA4B,GAA5B,CAPiD;AAQjD,UAAO,IAAP,CAAY,QAAZ,EAAsB,IAAtB,GAA6B,IAA7B,CARiD;AASjD,UAAO,IAAP,CAAY,QAAZ,EAAsB,KAAtB,GAA8B,KAA9B,CATiD;AAUjD,OAAI,UAAU,KAAC,KAAU,MAAV,GAAoB,aAArB,GAAqC,KAArC,CAVmC;AAWjD,OAAI,MAAJ,EAAY;AACX,WAAO,IAAP,CAAY,QAAZ,EAAsB,MAAtB,GAA+B,IAA/B,CADW;IAAZ,MAEO;AACN,WAAO,OAAO,IAAP,CAAY,QAAZ,EAAsB,MAAtB,CADD;IAFP;AAKA,OAAI,CAAC,OAAD,EAAU;AACb,eAAW,YAAX,CAAwB,OAAxB,EAAiC,oBAAjC,EADa;AAEb,eAAW,YAAX,CAAwB,OAAxB,EAAiC,uBAAuB,OAAvB,GAAiC,WAAjC,GAA+C,iBAAiB,KAAjB,CAA/C,GAAyE,cAAzE,CAAjC,CAFa;AAGb,MAAE,UAAF,EAAc,IAAd,CAAmB,GAAnB,EAHa;IAAd;GAhBD,MAqBO;AACN,OAAI,OAAO,OAAO,IAAP,CAAY,QAAZ,CAAP,KAAiC,WAAjC,EAA8C;AACjD,WAAO,OAAO,IAAP,CAAY,QAAZ,EAAsB,GAAtB,CAD0C;AAEjD,WAAO,OAAO,IAAP,CAAY,QAAZ,EAAsB,KAAtB,CAF0C;AAGjD,WAAO,OAAO,IAAP,CAAY,QAAZ,EAAsB,IAAtB,CAH0C;AAIjD,QAAI,OAAO,IAAP,CAAY,QAAZ,EAAsB,GAAtB,KAA8B,SAA9B,EAAyC;AAC5C,YAAO,OAAO,IAAP,CAAY,QAAZ,EAAsB,GAAtB,CADqC;KAA7C;AAGA,WAAO,OAAO,IAAP,CAAY,QAAZ,EAAsB,MAAtB,CAP0C;IAAlD;AASA,OAAI,CAAC,OAAD,EAAU;AACb,eAAW,YAAX,CAAwB,OAAxB,EAAiC,+BAAjC,EADa;AAEb,eAAW,YAAX,CAAwB,OAAxB,EAAiC,6BAAjC,EAFa;AAGb,MAAE,UAAF,EAAc,IAAd,CAAmB,EAAnB,EAHa;IAAd;GA/BD;;AAsCA,MAAI,OAAO,OAAO,IAAP,CAAY,QAAZ,CAAP,KAAiC,WAAjC,EAA8C;AACjD,UAAO,IAAP,CAAY,QAAZ,EAAsB,KAAtB,GAA8B,KAAC,CAAM,KAAN,CAAD,GAAiB,CAAjB,GAAqB,KAArB,CADmB;GAAlD;AAGA,MAAI,CAAC,OAAD,EAAU;AACb,OAAI,SAAS,WAAW,UAAX,CAAsB,UAAtB,CAAiC,aAAjC,CAA+C,cAA/C,CAAT,CADS;AAEb,OAAI,MAAJ,EAAY;AACX,cAAU,MAAV,EAAkB,QAAlB,EAA4B,KAA5B,EADW;IAAZ;GAFD;AAMA,MAAI,SAAS,OAAT,CAAiB,OAAO,IAAP,CAAY,QAAZ,CAAjB,CAAJ,EAA6C;AAC5C,UAAO,OAAO,IAAP,CAAY,QAAZ,CAAP,CAD4C;GAA7C;AAGA,aAAW,OAAX,CAAmB,4BAAnB,EAAiD,KAAK,SAAL,CAAe,OAAO,IAAP,CAAhE,EApDuE;AAqDvE,uBArDuE;EAAxE;;AAwDA,QAAO,gBAAP,GAA0B,gTAA1B,CAlqBkD;;AAoqBlD,UAAS,SAAT,CAAmB,GAAnB,EAAwB;AACvB,QAAM,OAAO,QAAP,CADiB;AAEvB,MAAI,UAAU,IAAI,gBAAJ,CAAqB,OAAO,gBAAP,CAA/B,CAFmB;AAGvB,WAAS,cAAT,CAAwB,OAAxB,EAAiC,EAAjC,EAAqC,IAArC,EAA2C,UAAS,YAAT,EAAuB,KAAvB,EAA8B,KAA9B,EAAqC;AAC/E,UAAO,gBAAP,CAAwB,YAAxB,EAD+E;GAArC,CAA3C,CAHuB;EAAxB;;AAQA,QAAO,gBAAP,GAA0B,UAAS,aAAT,EAAwB,MAAxB,EAAgC;AACzD,MAAI,aAAa,EAAb;MACH,YAAY,CAAZ;MACA,UAAU,IAAV;MACA,YAAY,IAAZ;MACA,aAAa,IAAb;MACA,UALD;MAKa,QALb;MAKuB,WALvB;MAKoC,IALpC;MAK0C,KAL1C,CADyD;;AAQzD,MAAI,iBAAoB,CAAE,cAAc,SAAd,CAAwB,QAAxB,CAAiC,YAAjC,CAAF,IAAuD,OAAO,aAAP,KAAyB,WAAzB,IAA0C,kBAAkB,IAAlB,EAAyB;AACjJ,OAAI,cAAc,IAAd,EAAoB;AACvB,WAAO,cAAc,IAAd,CAAmB,KAAnB,CAAyB,OAAO,UAAP,CAAhC,CADuB;AAEvB,QAAI,IAAJ,EAAU;AACT,kBAAa,KAAK,CAAL,CAAb,CADS;KAAV;IAFD,MAKO,IAAI,cAAc,YAAd,CAA2B,WAA3B,CAAJ,EAA6C;AACnD,iBAAa,cAAc,YAAd,CAA2B,WAA3B,CAAb,CADmD;IAA7C;;AAN0I,QAUjJ,GAAQ,KAAR,CAViJ;AAWjJ,OAAI,cAAiB,WAAW,MAAX,CAAkB,CAAlB,EAAqB,CAArB,MAA4B,KAA5B,EAAoC;AACxD,YAAQ,IAAR,CADwD;AAExD,iBAAa,WAAW,MAAX,CAAkB,CAAlB,CAAb,CAFwD;IAAzD;AAIA,gBAAa,WAAW,WAAX,EAAb,CAfiJ;AAgBjJ,OAAI,CAAC,KAAD,EAAQ;AACX,kBAAc,SAAd,CAAwB,GAAxB,CAA4B,YAA5B,EADW;AAEX,QAAI,OAAO,WAAW,UAAX,CAAP,KAAkC,WAAlC,EAA+C;AAClD,SAAI,OAAO,IAAP,IAAe,OAAO,IAAP,CAAY,UAAZ,CAAf,EAAwC;AAC3C,UAAI,OAAO,OAAO,IAAP,CAAY,UAAZ,EAAwB,KAAxB,KAAkC,WAAzC,EAAsD;AACzD,mBAAY,SAAS,OAAO,IAAP,CAAY,UAAZ,EAAwB,KAAxB,EAA+B,EAAxC,CAAZ,CADyD;OAA1D;AAGA,UAAI,OAAO,OAAO,IAAP,CAAY,UAAZ,EAAwB,GAAxB,KAAgC,WAAvC,EAAoD;AACvD,iBAAU,OAAO,IAAP,CAAY,UAAZ,EAAwB,GAAxB,CAD6C;OAAxD;AAGA,UAAI,OAAO,OAAO,IAAP,CAAY,UAAZ,EAAwB,KAAxB,KAAkC,WAAzC,EAAsD;AACzD,mBAAY,OAAO,IAAP,CAAY,UAAZ,EAAwB,KAAxB,CAD6C;OAA1D;AAGA,UAAI,OAAO,OAAO,IAAP,CAAY,UAAZ,EAAwB,MAAxB,KAAmC,WAA1C,EAAuD;AAC1D,oBAAa,OAAO,IAAP,CAAY,UAAZ,EAAwB,MAAxB,CAD6C;OAA3D;MAVD;AAcA,gBAAW,UAAX,IAAyB;AACxB,WAAK,OAAL;AACA,aAAO,SAAP;AACA,cAAQ,UAAR;AACA,aAAO,SAAP;MAJD,CAfkD;KAAnD;;AAuBA,QAAI,cAAc,SAAS,sBAAT,EAAd,CAzBO;;AA2BX,QAAI,WAAW,OAAO,MAAP,KAAkB,WAAlB,IAAiC,CAAC,MAAD,EAAS;AACxD,SAAI,cAAc,SAAS,aAAT,CAAuB,GAAvB,CAAd,CADoD;AAExD,SAAI,CAAC,OAAD,EAAU;AACb,gBAAU,EAAV,CADa;AAEb,kBAAY,YAAZ,CAAyB,OAAzB,EAAkC,6BAAlC,EAFa;MAAd,MAGO;AACN,kBAAY,YAAZ,CAAyB,OAAzB,EAAkC,oBAAlC,EADM;MAHP;AAMA,OAAE,WAAF,EAAe,IAAf,CAAoB,OAApB,EARwD;AASxD,SAAI,SAAJ,EAAe;AACd,UAAI,UAAU,SAAC,KAAc,MAAd,GAAwB,aAAzB,GAAyC,SAAzC,CADA;AAEd,kBAAY,YAAZ,CAAyB,OAAzB,EAAkC,uBAAuB,OAAvB,GAAiC,WAAjC,GAA+C,iBAAiB,SAAjB,CAA/C,GAA6E,cAA7E,CAAlC,CAFc;MAAf;AAIA,SAAI,OAAO,MAAP,KAAkB,WAAlB,IAAiC,CAAC,MAAD,EAAS;AAC7C,kBAAY,YAAZ,CAAyB,UAAzB,EAAqC,UAArC,EAD6C;AAE7C,kBAAY,YAAZ,CAAyB,OAAzB,EAAkC,WAAlC,EAF6C;AAG7C,kBAAY,YAAZ,CAAyB,MAAzB,EAAiC,mBAAjC;AAH6C,iBAI7C,CAAY,gBAAZ,CAA6B,OAA7B,EAAsC,UAAS,CAAT,EAAY;AACjD,SAAE,cAAF,GADiD;AAEjD,yBAAkB,EAAE,MAAF,EAAU,KAAK,YAAL,CAAkB,UAAlB,CAA5B,EAFiD;OAAZ,EAGnC,IAHH,EAJ6C;MAA9C;AASA,SAAI,UAAU,SAAS,aAAT,CAAuB,MAAvB,CAAV,CAtBoD;AAuBxD,aAAQ,SAAR,CAAkB,GAAlB,CAAsB,YAAtB;;;AAvBwD,YA0BxD,CAAQ,WAAR,CAAoB,WAApB;;AA1BwD,gBA4BxD,CAAY,WAAZ,CAAwB,OAAxB;;AA5BwD,SA8BpD,OAAO,MAAP,KAAkB,WAAlB,IAAiC,CAAC,MAAD,EAAS;AAC7C,UAAI,OAAO,OAAP,CAAe,SAAf,CAAyB,KAAzB,EAAgC;AACnC,WAAI,eAAe,SAAS,sBAAT,EAAf,CAD+B;AAEnC,WAAI,SAAS,SAAS,cAAT,CAAwB,GAAxB,CAAT,CAF+B;AAGnC,oBAAa,WAAb,CAAyB,MAAzB,EAHmC;AAInC,WAAI,iBAAiB,SAAS,aAAT,CAAuB,GAAvB,CAAjB,CAJ+B;AAKnC,sBAAe,YAAf,CAA4B,MAA5B,EAAoC,GAApC,EALmC;AAMnC,sBAAe,YAAf,CAA4B,OAA5B,EAAqC,YAArC,EANmC;AAOnC,SAAE,cAAF,EAAkB,IAAlB,CAAuB,MAAvB,EAPmC;AAQnC,sBAAe,gBAAf,CAAgC,OAAhC,EAAyC,UAAS,CAAT,EAAY;AACpD,UAAE,cAAF,GADoD;AAEpD,YAAI,SAAS,KAAK,UAAL,CAAgB,aAAhB,CAA8B,cAA9B,CAAT,CAFgD;AAGpD,0BAAkB,MAAlB,EAA0B,OAAO,YAAP,CAAoB,UAApB,CAA1B,EAHoD;QAAZ,EAItC,IAJH,EARmC;AAanC,iBAAU,cAAV,EAA0B,UAA1B,EAAsC,WAAW,UAAX,EAAuB,KAAvB,CAAtC,CAbmC;AAcnC,oBAAa,WAAb,CAAyB,cAAzB,EAdmC;AAenC,mBAAY,WAAZ,CAAwB,YAAxB,EAfmC;OAApC;MADD;AAmBA,cAAS,WAAT,CAAqB,aAArB,EAAoC,WAApC,EAjDwD;AAkDxD,SAAI,OAAO,MAAP,KAAkB,WAAlB,IAAiC,CAAC,MAAD,EAAS;AAC7C,mBAAa,WAAW,UAAX,EAAuB,MAAvB,IAAiC,cAAc,SAAd,CAAwB,QAAxB,CAAiC,QAAjC,CAAjC,CADgC;AAE7C,UAAI,cAAe,SAAS,QAAT,OAAwB,SAAxB,EAAoC;AACtD,WAAI,OAAO,OAAP,CAAe,UAAf,CAA0B,KAA1B,EAAiC;AACpC,YAAI,SAAS,QAAT,OAAwB,UAAxB,EAAoC;AACvC,uBAAc,cAAc,aAAd,EAA6B,UAA7B,CAAd,CADuC;AAEvC,aAAI,WAAJ,EAAiB;;AAEhB,cAAI,SAAS,YAAY,UAAZ,CAAuB,aAAvB,CAAqC,UAArC,CAAT,CAFY;AAGhB,mBAAS,KAAT,CAAe,MAAf,EAHgB;UAAjB;SAFD,MAOO;AACN,oBAAW,EAAE,aAAF,EAAiB,OAAjB,CAAyB,QAAzB,EAAmC,GAAnC,CAAuC,CAAvC,CAAX,CADM;;AAGN,aAAI,QAAJ,EAAc;;AAEb,mBAAS,KAAT,CAAe,OAAf,GAAyB,MAAzB;;AAFa,cAIT,SAAS,eAAT,EAA0B;AAC7B,oBAAS,eAAT,CAAyB,KAAzB,CAA+B,OAA/B,GAAyC,MAAzC,CAD6B;WAA9B;UAJD;SAVD;QADD,MAoBO;AACN,YAAI,SAAS,QAAT,OAAwB,UAAxB,EAAoC;;AAEvC,uBAAc,aAAd,EAA6B,UAA7B,EAFuC;SAAxC,MAGO;AACN,aAAI,SAAJ,EAAe,YAAf,CADM;AAEN,aAAI,SAAS,QAAT,OAAwB,OAAxB,EAAiC;AACpC,yBAAe,EAAE,aAAF,EAAiB,OAAjB,CAAyB,QAAzB,CAAf,CADoC;AAEpC,sBAAY,aAAa,IAAb,CAAkB,KAAlB,CAAZ;;;AAFoC,cAKhC,CAAC,aAAa,EAAb,CAAgB,cAAhB,CAAD,EAAkC;AACrC,wBAAa,IAAb,CAAkB,UAAlB,EAA8B,IAA9B,CAAmC,iBAAnC,EADqC;WAAtC;UALD,MAQO;AACN,sBAAY,EAAE,aAAF,EAAiB,OAAjB,CAAyB,QAAzB,EAAmC,IAAnC,CAAwC,SAAxC,CAAZ,CADM;UARP;AAWA,oBAAW,UAAU,CAAV,CAAX,CAbM;;AAeN,aAAI,QAAJ,EAAc;AACb,cAAI,WAAW,SAAS,aAAT,CAAuB,GAAvB,CAAX,CADS;AAEb,mBAAS,WAAT,GAAuB,cAAvB,CAFa;AAGb,mBAAS,YAAT,CAAsB,MAAtB,EAA8B,GAA9B,EAHa;AAIb,mBAAS,gBAAT,CAA0B,OAA1B,EAAmC,UAAS,CAAT,EAAY;AAC9C,aAAE,IAAF,EAAQ,MAAR,GAAiB,IAAjB,CAAsB,EAAE,IAAF,EAAQ,MAAR,GAAiB,IAAjB,CAAsB,eAAtB,CAAtB,EAA8D,WAA9D,CAA0E,iBAA1E,EAA6F,QAA7F,CAAsG,IAAtG,EAD8C;AAE9C,aAAE,cAAF,GAF8C;WAAZ,CAAnC,CAJa;AAQb,mBAAS,YAAT,CAAsB,eAAtB,EAAuC,SAAS,SAAT,CAAvC,CARa;AASb,mBAAS,WAAT,GAAuB,aAAa,uBAAb,CATV;AAUb,mBAAS,WAAT,CAAqB,QAArB,EAVa;;AAYb,mBAAS,YAAT,CAAsB,OAAtB,EAA+B,iBAA/B,EAZa;UAAd;SAlBD;QArBD;OADD;MAFD;KAlDD;IA3BD;GAhBD;EARyB,CA5qBwB;;AAk1BlD,UAAS,aAAT,CAAuB,aAAvB,EAAsC,UAAtC,EAAiD;AAChD,MAAI,cAAc,cAAc,UAAd,CAAyB,UAAzB,CAAoC,aAApC,CAAkD,WAAlD,CAAd,CAD4C;AAEhD,MAAI,WAAJ,EAAiB;AAChB,OAAI,WAAW,SAAS,aAAT,CAAuB,GAAvB,CAAX,CADY;AAEhB,YAAS,WAAT,GAAuB,cAAvB,CAFgB;AAGhB,YAAS,YAAT,CAAsB,MAAtB,EAA8B,GAA9B,EAHgB;AAIhB,YAAS,gBAAT,CAA0B,OAA1B,EAAmC,UAAS,CAAT,EAAY;AAC9C,MAAE,IAAF,EAAQ,MAAR,GAAiB,IAAjB,CAAsB,EAAE,IAAF,EAAQ,MAAR,GAAiB,IAAjB,CAAsB,eAAtB,CAAtB,EAA8D,WAA9D,CAA0E,oBAA1E,EAD8C;AAE9C,MAAE,cAAF,GAF8C;IAAZ,CAAnC;;AAJgB,cAShB,CAAY,YAAZ,CAAyB,eAAzB,EAA0C,YAAY,SAAZ,CAA1C;;AATgB,cAWhB,CAAY,WAAZ,GAA0B,aAAa,sBAAb,CAXV;AAYhB,eAAY,WAAZ,CAAwB,QAAxB,EAZgB;AAahB,eAAY,SAAZ,CAAsB,GAAtB,CAA0B,oBAA1B,EAbgB;AAchB,UAAO,WAAP,CAdgB;GAAjB;AAgBA,SAAO,KAAP,CAlBgD;EAAjD;;AAqBA,UAAS,SAAT,CAAmB,GAAnB,EAAwB,MAAxB,EAAgC,KAAhC,EAAuC;AACtC,MAAI,OAAO,OAAP,CAAe,SAAf,CAAyB,KAAzB,EAAgC;AACnC,WAAQ,SAAS,KAAT,EAAgB,EAAhB,CAAR,CADmC;AAEnC,OAAI,MAAM,GAAN,CAF+B;AAGnC,OAAI,QAAQ,GAAR,CAH+B;AAInC,OAAI,OAAO,GAAP,CAJ+B;AAKnC,OAAI,aAAa,GAAb,CAL+B;AAMnC,OAAI,QAAQ,CAAR,EAAW;AACd,UAAM,KAAK,GAAL,CAAS,CAAT,EAAa,MAAO,IAAI,KAAJ,CAA1B,CADc;AAEd,YAAQ,GAAR,CAFc;AAGd,WAAO,KAAK,GAAL,CAAS,CAAT,EAAa,MAAO,IAAI,KAAJ,CAA3B,CAHc;IAAf,MAIO,IAAI,QAAQ,CAAR,EAAW;AACrB,UAAM,GAAN,CADqB;AAErB,YAAQ,KAAK,GAAL,CAAS,CAAT,EAAa,MAAM,KAAK,GAAL,CAAS,IAAI,KAAJ,CAAf,CAArB,CAFqB;AAGrB,WAAO,KAAK,GAAL,CAAS,CAAT,EAAa,MAAM,KAAK,GAAL,CAAS,IAAI,KAAJ,CAAf,CAApB,CAHqB;AAIrB,iBAAa,EAAb,CAJqB;IAAf;AAMP,iBAAc,KAAd,CAhBmC;AAiBnC,OAAI,MAAM,SAAS,GAAT,GAAe,GAAf,GAAqB,KAArB,GAA6B,GAA7B,GAAmC,IAAnC,GAA0C,GAA1C,CAjByB;AAkBnC,OAAI,QAAQ,IAAR,EAAc;AACjB,QAAI,UAAU,CAAV,EAAa;AAChB,SAAI,KAAJ,CAAU,OAAV,GAAoB,MAApB,CADgB;KAAjB,MAEO;AACN,SAAI,KAAJ,CAAU,OAAV,GAAoB,QAApB,CADM;AAEN,SAAI,QAAQ,WAAR,EAAqB,aAArB,EAAJ,EAA0C;AACzC,UAAI,KAAJ,CAAU,KAAV,GAAkB,GAAlB,CADyC;MAA1C,MAEO;AACN,UAAI,KAAJ,CAAU,eAAV,GAA4B,GAA5B,CADM;MAFP;AAKA,SAAI,OAAO,OAAP,CAAe,QAAf,CAAwB,KAAxB,EAA+B;AAClC,UAAI,WAAJ,GAAkB,MAAM,UAAN,GAAmB,GAAnB,CADgB;MAAnC;AAGA,SAAI,OAAO,OAAP,CAAe,SAAf,CAAyB,KAAzB,EAAgC;AACnC,UAAI,YAAJ,CAAiB,OAAjB,EAA0B,oBAAoB,WAAW,MAAX,CAApB,GAAyC,IAAzC,GAAgD,WAAW,UAAX,CAAhD,CAA1B,CADmC;MAApC;KAZD;IADD;GAlBD;EADD;;AAwCA,QAAO,UAAP,GAAoB,UAAS,QAAT,EAAmB,MAAnB,EAA2B;AAC9C,MAAI,WAAW,SAAS,WAAT,EAAX;MACH,aAAa,WAAW,KAAX;MACb,SAFD;MAEY,QAFZ;MAEsB,SAFtB;MAEiC,OAFjC,CAD8C;AAI9C,MAAI,OAAO,IAAP,IAAe,OAAO,IAAP,CAAY,QAAZ,CAAf,EAAsC;AACzC,eAAY,OAAO,IAAP,CAAY,QAAZ,EAAsB,KAAtB,IAA+B,EAA/B,CAD6B;AAEzC,cAAW,OAAO,IAAP,CAAY,QAAZ,EAAsB,IAAtB,IAA8B,EAA9B,CAF8B;AAGzC,eAAY,OAAO,IAAP,CAAY,QAAZ,EAAsB,KAAtB,IAA+B,CAA/B,CAH6B;AAIzC,aAAU,OAAO,IAAP,CAAY,QAAZ,EAAsB,GAAtB,IAA6B,EAA7B,CAJ+B;GAA1C;AAMA,MAAI,cAAiB,YAAY,EAAZ,EAAiB;AACrC,aAAU,SAAV,CADqC;GAAtC,MAEO,IAAI,CAAE,UAAD,IAAiB,YAAY,SAAZ,EAAwB;AACpD,aAAU,EAAV,CADoD;GAA9C;AAGP,aAAW,QAAX,EAAqB,OAArB,EAA8B,SAA9B,EAAyC,UAAzC,EAAqD,QAArD,EAA+D,SAA/D,EAA0E,gBAA1E,EAf8C;EAA3B,CA/4B8B;CAA3B,CAAxB","file":"modules/userTagger.js","sourcesContent":["addModule('userTagger', function(module, moduleID) {\r\n\tmodule.moduleName = 'User Tagger';\r\n\tmodule.category = 'Users';\r\n\tmodule.description = 'Adds a great deal of customization around users - tagging them, ignoring them, and more. You can manage tagged users on <a href=\"/r/Dashboard/#userTaggerContents\">Manage User Tags</a>.';\r\n\tmodule.options = {\r\n\t\t/*\r\n\t\tdefaultMark: {\r\n\t\t\ttype: 'text',\r\n\t\t\tvalue: '_',\r\n\t\t\tdescription: 'clickable mark for users with no tag'\r\n\t\t},\r\n\t\t*/\r\n\t\thardIgnore: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'When \"hard ignore\" is off, only post titles and comment text is hidden. When it is on, the entire post is hidden (or for comments, collapsed).'\r\n\t\t},\r\n\t\tcolorUser: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Color users based on cumulative upvotes / downvotes',\r\n\t\t\tadvanced: true\r\n\t\t},\r\n\t\tstoreSourceLink: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'By default, store a link to the link/comment you tagged a user on',\r\n\t\t\tadvanced: true\r\n\t\t},\r\n\t\tuseCommentsLinkAsSource: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'By default, store a link to the comments when tagging a user in a link post. Otherwise, the link (that the post refers to) will be used.',\r\n\t\t\tadvanced: true\r\n\t\t},\r\n\t\tvwNumber: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Show the number (i.e. [+6]) rather than [vw]',\r\n\t\t\tadvanced: true\r\n\t\t},\r\n\t\tvwTooltip: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Show the vote weight tooltip on hover (i.e. \"your votes for...\")',\r\n\t\t\tadvanced: true\r\n\t\t}\r\n\t};\r\n\r\n\tmodule.usernameRE = /(?:u|user)\\/([\\w\\-]+)/;\r\n\tvar userTaggerToolTip, userTaggerTag, userTaggerColor, userTaggerPreview, userTaggerForm;\r\n\r\n\tmodule.go = function() {\r\n\t\tif ((this.isEnabled()) && (this.isMatchURL())) {\r\n\t\t\t// Get user tag data...\r\n\t\t\tthis.tags = safeJSON.parse(RESStorage.getItem('RESmodules.userTagger.tags'), 'RESmodules.userTagger.tags', true) || {};\r\n\r\n\t\t\t// If we're on the dashboard, add a tab to it...\r\n\t\t\tif (RESUtils.currentSubreddit('dashboard')) {\r\n\t\t\t\t// add tab to dashboard\r\n\t\t\t\tmodules['dashboard'].addTab('userTaggerContents', 'My User Tags');\r\n\t\t\t\t// populate the contents of the tab\r\n\t\t\t\tvar showDiv = $('<div class=\"show\">Show </div>');\r\n\t\t\t\tvar tagFilter = $('<select id=\"tagFilter\"><option>tagged users</option><option>all users</option></select>');\r\n\t\t\t\t$(showDiv).append(tagFilter);\r\n\t\t\t\t$('#userTaggerContents').append(showDiv);\r\n\t\t\t\t$('#tagFilter').change(function() {\r\n\t\t\t\t\tdrawUserTagTable();\r\n\t\t\t\t});\r\n\r\n\t\t\t\tvar tagsPerPage = parseInt(modules['dashboard'].options['tagsPerPage'].value, 10);\r\n\t\t\t\tif (tagsPerPage) {\r\n\t\t\t\t\tvar controlWrapper = document.createElement('div');\r\n\t\t\t\t\tcontrolWrapper.id = 'tagPageControls';\r\n\t\t\t\t\tcontrolWrapper.className = 'RESGalleryControls';\r\n\t\t\t\t\tcontrolWrapper.page = 1;\r\n\t\t\t\t\tcontrolWrapper.pageCount = 1;\r\n\r\n\t\t\t\t\tvar leftButton = document.createElement('a');\r\n\t\t\t\t\tleftButton.className = 'previous noKeyNav';\r\n\t\t\t\t\tleftButton.addEventListener('click', function(e) {\r\n\t\t\t\t\t\tif (controlWrapper.page === 1) {\r\n\t\t\t\t\t\t\tcontrolWrapper.page = controlWrapper.pageCount;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcontrolWrapper.page--;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdrawUserTagTable();\r\n\t\t\t\t\t});\r\n\t\t\t\t\t$(controlWrapper).append('Page ');\r\n\t\t\t\t\tcontrolWrapper.appendChild(leftButton);\r\n\r\n\t\t\t\t\tvar posLabel = document.createElement('span');\r\n\t\t\t\t\tposLabel.className = 'RESGalleryLabel';\r\n\t\t\t\t\tposLabel.textContent = '1 of 2';\r\n\t\t\t\t\tcontrolWrapper.appendChild(posLabel);\r\n\r\n\t\t\t\t\tvar rightButton = document.createElement('a');\r\n\t\t\t\t\trightButton.className = 'next noKeyNav';\r\n\t\t\t\t\trightButton.addEventListener('click', function(e) {\r\n\t\t\t\t\t\tif (controlWrapper.page === controlWrapper.pageCount) {\r\n\t\t\t\t\t\t\tcontrolWrapper.page = 1;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcontrolWrapper.page++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdrawUserTagTable();\r\n\t\t\t\t\t});\r\n\t\t\t\t\tcontrolWrapper.appendChild(rightButton);\r\n\r\n\t\t\t\t\t$('#userTaggerContents').append(controlWrapper);\r\n\t\t\t\t}\r\n\t\t\t\tvar thisTable = $('<table id=\"userTaggerTable\" />');\r\n\t\t\t\t$(thisTable).append('<thead><tr><th sort=\"username\" class=\"active\">Username <span class=\"sortAsc\"></span></th><th sort=\"tag\">Tag</th><th sort=\"ignore\">Ignored</th><th sort=\"color\">Color</th><th sort=\"votes\">Vote Weight</th></tr></thead><tbody></tbody>');\r\n\t\t\t\t$('#userTaggerContents').append(thisTable);\r\n\t\t\t\t$('#userTaggerTable thead th').click(function(e) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tvar $this = $(this);\r\n\r\n\t\t\t\t\tif ($this.hasClass('delete')) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ($this.hasClass('active')) {\r\n\t\t\t\t\t\t$this.toggleClass('descending');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$this.addClass('active');\r\n\t\t\t\t\t$this.siblings().removeClass('active').find('SPAN').remove();\r\n\t\t\t\t\t$this.find('.sortAsc, .sortDesc').remove();\r\n\t\t\t\t\t$this.append($(e.target).hasClass('descending') ?\r\n\t\t\t\t\t\t'<span class=\"sortDesc\" />' :\r\n\t\t\t\t\t\t'<span class=\"sortAsc\" />');\r\n\t\t\t\t\tdrawUserTagTable($(e.target).attr('sort'), $(e.target).hasClass('descending'));\r\n\t\t\t\t});\r\n\t\t\t\tdrawUserTagTable();\r\n\t\t\t}\r\n\r\n\t\t\tif (this.options.colorUser.value) {\r\n\t\t\t\tattachVoteHandlers(document.body);\r\n\t\t\t}\r\n\t\t\t// add tooltip to document body...\r\n\t\t\tuserTaggerToolTip = RESUtils.createElement('div', 'userTaggerToolTip', 'RESDialogSmall');\r\n\t\t\tvar thisHTML = '<h3>Tag User</h3><div id=\"userTaggerToolTipContents\" class=\"RESDialogContents clear\">';\r\n\t\t\tthisHTML += '<form name=\"userTaggerForm\" action=\"\"><input type=\"hidden\" id=\"userTaggerName\" value=\"\">';\r\n\t\t\tthisHTML += '<label for=\"userTaggerTag\">Tag</label> <input type=\"text\" id=\"userTaggerTag\" value=\"\">';\r\n\t\t\tthisHTML += '<div id=\"userTaggerClose\" class=\"RESCloseButton\">&times;</div>';\r\n\t\t\tthisHTML += '<label for=\"userTaggerColor\">Color</label> <select id=\"userTaggerColor\">';\r\n\t\t\tfor (var color in bgToTextColorMap) {\r\n\t\t\t\tvar bgColor = (color === 'none') ? 'transparent' : color;\r\n\t\t\t\tthisHTML += '<option style=\"background-color: ' + bgColor + '; color: ' + bgToTextColorMap[color] + ' !important;\" value=\"' + color + '\">' + color + '</option>';\r\n\t\t\t}\r\n\t\t\tthisHTML += '</select>';\r\n\t\t\tthisHTML += '<label for=\"userTaggerPreview\">Preview</label> <span id=\"userTaggerPreview\"></span>';\r\n\t\t\tthisHTML += '<label for=\"userTaggerIgnore\">Ignore ' + modules['settingsNavigation'].makeUrlHashLink('userTagger', 'hardIgnore', ' ', 'gearIcon') + '</label>'; // <input type=\"checkbox\" id=\"userTaggerIgnore\" value=\"true\">';\r\n\t\t\tthisHTML += '<label for=\"userTaggerLink\">Link<span class=\"hoverHelp\" title=\"add a link for this user (shows up in hover pane)\">?</span> <span class=\"userTaggerOpenLink\">- <a href=\"#\">Open</a></span></label> <input type=\"text\" id=\"userTaggerLink\" value=\"\">';\r\n\t\t\tthisHTML += '<label for=\"userTaggerVoteWeight\" title=\"The sum of upvotes and downvotes you have given this redditor\">Vote Weight<span class=\"hoverHelp\" title=\"manually edit vote weight (sum of upvotes and downvotes) for this redditor\">?</span></label> <input type=\"text\" size=\"2\" id=\"userTaggerVoteWeight\" value=\"\">';\r\n\t\t\tthisHTML += '<div class=\"clear\"></div><a href=\"/r/dashboard#userTaggerContents\" target=\"_blank\">See all tags</a><input type=\"submit\" id=\"userTaggerSave\" value=\"Save\"></form></div>';\r\n\t\t\t$(userTaggerToolTip).html(thisHTML);\r\n\t\t\tvar ignoreLabel = userTaggerToolTip.querySelector('label[for=userTaggerIgnore]');\r\n\t\t\tRESUtils.insertAfter(ignoreLabel, RESUtils.createElement.toggleButton(null, 'userTaggerIgnore', false, 'no', 'yes'));\r\n\t\t\tuserTaggerTag = userTaggerToolTip.querySelector('#userTaggerTag');\r\n\t\t\tuserTaggerTag.addEventListener('keyup', updateTagPreview, false);\r\n\t\t\tuserTaggerColor = userTaggerToolTip.querySelector('#userTaggerColor');\r\n\t\t\tuserTaggerColor.addEventListener('change', updateTagPreview, false);\r\n\t\t\tuserTaggerPreview = userTaggerToolTip.querySelector('#userTaggerPreview');\r\n\t\t\tvar userTaggerLink = userTaggerToolTip.querySelector('#userTaggerLink');\r\n\t\t\tuserTaggerLink.addEventListener('keyup', function(e) {\r\n\t\t\t\tupdateOpenLink(userTaggerLink);\r\n\t\t\t}, false);\r\n\t\t\tvar userTaggerOpen = userTaggerToolTip.querySelector('.userTaggerOpenLink a');\r\n\t\t\tuserTaggerOpen.addEventListener('click', function(e) {\r\n\t\t\t\tvar links = userTaggerLink.value.split(/\\s/);\r\n\t\t\t\tfor (var i = links.length - 1; i > 0; i--) {\r\n\t\t\t\t\tRESEnvironment.openLinkInNewTab(links[i]);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tvar userTaggerSave = userTaggerToolTip.querySelector('#userTaggerSave');\r\n\t\t\tuserTaggerSave.setAttribute('type', 'submit');\r\n\t\t\tuserTaggerSave.setAttribute('value', '✓ save tag');\r\n\t\t\tuserTaggerSave.addEventListener('click', function(e) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tsaveTagForm();\r\n\t\t\t}, false);\r\n\t\t\tvar userTaggerClose = userTaggerToolTip.querySelector('#userTaggerClose');\r\n\t\t\tuserTaggerClose.addEventListener('click', function(e) {\r\n\t\t\t\tcloseUserTagPrompt();\r\n\t\t\t}, false);\r\n\t\t\t//userTaggerToolTip.appendChild(userTaggerSave);\r\n\t\t\tuserTaggerForm = userTaggerToolTip.querySelector('FORM');\r\n\t\t\tuserTaggerForm.addEventListener('submit', function(e) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tsaveTagForm();\r\n\t\t\t}, true);\r\n\t\t\tdocument.body.appendChild(userTaggerToolTip);\r\n\r\n\t\t\tuserTaggerToolTip.querySelector('#userTaggerTag').addEventListener('keydown', function(e) {\r\n\t\t\t\tif (e.keyCode === 27) {\r\n\t\t\t\t\t// close prompt.\r\n\t\t\t\t\tcloseUserTagPrompt();\r\n\t\t\t\t}\r\n\t\t\t}, true);\r\n\t\t\t//console.log('before applytags: ' + Date());\r\n\t\t\tapplyTags();\r\n\t\t\t//console.log('after applytags: ' + Date());\r\n\t\t\tif (RESUtils.pageType() === 'comments') {\r\n\t\t\t\tRESUtils.watchForElement('newComments', attachVoteHandlersToComment);\r\n\t\t\t\tRESUtils.watchForElement('newComments', applyTags);\r\n\t\t\t} else {\r\n\t\t\t\tRESUtils.watchForElement('siteTable', attachVoteHandlers);\r\n\t\t\t\tRESUtils.watchForElement('siteTable', applyTags);\r\n\t\t\t}\r\n\r\n\t\t\tif (RESUtils.regexes.profile.test(location.href)) {\r\n\t\t\t\tvar friendButton = document.querySelector('.titlebox .fancy-toggle-button');\r\n\t\t\t\tif ((typeof friendButton !== 'undefined') && (friendButton !== null)) {\r\n\t\t\t\t\tvar firstAuthor = document.querySelector('a.author'),\r\n\t\t\t\t\t\tthisFriendComment;\r\n\t\t\t\t\tif ((typeof firstAuthor !== 'undefined') && (firstAuthor !== null)) {\r\n\t\t\t\t\t\tthisFriendComment = firstAuthor.getAttribute('title');\r\n\t\t\t\t\t\tthisFriendComment = (thisFriendComment !== null) ? thisFriendComment.substring(8, thisFriendComment.length - 1) : '';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthisFriendComment = '';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tregisterCommandLine();\r\n\t\t}\r\n\t};\r\n\r\n\tfunction registerCommandLine() {\r\n\t\tmodules['commandLine'].registerCommand('tag', 'tag [text] - tags author of currently selected link/comment as text',\r\n\t\t\tfunction(command, val, match) {\r\n\t\t\t\tvar tagLink = getAuthorTagLink();\r\n\t\t\t\tif (tagLink) {\r\n\t\t\t\t\tvar str = 'tag user ' + tagLink.getAttribute('username');\r\n\t\t\t\t\tif (val) {\r\n\t\t\t\t\t\tstr += ' as: ' + val;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn str;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn 'can\\'t set tag - no post/comment selected';\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tfunction(command, val, match, e) {\r\n\t\t\t\tvar tagLink = getAuthorTagLink();\r\n\t\t\t\tif (tagLink) {\r\n\t\t\t\t\tRESUtils.click(tagLink);\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tif (val !== '') {\r\n\t\t\t\t\t\t\tdocument.getElementById('userTaggerTag').value = val;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 20);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn 'can\\'t set tag - no post/comment selected';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tfunction getAuthorTagLink() {\r\n\t\t\tvar selected = modules['selectedEntry'].selected();\r\n\t\t\tvar searchArea = selected ? selected.entry : document.body;\r\n\r\n\t\t\tvar tagLink = searchArea.querySelector('a.userTagLink');\r\n\t\t\treturn tagLink;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction attachVoteHandlersToComment(comment) {\r\n\t\tvar obj = $(comment).closest('.thing')[0];\r\n\t\t// Attach to this comment, but not its children\r\n\t\tattachVoteHandlers(obj, 1);\r\n\t}\r\n\r\n\tfunction attachVoteHandlers(obj, maxPairs) {\r\n\t\tif (!RESUtils.loggedInUser()) return;\r\n\r\n\t\tvar voteButtons = obj.querySelectorAll('.midcol .arrow');\r\n\t\tif (maxPairs) {\r\n\t\t\tvoteButtons = Array.prototype.slice.call(voteButtons, 0, maxPairs * 2);\r\n\t\t} else {\r\n\t\t\tvoteButtons = Array.prototype.slice.call(voteButtons);\r\n\t\t}\r\n\t\tvoteButtons.forEach(function(voteButton) {\r\n\t\t\tvoteButton.addEventListener('click', handleVoteClick, true);\r\n\t\t});\r\n\t}\r\n\r\n\tfunction handleVoteClick(e) {\r\n\t\tvar tags = RESStorage.getItem('RESmodules.userTagger.tags');\r\n\t\tif (typeof tags !== 'undefined') {\r\n\t\t\tmodule.tags = safeJSON.parse(tags, 'RESmodules.userTagger.tags', true) || {};\r\n\t\t}\r\n\r\n\t\tvar $this = $(this);\r\n\t\tvar $otherArrow = $this.siblings('.arrow');\r\n\t\tvar thing = new RESUtils.thing(this);\r\n\t\tvar thisAuthor = thing.getAuthor();\r\n\r\n\t\t// Stop if the post is archived (unvotable) or you are voting on your own post/comment/etc.\r\n\t\tif ($this.hasClass('archived') || !thisAuthor || thisAuthor === RESUtils.loggedInUser()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar thisVWobj = thing.querySelector('.voteWeight');\r\n\r\n\t\tthisAuthor = thisAuthor.toLowerCase();\r\n\r\n\t\tvar votes = 0;\r\n\t\tif (typeof module.tags[thisAuthor] !== 'undefined') {\r\n\t\t\tif (typeof module.tags[thisAuthor].votes !== 'undefined') {\r\n\t\t\t\tvotes = parseInt(module.tags[thisAuthor].votes, 10);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tmodule.tags[thisAuthor] = {};\r\n\t\t}\r\n\t\t// there are 6 possibilities here:\r\n\t\t// 1) no vote yet, click upmod\r\n\t\t// 2) no vote yet, click downmod\r\n\t\t// 3) already upmodded, undoing\r\n\t\t// 4) already downmodded, undoing\r\n\t\t// 5) upmodded before, switching to downmod\r\n\t\t// 6) downmodded before, switching to upmod\r\n\r\n\t\t// classes are changed AFTER this event is triggered\r\n\t\tif ($this.hasClass('up')) {\r\n\t\t\t// adding an upvote\r\n\t\t\tvotes++;\r\n\t\t\tif ($otherArrow.hasClass('downmod')) {\r\n\t\t\t\t// also removing a downvote\r\n\t\t\t\tvotes++;\r\n\t\t\t}\r\n\t\t} else if ($this.hasClass('upmod')) {\r\n\t\t\t// removing an upvote directly\r\n\t\t\tvotes--;\r\n\t\t} else if ($this.hasClass('down')) {\r\n\t\t\t// adding a downvote\r\n\t\t\tvotes--;\r\n\t\t\tif ($otherArrow.hasClass('upmod')) {\r\n\t\t\t\t// also removing an upvote\r\n\t\t\t\tvotes--;\r\n\t\t\t}\r\n\t\t} else if ($this.hasClass('downmod')) {\r\n\t\t\t// removing a downvote directly\r\n\t\t\tvotes++;\r\n\t\t}\r\n\t\tmodule.tags[thisAuthor].votes = votes;\r\n\t\tRESStorage.setItem('RESmodules.userTagger.tags', JSON.stringify(module.tags));\r\n\t\tcolorUser(thisVWobj, thisAuthor, votes);\r\n\t}\r\n\r\n\tvar currentSortMethod, isDescending;\r\n\r\n\tfunction drawUserTagTable(sortMethod, descending) {\r\n\t\tcurrentSortMethod = sortMethod || currentSortMethod;\r\n\t\tisDescending = (typeof descending === 'undefined' || descending === null) ? isDescending : descending;\r\n\t\tvar taggedUsers = [];\r\n\t\tvar filterType = $('#tagFilter').val();\r\n\t\tfor (var tagIndex in module.tags) {\r\n\t\t\tif (filterType === 'tagged users') {\r\n\t\t\t\tif (typeof module.tags[tagIndex].tag !== 'undefined') {\r\n\t\t\t\t\ttaggedUsers.push(tagIndex);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\ttaggedUsers.push(tagIndex);\r\n\t\t\t}\r\n\t\t}\r\n\t\tswitch (currentSortMethod) {\r\n\t\t\tcase 'tag':\r\n\t\t\t\ttaggedUsers.sort(function(a, b) {\r\n\t\t\t\t\tvar tagA = (typeof module.tags[a].tag === 'undefined') ? 'zzzzz' : module.tags[a].tag.toLowerCase();\r\n\t\t\t\t\tvar tagB = (typeof module.tags[b].tag === 'undefined') ? 'zzzzz' : module.tags[b].tag.toLowerCase();\r\n\t\t\t\t\treturn (tagA > tagB) ? 1 : (tagB > tagA) ? -1 : 0;\r\n\t\t\t\t});\r\n\t\t\t\tif (isDescending) {\r\n\t\t\t\t\ttaggedUsers.reverse();\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'ignore':\r\n\t\t\t\ttaggedUsers.sort(function(a, b) {\r\n\t\t\t\t\tvar tagA = (typeof module.tags[a].ignore === 'undefined') ? 'z' : 'a';\r\n\t\t\t\t\tvar tagB = (typeof module.tags[b].ignore === 'undefined') ? 'z' : 'a';\r\n\t\t\t\t\treturn (tagA > tagB) ? 1 : (tagB > tagA) ? -1 : 0;\r\n\t\t\t\t});\r\n\t\t\t\tif (isDescending) {\r\n\t\t\t\t\ttaggedUsers.reverse();\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'color':\r\n\t\t\t\ttaggedUsers.sort(function(a, b) {\r\n\t\t\t\t\tvar colorA = (typeof module.tags[a].color === 'undefined') ? 'zzzzz' : module.tags[a].color.toLowerCase();\r\n\t\t\t\t\tvar colorB = (typeof module.tags[b].color === 'undefined') ? 'zzzzz' : module.tags[b].color.toLowerCase();\r\n\t\t\t\t\treturn (colorA > colorB) ? 1 : (colorB > colorA) ? -1 : 0;\r\n\t\t\t\t});\r\n\t\t\t\tif (isDescending) {\r\n\t\t\t\t\ttaggedUsers.reverse();\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'votes':\r\n\t\t\t\ttaggedUsers.sort(function(a, b) {\r\n\t\t\t\t\tvar tagA = (typeof module.tags[a].votes === 'undefined') ? 0 : module.tags[a].votes;\r\n\t\t\t\t\tvar tagB = (typeof module.tags[b].votes === 'undefined') ? 0 : module.tags[b].votes;\r\n\t\t\t\t\treturn (tagA > tagB) ? 1 : (tagB > tagA) ? -1 : (a.toLowerCase() > b.toLowerCase());\r\n\t\t\t\t});\r\n\t\t\t\tif (isDescending) {\r\n\t\t\t\t\ttaggedUsers.reverse();\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'username':\r\n\t\t\t\t/* falls through */\r\n\t\t\tdefault:\r\n\t\t\t\t// sort users, ignoring case\r\n\t\t\t\ttaggedUsers.sort(function(a, b) {\r\n\t\t\t\t\treturn (a.toLowerCase() > b.toLowerCase()) ? 1 : (b.toLowerCase() > a.toLowerCase()) ? -1 : 0;\r\n\t\t\t\t});\r\n\t\t\t\tif (isDescending) {\r\n\t\t\t\t\ttaggedUsers.reverse();\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\t$('#userTaggerTable tbody').html('');\r\n\t\tvar tagsPerPage = parseInt(modules['dashboard'].options['tagsPerPage'].value, 10);\r\n\t\tvar count = taggedUsers.length;\r\n\t\tvar start = 0;\r\n\t\tvar end = count;\r\n\r\n\t\tif (tagsPerPage) {\r\n\t\t\tvar tagControls = $('#tagPageControls');\r\n\t\t\tvar page = tagControls.prop('page');\r\n\t\t\tvar pages = Math.ceil(count / tagsPerPage);\r\n\t\t\tpage = Math.min(page, pages);\r\n\t\t\tpage = Math.max(page, 1);\r\n\t\t\ttagControls.prop('page', page).prop('pageCount', pages);\r\n\t\t\ttagControls.find('.RESGalleryLabel').text(page + ' of ' + pages);\r\n\t\t\tstart = tagsPerPage * (page - 1);\r\n\t\t\tend = Math.min(count, tagsPerPage * page);\r\n\t\t}\r\n\r\n\t\tfor (var userIndex = start; userIndex < end; userIndex++) {\r\n\t\t\tvar thisUser = taggedUsers[userIndex];\r\n\t\t\tvar thisTag = (typeof module.tags[thisUser].tag === 'undefined') ? '' : module.tags[thisUser].tag;\r\n\t\t\tvar thisVotes = (typeof module.tags[thisUser].votes === 'undefined') ? 0 : module.tags[thisUser].votes;\r\n\t\t\tvar thisColor = (typeof module.tags[thisUser].color === 'undefined') ? '' : module.tags[thisUser].color;\r\n\t\t\tvar thisIgnore = (typeof module.tags[thisUser].ignore === 'undefined') ? 'no' : 'yes';\r\n\r\n\t\t\tvar userTagLink = document.createElement('a');\r\n\t\t\tif (thisTag === '') {\r\n\t\t\t\t// thisTag = '<div class=\"RESUserTagImage\"></div>';\r\n\t\t\t\tuserTagLink.setAttribute('class', 'userTagLink RESUserTagImage');\r\n\t\t\t} else {\r\n\t\t\t\tuserTagLink.setAttribute('class', 'userTagLink hasTag');\r\n\t\t\t}\r\n\t\t\t$(userTagLink).text(thisTag);\r\n\t\t\tif (thisColor) {\r\n\t\t\t\tvar bgColor = (thisColor === 'none') ? 'transparent' : thisColor;\r\n\t\t\t\tuserTagLink.setAttribute('style', 'background-color: ' + bgColor + '; color: ' + bgToTextColorMap[thisColor] + ' !important;');\r\n\t\t\t}\r\n\t\t\tuserTagLink.setAttribute('username', thisUser);\r\n\t\t\tuserTagLink.setAttribute('title', 'set a tag');\r\n\t\t\tuserTagLink.setAttribute('href', 'javascript:void 0'); // eslint-disable-line no-script-url\r\n\t\t\tuserTagLink.addEventListener('click', function(e) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\topenUserTagPrompt(e.target, this.getAttribute('username'));\r\n\t\t\t}, true);\r\n\r\n\t\t\t$('#userTaggerTable tbody').append('<tr><td><a class=\"author\" href=\"/user/' + thisUser + '\">' + thisUser + '</a> <span class=\"res-icon res-right deleteIcon\" data-icon=\"&#xf056;\" user=\"' + thisUser + '\"></span></td><td id=\"tag_' + userIndex + '\"></td><td id=\"ignore_' + userIndex + '\">' + thisIgnore + '</td><td><span style=\"color: ' + thisColor + '\">' + thisColor + '</span></td><td>' + thisVotes + '</td></tr>');\r\n\t\t\t$('#tag_' + userIndex).append(userTagLink);\r\n\t\t}\r\n\t\t$('#userTaggerTable tbody .deleteIcon').click(function(e) {\r\n\t\t\tvar thisUser = $(this).attr('user').toLowerCase();\r\n\t\t\tvar button = $(this);\r\n\t\t\talert('Are you sure you want to delete the tag for user: ' + thisUser + '?',\r\n\t\t\t\tfunction(e){\r\n\t\t\t\t\tdelete module.tags[thisUser];\r\n\t\t\t\t\tRESStorage.setItem('RESmodules.userTagger.tags', JSON.stringify(module.tags));\r\n\t\t\t\t\tbutton.closest('tr').remove();\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tfunction saveTagForm() {\r\n\t\tvar thisName = document.getElementById('userTaggerName').value;\r\n\t\tvar thisTag = document.getElementById('userTaggerTag').value;\r\n\t\tvar thisColor = document.getElementById('userTaggerColor').value;\r\n\t\tvar thisIgnore = document.getElementById('userTaggerIgnore').checked;\r\n\t\tvar thisLink = document.getElementById('userTaggerLink').value;\r\n\t\tvar thisVotes = parseInt(document.getElementById('userTaggerVoteWeight').value, 10);\r\n\t\tif (isNaN(thisVotes)) {\r\n\t\t\tthisVotes = 0;\r\n\t\t}\r\n\t\tsetUserTag(thisName, thisTag, thisColor, thisIgnore, thisLink, thisVotes);\r\n\t}\r\n\r\n\tvar bgToTextColorMap = {\r\n\t\t'none': 'inherit',\r\n\t\t'aqua': 'black',\r\n\t\t'black': 'white',\r\n\t\t'blue': 'white',\r\n\t\t'fuchsia': 'white',\r\n\t\t'pink': 'black',\r\n\t\t'gray': 'white',\r\n\t\t'green': 'white',\r\n\t\t'lime': 'black',\r\n\t\t'maroon': 'white',\r\n\t\t'navy': 'white',\r\n\t\t'olive': 'white',\r\n\t\t'orange': 'white',\r\n\t\t'purple': 'white',\r\n\t\t'red': ' white',\r\n\t\t'silver': 'black',\r\n\t\t'teal': 'white',\r\n\t\t'white': 'black',\r\n\t\t'yellow': 'black'\r\n\t};\r\n\r\n\tvar clickedTag;\r\n\r\n\tfunction openUserTagPrompt(obj, username) {\r\n\t\tvar thisXY = RESUtils.getXYpos(obj);\r\n\t\tusername = username.toLowerCase();\r\n\t\tclickedTag = obj;\r\n\t\tvar thisH3 = document.querySelector('#userTaggerToolTip h3');\r\n\t\tthisH3.textContent = 'Tag ' + username;\r\n\t\tdocument.getElementById('userTaggerName').value = username;\r\n\t\tif (typeof module.tags[username] !== 'undefined') {\r\n\t\t\tif (typeof module.tags[username].link !== 'undefined') {\r\n\t\t\t\tdocument.getElementById('userTaggerLink').value = module.tags[username].link;\r\n\t\t\t} else {\r\n\t\t\t\tdocument.getElementById('userTaggerLink').value = '';\r\n\t\t\t}\r\n\t\t\tif (typeof module.tags[username].tag !== 'undefined') {\r\n\t\t\t\tdocument.getElementById('userTaggerTag').value = module.tags[username].tag;\r\n\t\t\t} else {\r\n\t\t\t\tdocument.getElementById('userTaggerTag').value = '';\r\n\t\t\t\tif (typeof module.tags[username].link === 'undefined') {\r\n\t\t\t\t\t// since we haven't yet set a tag or a link for this user, auto populate a link for the\r\n\t\t\t\t\t// user based on where we are tagging from.\r\n\t\t\t\t\tsetLinkBasedOnTagLocation(obj);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar ignored = typeof module.tags[username].ignore !== 'undefined' ? module.tags[username].ignore : false;\r\n\t\t\tdocument.getElementById('userTaggerIgnore').checked = ignored;\r\n\t\t\tdocument.getElementById('userTaggerIgnoreContainer').classList.toggle('enabled', ignored);\r\n\t\t\tif (typeof module.tags[username].votes !== 'undefined') {\r\n\t\t\t\tdocument.getElementById('userTaggerVoteWeight').value = module.tags[username].votes;\r\n\t\t\t} else {\r\n\t\t\t\tdocument.getElementById('userTaggerVoteWeight').value = '';\r\n\t\t\t}\r\n\t\t\tif (typeof module.tags[username].color !== 'undefined') {\r\n\t\t\t\t$('#userTaggerColor').val(module.tags[username].color);\r\n\t\t\t} else {\r\n\t\t\t\tdocument.getElementById('userTaggerColor').selectedIndex = 0;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tdocument.getElementById('userTaggerTag').value = '';\r\n\t\t\tdocument.getElementById('userTaggerIgnore').checked = false;\r\n\t\t\tdocument.getElementById('userTaggerIgnoreContainer').classList.remove('enabled');\r\n\t\t\tdocument.getElementById('userTaggerVoteWeight').value = '';\r\n\t\t\tdocument.getElementById('userTaggerLink').value = '';\r\n\t\t\tif (module.options.storeSourceLink.value) {\r\n\t\t\t\tsetLinkBasedOnTagLocation(obj);\r\n\t\t\t}\r\n\t\t\tdocument.getElementById('userTaggerColor').selectedIndex = 0;\r\n\t\t}\r\n\t\tuserTaggerToolTip.setAttribute('style', 'display: block; top: ' + thisXY.y + 'px; left: ' + thisXY.x + 'px; z-index: 20;');\r\n\t\tdocument.getElementById('userTaggerTag').focus();\r\n\t\tupdateOpenLink(document.getElementById('userTaggerLink'));\r\n\t\tupdateTagPreview();\r\n\t\treturn false;\r\n\t}\r\n\r\n\tfunction setLinkBasedOnTagLocation(obj) {\r\n\t\tvar closestEntry = $(obj).closest('.entry'),\r\n\t\t\tlinkTitle = '';\r\n\r\n\t\tif (!module.options.useCommentsLinkAsSource.value) {\r\n\t\t\tlinkTitle = $(closestEntry).find('a.title');\r\n\t\t}\r\n\t\t// if we didn't find anything, try a new search (works on inbox)\r\n\t\tif (!linkTitle.length) {\r\n\t\t\tlinkTitle = $(closestEntry).find('a.bylink');\r\n\t\t}\r\n\t\tif (linkTitle.length) {\r\n\t\t\tdocument.getElementById('userTaggerLink').value = $(linkTitle).attr('href');\r\n\t\t} else {\r\n\t\t\tvar permaLink = $(closestEntry).find('.flat-list.buttons li.first a');\r\n\t\t\tif (permaLink.length) {\r\n\t\t\t\tdocument.getElementById('userTaggerLink').value = $(permaLink).attr('href');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction updateTagPreview() {\r\n\t\t$(userTaggerPreview).text(userTaggerTag.value);\r\n\t\tvar bgcolor = userTaggerColor[userTaggerColor.selectedIndex].value;\r\n\t\tuserTaggerPreview.style.backgroundColor = (bgcolor === 'none') ? 'transparent' : bgcolor;\r\n\t\tuserTaggerPreview.style.color = bgToTextColorMap[bgcolor];\r\n\t}\r\n\r\n\tfunction updateOpenLink(userTaggerLink) {\r\n\t\tif (userTaggerLink.value) {\r\n\t\t\tvar openLinkSpan = userTaggerToolTip.querySelector('.userTaggerOpenLink');\r\n\t\t\topenLinkSpan.style.display = 'inline';\r\n\t\t\topenLinkSpan.getElementsByTagName('a')[0].href = userTaggerLink.value.split(/\\s/)[0];\r\n\t\t} else {\r\n\t\t\tuserTaggerToolTip.querySelector('.userTaggerOpenLink').style.display = 'none';\r\n\t\t}\r\n\t}\r\n\r\n\tfunction closeUserTagPrompt() {\r\n\t\tuserTaggerToolTip.setAttribute('style', 'display: none');\r\n\t\tif (modules['keyboardNav'].isEnabled()) {\r\n\t\t\tvar inputs = userTaggerToolTip.querySelectorAll('INPUT, BUTTON');\r\n\t\t\t// remove focus from any input fields from the prompt so that keyboard navigation works again...\r\n\t\t\tArray.prototype.slice.call(inputs).forEach(function(input) {\r\n\t\t\t\tinput.blur();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tfunction setUserTag(username, tag, color, ignore, link, votes, noclick) {\r\n\t\tusername = username.toLowerCase();\r\n\t\tif (((tag !== null) && (tag !== '')) || (ignore)) {\r\n\t\t\tif (tag === '') {\r\n\t\t\t\ttag = 'ignored';\r\n\t\t\t}\r\n\t\t\tif (typeof module.tags[username] === 'undefined') {\r\n\t\t\t\tmodule.tags[username] = {};\r\n\t\t\t}\r\n\t\t\tmodule.tags[username].tag = tag;\r\n\t\t\tmodule.tags[username].link = link;\r\n\t\t\tmodule.tags[username].color = color;\r\n\t\t\tvar bgColor = (color === 'none') ? 'transparent' : color;\r\n\t\t\tif (ignore) {\r\n\t\t\t\tmodule.tags[username].ignore = true;\r\n\t\t\t} else {\r\n\t\t\t\tdelete module.tags[username].ignore;\r\n\t\t\t}\r\n\t\t\tif (!noclick) {\r\n\t\t\t\tclickedTag.setAttribute('class', 'userTagLink hasTag');\r\n\t\t\t\tclickedTag.setAttribute('style', 'background-color: ' + bgColor + '; color: ' + bgToTextColorMap[color] + ' !important;');\r\n\t\t\t\t$(clickedTag).text(tag);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (typeof module.tags[username] !== 'undefined') {\r\n\t\t\t\tdelete module.tags[username].tag;\r\n\t\t\t\tdelete module.tags[username].color;\r\n\t\t\t\tdelete module.tags[username].link;\r\n\t\t\t\tif (module.tags[username].tag === 'ignored') {\r\n\t\t\t\t\tdelete module.tags[username].tag;\r\n\t\t\t\t}\r\n\t\t\t\tdelete module.tags[username].ignore;\r\n\t\t\t}\r\n\t\t\tif (!noclick) {\r\n\t\t\t\tclickedTag.setAttribute('style', 'background-color: transparent');\r\n\t\t\t\tclickedTag.setAttribute('class', 'userTagLink RESUserTagImage');\r\n\t\t\t\t$(clickedTag).html('');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (typeof module.tags[username] !== 'undefined') {\r\n\t\t\tmodule.tags[username].votes = (isNaN(votes)) ? 0 : votes;\r\n\t\t}\r\n\t\tif (!noclick) {\r\n\t\t\tvar thisVW = clickedTag.parentNode.parentNode.querySelector('a.voteWeight');\r\n\t\t\tif (thisVW) {\r\n\t\t\t\tcolorUser(thisVW, username, votes);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (RESUtils.isEmpty(module.tags[username])) {\r\n\t\t\tdelete module.tags[username];\r\n\t\t}\r\n\t\tRESStorage.setItem('RESmodules.userTagger.tags', JSON.stringify(module.tags));\r\n\t\tcloseUserTagPrompt();\r\n\t}\r\n\r\n\tmodule.usernameSelector = '.contents .author, .noncollapsed a.author, p.tagline a.author, #friend-table span.user a, .sidecontentbox .author, div.md a[href^=\"/u/\"]:not([href*=\"/m/\"]), div.md a[href*=\"reddit.com/u/\"]:not([href*=\"/m/\"]), .usertable a.author, .usertable span.user a, div.wiki-page-content .author, .commentingAsUser';\r\n\r\n\tfunction applyTags(ele) {\r\n\t\tele = ele || document;\r\n\t\tvar authors = ele.querySelectorAll(module.usernameSelector);\r\n\t\tRESUtils.forEachChunked(authors, 15, 1000, function(arrayElement, index, array) {\r\n\t\t\tmodule.applyTagToAuthor(arrayElement);\r\n\t\t});\r\n\t}\r\n\r\n\tmodule.applyTagToAuthor = function(thisAuthorObj, noEdit) {\r\n\t\tvar userObject = [],\r\n\t\t\tthisVotes = 0,\r\n\t\t\tthisTag = null,\r\n\t\t\tthisColor = null,\r\n\t\t\tthisIgnore = null,\r\n\t\t\tthisAuthor, thisPost, thisComment, test, noTag;\r\n\r\n\t\tif ((thisAuthorObj) && (!(thisAuthorObj.classList.contains('userTagged'))) && (typeof thisAuthorObj !== 'undefined') && (thisAuthorObj !== null)) {\r\n\t\t\tif (thisAuthorObj.href) {\r\n\t\t\t\ttest = thisAuthorObj.href.match(module.usernameRE);\r\n\t\t\t\tif (test) {\r\n\t\t\t\t\tthisAuthor = test[1];\r\n\t\t\t\t}\r\n\t\t\t} else if (thisAuthorObj.getAttribute('data-user')) {\r\n\t\t\t\tthisAuthor = thisAuthorObj.getAttribute('data-user');\r\n\t\t\t}\r\n\t\t\t// var thisAuthor = thisAuthorObj.text;\r\n\t\t\tnoTag = false;\r\n\t\t\tif ((thisAuthor) && (thisAuthor.substr(0, 3) === '/u/')) {\r\n\t\t\t\tnoTag = true;\r\n\t\t\t\tthisAuthor = thisAuthor.substr(3);\r\n\t\t\t}\r\n\t\t\tthisAuthor = thisAuthor.toLowerCase();\r\n\t\t\tif (!noTag) {\r\n\t\t\t\tthisAuthorObj.classList.add('userTagged');\r\n\t\t\t\tif (typeof userObject[thisAuthor] === 'undefined') {\r\n\t\t\t\t\tif (module.tags && module.tags[thisAuthor]) {\r\n\t\t\t\t\t\tif (typeof module.tags[thisAuthor].votes !== 'undefined') {\r\n\t\t\t\t\t\t\tthisVotes = parseInt(module.tags[thisAuthor].votes, 10);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (typeof module.tags[thisAuthor].tag !== 'undefined') {\r\n\t\t\t\t\t\t\tthisTag = module.tags[thisAuthor].tag;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (typeof module.tags[thisAuthor].color !== 'undefined') {\r\n\t\t\t\t\t\t\tthisColor = module.tags[thisAuthor].color;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (typeof module.tags[thisAuthor].ignore !== 'undefined') {\r\n\t\t\t\t\t\t\tthisIgnore = module.tags[thisAuthor].ignore;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tuserObject[thisAuthor] = {\r\n\t\t\t\t\t\ttag: thisTag,\r\n\t\t\t\t\t\tcolor: thisColor,\r\n\t\t\t\t\t\tignore: thisIgnore,\r\n\t\t\t\t\t\tvotes: thisVotes\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar userTagFrag = document.createDocumentFragment();\r\n\r\n\t\t\t\tif (thisTag || typeof noEdit === 'undefined' || !noEdit) {\r\n\t\t\t\t\tvar userTagLink = document.createElement('a');\r\n\t\t\t\t\tif (!thisTag) {\r\n\t\t\t\t\t\tthisTag = '';\r\n\t\t\t\t\t\tuserTagLink.setAttribute('class', 'userTagLink RESUserTagImage');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuserTagLink.setAttribute('class', 'userTagLink hasTag');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$(userTagLink).text(thisTag);\r\n\t\t\t\t\tif (thisColor) {\r\n\t\t\t\t\t\tvar bgColor = (thisColor === 'none') ? 'transparent' : thisColor;\r\n\t\t\t\t\t\tuserTagLink.setAttribute('style', 'background-color: ' + bgColor + '; color: ' + bgToTextColorMap[thisColor] + ' !important;');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (typeof noEdit === 'undefined' || !noEdit) {\r\n\t\t\t\t\t\tuserTagLink.setAttribute('username', thisAuthor);\r\n\t\t\t\t\t\tuserTagLink.setAttribute('title', 'set a tag');\r\n\t\t\t\t\t\tuserTagLink.setAttribute('href', 'javascript:void 0'); // eslint-disable-line no-script-url\r\n\t\t\t\t\t\tuserTagLink.addEventListener('click', function(e) {\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\topenUserTagPrompt(e.target, this.getAttribute('username'));\r\n\t\t\t\t\t\t}, true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar userTag = document.createElement('span');\r\n\t\t\t\t\tuserTag.classList.add('RESUserTag');\r\n\t\t\t\t\t// var lp = document.createTextNode(' (');\r\n\t\t\t\t\t// var rp = document.createTextNode(')');\r\n\t\t\t\t\tuserTag.appendChild(userTagLink);\r\n\t\t\t\t\t// userTagFrag.appendChild(lp);\r\n\t\t\t\t\tuserTagFrag.appendChild(userTag);\r\n\t\t\t\t\t// userTagFrag.appendChild(rp);\r\n\t\t\t\t\tif (typeof noEdit === 'undefined' || !noEdit) {\r\n\t\t\t\t\t\tif (module.options.colorUser.value) {\r\n\t\t\t\t\t\t\tvar userVoteFrag = document.createDocumentFragment();\r\n\t\t\t\t\t\t\tvar spacer = document.createTextNode(' ');\r\n\t\t\t\t\t\t\tuserVoteFrag.appendChild(spacer);\r\n\t\t\t\t\t\t\tvar userVoteWeight = document.createElement('a');\r\n\t\t\t\t\t\t\tuserVoteWeight.setAttribute('href', '#');\r\n\t\t\t\t\t\t\tuserVoteWeight.setAttribute('class', 'voteWeight');\r\n\t\t\t\t\t\t\t$(userVoteWeight).text('[vw]');\r\n\t\t\t\t\t\t\tuserVoteWeight.addEventListener('click', function(e) {\r\n\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\tvar theTag = this.parentNode.querySelector('.userTagLink');\r\n\t\t\t\t\t\t\t\topenUserTagPrompt(theTag, theTag.getAttribute('username'));\r\n\t\t\t\t\t\t\t}, true);\r\n\t\t\t\t\t\t\tcolorUser(userVoteWeight, thisAuthor, userObject[thisAuthor].votes);\r\n\t\t\t\t\t\t\tuserVoteFrag.appendChild(userVoteWeight);\r\n\t\t\t\t\t\t\tuserTagFrag.appendChild(userVoteFrag);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tRESUtils.insertAfter(thisAuthorObj, userTagFrag);\r\n\t\t\t\t\tif (typeof noEdit === 'undefined' || !noEdit) {\r\n\t\t\t\t\t\tthisIgnore = userObject[thisAuthor].ignore && thisAuthorObj.classList.contains('author');\r\n\t\t\t\t\t\tif (thisIgnore && (RESUtils.pageType() !== 'profile')) {\r\n\t\t\t\t\t\t\tif (module.options.hardIgnore.value) {\r\n\t\t\t\t\t\t\t\tif (RESUtils.pageType() === 'comments') {\r\n\t\t\t\t\t\t\t\t\tthisComment = ignoreComment(thisAuthorObj, thisAuthor);\r\n\t\t\t\t\t\t\t\t\tif (thisComment) {\r\n\t\t\t\t\t\t\t\t\t\t// collapse comment as well\r\n\t\t\t\t\t\t\t\t\t\tvar toggle = thisComment.parentNode.querySelector('a.expand');\r\n\t\t\t\t\t\t\t\t\t\tRESUtils.click(toggle);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tthisPost = $(thisAuthorObj).closest('.thing').get(0);\r\n\r\n\t\t\t\t\t\t\t\t\tif (thisPost) {\r\n\t\t\t\t\t\t\t\t\t\t// hide post block first...\r\n\t\t\t\t\t\t\t\t\t\tthisPost.style.display = 'none';\r\n\t\t\t\t\t\t\t\t\t\t// hide associated voting block...\r\n\t\t\t\t\t\t\t\t\t\tif (thisPost.previousSibling) {\r\n\t\t\t\t\t\t\t\t\t\t\tthisPost.previousSibling.style.display = 'none';\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (RESUtils.pageType() === 'comments') {\r\n\t\t\t\t\t\t\t\t\t// ignore comment\r\n\t\t\t\t\t\t\t\t\tignoreComment(thisAuthorObj, thisAuthor);\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tvar $thisPost, $thisMessage;\r\n\t\t\t\t\t\t\t\t\tif (RESUtils.pageType() === 'inbox') {\r\n\t\t\t\t\t\t\t\t\t\t$thisMessage = $(thisAuthorObj).closest('.thing');\r\n\t\t\t\t\t\t\t\t\t\t$thisPost = $thisMessage.find('.md');\r\n\r\n\t\t\t\t\t\t\t\t\t\t// If message, ignore message title also\r\n\t\t\t\t\t\t\t\t\t\tif (!$thisMessage.is('.was-comment')) {\r\n\t\t\t\t\t\t\t\t\t\t\t$thisMessage.find('.subject').text('Ignored message');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t$thisPost = $(thisAuthorObj).closest('.thing').find('p.title');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tthisPost = $thisPost[0];\r\n\r\n\t\t\t\t\t\t\t\t\tif (thisPost) {\r\n\t\t\t\t\t\t\t\t\t\tvar showLink = document.createElement('a');\r\n\t\t\t\t\t\t\t\t\t\tshowLink.textContent = 'show anyway?';\r\n\t\t\t\t\t\t\t\t\t\tshowLink.setAttribute('href', '#');\r\n\t\t\t\t\t\t\t\t\t\tshowLink.addEventListener('click', function(e) {\r\n\t\t\t\t\t\t\t\t\t\t\t$(this).parent().html($(this).parent().attr('data-original')).removeClass('ignoredUserPost').addClass('md');\r\n\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\tthisPost.setAttribute('data-original', thisPost.innerHTML);\r\n\t\t\t\t\t\t\t\t\t\tthisPost.textContent = thisAuthor + ' is an ignored user. ';\r\n\t\t\t\t\t\t\t\t\t\tthisPost.appendChild(showLink);\r\n\r\n\t\t\t\t\t\t\t\t\t\tthisPost.setAttribute('class', 'ignoredUserPost');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tfunction ignoreComment(thisAuthorObj, thisAuthor){\r\n\t\tvar thisComment = thisAuthorObj.parentNode.parentNode.querySelector('.usertext');\r\n\t\tif (thisComment) {\r\n\t\t\tvar showLink = document.createElement('a');\r\n\t\t\tshowLink.textContent = 'show anyway?';\r\n\t\t\tshowLink.setAttribute('href', '#');\r\n\t\t\tshowLink.addEventListener('click', function(e) {\r\n\t\t\t\t$(this).parent().html($(this).parent().attr('data-original')).removeClass('ignoredUserComment');\r\n\t\t\t\te.preventDefault();\r\n\t\t\t});\r\n\t\t\t// store original\r\n\t\t\tthisComment.setAttribute('data-original', thisComment.innerHTML);\r\n\t\t\t// remove comment\r\n\t\t\tthisComment.textContent = thisAuthor + ' is an ignored user.';\r\n\t\t\tthisComment.appendChild(showLink);\r\n\t\t\tthisComment.classList.add('ignoredUserComment');\r\n\t\t\treturn thisComment;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tfunction colorUser(obj, author, votes) {\r\n\t\tif (module.options.colorUser.value) {\r\n\t\t\tvotes = parseInt(votes, 10);\r\n\t\t\tvar red = 255;\r\n\t\t\tvar green = 255;\r\n\t\t\tvar blue = 255;\r\n\t\t\tvar voteString = '+';\r\n\t\t\tif (votes > 0) {\r\n\t\t\t\tred = Math.max(0, (255 - (8 * votes)));\r\n\t\t\t\tgreen = 255;\r\n\t\t\t\tblue = Math.max(0, (255 - (8 * votes)));\r\n\t\t\t} else if (votes < 0) {\r\n\t\t\t\tred = 255;\r\n\t\t\t\tgreen = Math.max(0, (255 - Math.abs(8 * votes)));\r\n\t\t\t\tblue = Math.max(0, (255 - Math.abs(8 * votes)));\r\n\t\t\t\tvoteString = '';\r\n\t\t\t}\r\n\t\t\tvoteString += votes;\r\n\t\t\tvar rgb = 'rgb(' + red + ',' + green + ',' + blue + ')';\r\n\t\t\tif (obj !== null) {\r\n\t\t\t\tif (votes === 0) {\r\n\t\t\t\t\tobj.style.display = 'none';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobj.style.display = 'inline';\r\n\t\t\t\t\tif (modules['nightMode'].isNightModeOn()) {\r\n\t\t\t\t\t\tobj.style.color = rgb;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tobj.style.backgroundColor = rgb;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (module.options.vwNumber.value) {\r\n\t\t\t\t\t\tobj.textContent = '[' + voteString + ']';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (module.options.vwTooltip.value) {\r\n\t\t\t\t\t\tobj.setAttribute('title', 'your votes for ' + escapeHTML(author) + ': ' + escapeHTML(voteString));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tmodule.ignoreUser = function(username, ignore) {\r\n\t\tvar thisName = username.toLowerCase(),\r\n\t\t\tthisIgnore = ignore !== false,\r\n\t\t\tthisColor, thisLink, thisVotes, thisTag;\r\n\t\tif (module.tags && module.tags[thisName]) {\r\n\t\t\tthisColor = module.tags[thisName].color || '';\r\n\t\t\tthisLink = module.tags[thisName].link || '';\r\n\t\t\tthisVotes = module.tags[thisName].votes || 0;\r\n\t\t\tthisTag = module.tags[thisName].tag || '';\r\n\t\t}\r\n\t\tif ((thisIgnore) && (thisTag === '')) {\r\n\t\t\tthisTag = 'ignored';\r\n\t\t} else if ((!thisIgnore) && (thisTag === 'ignored')) {\r\n\t\t\tthisTag = '';\r\n\t\t}\r\n\t\tsetUserTag(thisName, thisTag, thisColor, thisIgnore, thisLink, thisVotes, true /*noclick*/);\r\n\t};\r\n});\r\n"],"sourceRoot":"/source/"}
{"version":3,"sources":["modules/noParticipation.js"],"names":[],"mappings":"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","file":"modules/noParticipation.js","sourcesContent":["addModule('noParticipation', function(module, moduleID) {\r\n\tvar baseUrl =  [ location.protocol, '//', 'reddit.com' ].join('');\r\n\tvar urls = {\r\n\t\tmoreinfo: baseUrl + '/r/NoParticipation/wiki/intro',\r\n\t\trules: baseUrl + '/rules'\r\n\t};\r\n\r\n\tmodule.moduleName = 'No Participation';\r\n\tmodule.description = 'Helps discourage brigading and helps you avoid getting banned, by warning against voting \\\r\n\t\tor commenting when following \"No Participation\" (np) links, and by providing options to prevent you from \\\r\n\t\taccidentally participating. \\\r\n\t\t<p><a href=\"' + urls.moreinfo + '\" target=\"_blank\">Find out more about \"No Participation\".</a></p>';\r\n\r\n\tmodule.category = ['Comments', 'Subreddits'];\r\n\r\n\tmodule.options = {\r\n\t\tdisableVoteButtons: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Hide vote buttons. If you have already visited the page and voted, your prior votes will still be visible.',\r\n\t\t\tbodyClass: true\r\n\t\t},\r\n\t\tdisableCommentTextarea: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Disable commenting.',\r\n\t\t\tbodyClass: true\r\n\t\t},\r\n\t\tevenIfSubscriber: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Enable NP mode in subreddits where you\\'re a subscriber'\r\n\t\t},\r\n\t\tescapeNP: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Remove np mode when leaving a No-Participation page'\r\n\t\t}\r\n\t};\r\n\r\n\tmodule.include = [\r\n\t\t/^https?:\\/\\/(?:.*\\.)?(?:\\w+-)?np(?:-\\w+)?\\.reddit\\.com\\/*/i  // np.reddit.com, np-nm.reddit.com, nm-np.reddit.com, www.np.reddit.com, www.np-nm.reddit.com\r\n\t];\r\n\r\n\tvar boilerplateNotificationText = '\t\\\r\n\t\t<p><label class=\"RES-spoiler\">Hover here for more details</label> <span class=\"RES-spoiler-contents\">You came to this page by following a <a data-np=\"moreinfo\" target=\"_blank\">NP</a> link, so you may be interfering with normal conversation. \\\r\n\t\tPlease respect reddit\\'s <a data-np=\"rules\" target=\"_blank\">rules</a> by not commenting or voting. Violating these rules may get you banned.\\\r\n\t\t<a data-np=\"moreinfo\" target=\"_blank\">Find out more</a></span></p>';\r\n\r\n\tvar noParticipationActive;\r\n\r\n\tmodule.go = function() {\r\n\t\tif (this.isEnabled() && this.isMatchURL()) {\r\n\t\t\tif (module.options.escapeNP.value) {\r\n\t\t\t\tdocument.body.addEventListener('mousedown', removeNpFromLink);\r\n\t\t\t}\r\n\r\n\t\t\tif (isNPIrrelevant()) {\r\n\t\t\t\tnotifyNpIrrelevant();\r\n\t\t\t} else if (RESUtils.loggedInUser()) {\r\n\t\t\t\tif ((RESUtils.pageType() === 'comments' || RESUtils.pageType() === 'linklist') && !(document.body.classList.contains('front-page') || document.body.classList.contains('profile-page'))) {\r\n\t\t\t\t\tapplyNoParticipationMode();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnotifyNpIrrelevant();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tvar npHrefRegex = /^https?:\\/\\/(?:[\\w\\.]*)np\\.reddit\\.com\\//;\r\n\tvar removeNpRegexp = /^https?:\\/\\/(?:[\\w\\.]*)?reddit\\.com(.*)/;\r\n\tvar replaceNpWith = document.location.protocol + '//www.reddit.com';\r\n\tfunction removeNpFromLink(event) {\r\n\t\tvar elem = event.target, hrefSansNp;\r\n\t\tif (elem.tagName !== 'A') return;\r\n\t\tif (elem.matches('.md a')) return;\r\n\t\tvar href = elem.getAttribute('href');\r\n\t\tif (href[0] === '/') {\r\n\t\t\threfSansNp = replaceNpWith + href;\r\n\t\t} else if (npHrefRegex.test(href)) {\r\n\t\t\threfSansNp = replaceNpWith + href.match(removeNpRegexp)[1];\r\n\t\t}\r\n\r\n\t\tif (hrefSansNp) {\r\n\t\t\telem.setAttribute('href', hrefSansNp);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction isNPIrrelevant() {\r\n\t\tvar irrelevant = false;\r\n\t\tif (RESUtils.pageType() !== 'comments') {\r\n\t\t\tif (isSubscriber() && !module.options.evenIfSubscriber.value) {\r\n\t\t\t\tirrelevant = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn irrelevant;\r\n\t}\r\n\r\n\tmodule.isVotingBlocked = function() {\r\n\t\treturn noParticipationActive && module.options['disableVoteButtons'].value;\r\n\t};\r\n\tmodule.notifyNoVote = notifyNoVote;\r\n\r\n\tfunction isSubscriber() {\r\n\t\treturn (document.body.classList.contains('subscriber'));\r\n\t}\r\n\r\n\tfunction setLinkUrls(urls, container) {\r\n\t\t$(container).find('[data-np]').each(function(index, element) {\r\n\t\t\tvar key = element.getAttribute('data-np');\r\n\t\t\tvar url = urls[key] || baseUrl;\r\n\t\t\telement.setAttribute('href', url);\r\n\t\t});\r\n\t}\r\n\r\n\tfunction notifyNpIrrelevant() {\r\n\t\turls.leavenp = [ baseUrl, location.pathname, location.search, location.hash ].join('');\r\n\t\tvar message = 'You\\'re still browsing in <a data-np=\"moreinfo\" target=\"_blank\">No Participation</a> mode, but it\\'s no longer necessary.';\r\n\t\tif (isSubscriber()) {\r\n\t\t\tmessage = 'You\\'re browsing in <a data-np=\"moreinfo\" target=\"_blank\">No Participation</a> mode, but you\\'re a subscriber here.';\r\n\t\t}\r\n\r\n\t\tvar notification = modules['notifications'].showNotification({\r\n\t\t\tmoduleID: moduleID,\r\n\t\t\tnotificationID: 'ok-participation',\r\n\t\t\tcloseDelay: 3000,\r\n\t\t\theader: 'Okay to Participate',\r\n\t\t\tmessage: message + ' \\\r\n\t\t\t\t<p><a data-np=\"leavenp\">Click here to return to normal reddit</a></p>'\r\n\t\t});\r\n\r\n\t\tsetLinkUrls(urls, notification.element);\r\n\t}\r\n\r\n\tfunction notifyNpActive() {\r\n\t\tvar message  = '<strong><span class=\"res-icon\">&#xF15A;</span> Do not vote or comment.</strong>';\r\n\t\tif (isSubscriber()) {\r\n\t\t\tmessage = '<span class=\"res-icon\">&#xF15A;</span> Please think before you comment or vote, and remember the subreddit\\'s rules. Although you subscribe to this subreddit, you can still derail a particular thread.  <p><a data-np=\"leavenp\">Click here to return to normal reddit.</a></p>';\r\n\t\t}\r\n\t\tmessage += boilerplateNotificationText;\r\n\r\n\r\n\t\tvar notification = modules['notifications'].showNotification({\r\n\t\t\tmoduleID: moduleID,\r\n\t\t\tnotificationID: 'no-participation',\r\n\t\t\tcloseDelay: 10000,\r\n\t\t\theader: 'No Participation',\r\n\t\t\tmessage: message\r\n\t\t});\r\n\r\n\t\tsetLinkUrls(urls, notification.element);\r\n\t}\r\n\r\n\tvar votedOnButtons = [];\r\n\tfunction notifyNoVote(voteButton) {\r\n\t\tvar canUndoVote = $(voteButton).is('.upmod, .downmod');\r\n\r\n\t\tvar notification = modules['notifications'].showNotification({\r\n\t\t\tmoduleID: moduleID,\r\n\t\t\toptionKey: 'disableVoteButtons',\r\n\t\t\tcooldown: 5000,\r\n\t\t\theader: 'No Participation',\r\n\t\t\tmessage: '<strong><span class=\"res-icon\">&#xF15A;</span> Do not vote.</strong>' + boilerplateNotificationText +\r\n\t\t\t\t(canUndoVote ? '<p><button type=\"button\" class=\"redButton\" data-np=\"revertvote\">Undo vote</button></p>' : '')\r\n\t\t});\r\n\r\n\t\tif (notification) {\r\n\t\t\tsetLinkUrls(urls, notification.element);\r\n\t\t\t$(notification.element).find('[data-np=revertvote]').on('click', function(e) {\r\n\t\t\t\trevertVote(votedOnButtons, true);\r\n\t\t\t\tnotification.close();\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tvotedOnButtons.push(voteButton);\r\n\t}\r\n\r\n\tfunction notifyNoComment() {\r\n\t\tvar notification = modules['notifications'].showNotification({\r\n\t\t\tmoduleID: moduleID,\r\n\t\t\toptionKey: 'disableCommentTextarea',\r\n\t\t\theader: 'No Participation',\r\n\t\t\tmessage: '<strong><span class=\"res-icon\">&#xF15A;</span> Do not comment.</strong>' + boilerplateNotificationText\r\n\t\t});\r\n\r\n\t\tsetLinkUrls(urls, notification.element);\r\n\t}\r\n\r\n\tfunction applyNoParticipationMode() {\r\n\t\tnoParticipationActive = true;\r\n\r\n\t\tnotifyNpActive();\r\n\r\n\t\tRESUtils.bodyClasses.add('res-noParticipation');\r\n\r\n\t\twatchForVote();\r\n\t\tRESUtils.watchForElement('newComments', watchForVote);\r\n\r\n\t\twatchForComment();\r\n\t\tRESUtils.watchForElement('newCommentsForms', watchForComment);\r\n\t}\r\n\r\n\tfunction watchForVote(container) {\r\n\t\tcontainer = container || document.body;\r\n\r\n\t\t$(container).on('click', '.arrow', onClickVote);\r\n\t}\r\n\r\n\tfunction onClickVote(e) {\r\n\t\tonVote(e.target);\r\n\t}\r\n\r\n\tfunction onVote(voteButton) {\r\n\t\tif (!voteButton.classList.contains('upmod') && !voteButton.classList.contains('downmod')) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tnotifyNoVote(voteButton);\r\n\t}\r\n\r\n\tfunction revertVote(voteButtons, immediately) {\r\n\t\tif (!voteButtons.length) {\r\n\t\t\tvoteButtons = [ voteButtons ];\r\n\t\t}\r\n\t\tsetTimeout(_revertVote, (immediately ? 0 : 500));\r\n\r\n\t\tfunction _revertVote() {\r\n\t\t\tvoteButtons.forEach(function(voteButton, index) {\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tif (voteButton.classList.contains('upmod') || voteButton.classList.contains('downmod')) {\r\n\t\t\t\t\t\tRESUtils.click(voteButton);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, index * 2000 /* respect API limits */);\r\n\t\t\t});\r\n\r\n\t\t\tvar notification = modules['notifications'].showNotification({\r\n\t\t\t\tmoduleID: moduleID,\r\n\t\t\t\toptionKey: 'disableVoteButtons',\r\n\t\t\t\theader: 'No Participation',\r\n\t\t\t\tmessage: (voteButtons.length > 1 ? 'Your votes are being reverted.' : 'Your vote has been reverted.') + '\t\\\r\n\t\t\t\t\tPlease remember not to vote!\t\\\r\n\t\t\t\t\t<p><a data-np=\"moreinfo\" target=\"_blank\">Find out more</a></p>\t\\\r\n\t\t\t\t\t'\r\n\t\t\t});\r\n\t\t\tsetLinkUrls(urls, notification.element);\r\n\t\t}\r\n\t}\r\n\r\n\tvar alreadyNotified = false;\r\n\tfunction watchForComment(container) {\r\n\t\tcontainer = container || document.body;\r\n\r\n\t\tvar textareas = modules['commentTools'].getCommentTextarea(container);\r\n\r\n\t\ttextareas.one('keydown', function() {\r\n\t\t\tif (alreadyNotified) return;\r\n\t\t\talreadyNotified = true;\r\n\r\n\t\t\tnotifyNoComment();\r\n\t\t});\r\n\r\n\t\tif (module.options.disableCommentTextarea.value) {\r\n\t\t\ttextareas.attr('disabled', true);\r\n\t\t}\r\n\t}\r\n});\r\n"],"sourceRoot":"/source/"}
{"version":3,"sources":["modules/voteEnhancements.js"],"names":[],"mappings":"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","file":"modules/voteEnhancements.js","sourcesContent":["addModule('voteEnhancements', function(module, moduleID) {\r\n\tmodule.moduleName = 'Vote Enhancements';\r\n\tmodule.category = [ 'Appearance' ];\r\n\tmodule.description = 'Format or show additional information about votes on posts and comments.';\r\n\tmodule.options = {\r\n\t\testimatePostScore: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Calculate a post\\'s score from its points and \"liked\" percentage.',\r\n\t\t\tbodyClass: true\r\n\t\t},\r\n\t\testimatePostVotes: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Calculate the total number of votes.',\r\n\t\t\tbodyClass: true\r\n\t\t},\r\n\t\thighlightScores: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Bolden post and comment scores, making them easier to find.',\r\n\t\t\tbodyClass: true\r\n\t\t},\r\n\t\tcolorLinkScore: {\r\n\t\t\ttype: 'enum',\r\n\t\t\tvalues: [{\r\n\t\t\t\tname: 'No coloration',\r\n\t\t\t\tvalue: 'none'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Automatic coloration',\r\n\t\t\t\tvalue: 'automatic'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'User-defined coloration',\r\n\t\t\t\tvalue: 'user'\r\n\t\t\t}],\r\n\t\t\tvalue: 'none',\r\n\t\t\tdescription: 'Add color to a link\\'s score depending on its value.<br>\\\r\n\t\t\t\tThis does not work with reddit\\'s \"compressed link display\" preference.',\r\n\t\t\tbodyClass: true\r\n\t\t},\r\n\t\tuserDefinedLinkColoration: {\r\n\t\t\ttype: 'table',\r\n\t\t\taddRowText: '+add threshold',\r\n\t\t\tfields: [{\r\n\t\t\t\tname: 'score',\r\n\t\t\t\ttype: 'text'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'color',\r\n\t\t\t\ttype: 'color'\r\n\t\t\t}],\r\n\t\t\tvalue: [\r\n\t\t\t\t['0', '#5f99cf'],\r\n\t\t\t\t['10', '#F2B035'],\r\n\t\t\t\t['50', '#FF4500'],\r\n\t\t\t\t['100', '#D92B2B']\r\n\t\t\t],\r\n\t\t\tdescription: 'Choose a color for colorLinkScore with a threshold of your choice.',\r\n\t\t\tsort: function(a, b) { // sort field with score increasing\r\n\t\t\t\ta[0] = parseInt(a[0], 10);\r\n\t\t\t\tb[0] = parseInt(b[0], 10);\r\n\t\t\t\tif (a[0] < b[0]) {\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t}\r\n\t\t\t\tif (a[0] > b [0]) {\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t}\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t},\r\n\t\tcolorCommentScore: {\r\n\t\t\ttype: 'enum',\r\n\t\t\tvalues: [{\r\n\t\t\t\tname: 'No coloration',\r\n\t\t\t\tvalue: 'none'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Automatic coloration',\r\n\t\t\t\tvalue: 'automatic'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Reddit Classic',\r\n\t\t\t\tvalue: 'simple'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'User-defined coloration',\r\n\t\t\t\tvalue: 'user'\r\n\t\t\t}],\r\n\t\t\tvalue: 'none',\r\n\t\t\tdescription: 'Add color to a comment\\'s score depending on its value.',\r\n\t\t\tpresets: {\r\n\t\t\t\t'simple': [\r\n\t\t\t\t\t['0', '#9494FF'],\r\n\t\t\t\t\t['1', '#888'],\r\n\t\t\t\t\t['2', '#FF8B60']\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t},\r\n\t\tuserDefinedCommentColoration: {\r\n\t\t\ttype: 'table',\r\n\t\t\taddRowText: '+add threshold',\r\n\t\t\tfields: [{\r\n\t\t\t\tname: 'score',\r\n\t\t\t\ttype: 'text'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'color',\r\n\t\t\t\ttype: 'color'\r\n\t\t\t}],\r\n\t\t\tvalue: [\r\n\t\t\t\t['0', '#5f99cf'],\r\n\t\t\t\t['10', '#F2B035'],\r\n\t\t\t\t['50', '#FF4500'],\r\n\t\t\t\t['100', '#D92B2B']\r\n\t\t\t],\r\n\t\t\tdescription: 'Choose a color for colorLinkScore with a threshold of your choice.',\r\n\t\t\tsort: function(a, b) { // sort field with score increasing\r\n\t\t\t\ta[0] = parseInt(a[0], 10);\r\n\t\t\t\tb[0] = parseInt(b[0], 10);\r\n\t\t\t\tif (a[0] < b[0]) {\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t}\r\n\t\t\t\tif (a[0] > b [0]) {\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t}\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t},\r\n\t\thighlightControversial: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Add color to the \"controversial\" comment indicator.<br>This indicator can be enabled/disabled in your <a href=\"/prefs/#highlight_controversial\">reddit preferences</a>.'\r\n\t\t},\r\n\t\thighlightControversialColor: {\r\n\t\t\tdependsOn: 'highlightControversial',\r\n\t\t\tadvanced: true,\r\n\t\t\ttype: 'color',\r\n\t\t\tvalue: '#cc0000',\r\n\t\t\tdescription: 'Select a color for the \"controversial\" comment indicator.'\r\n\t\t}\r\n\t};\r\n\tmodule.includes = [ 'comments', 'linklist' ];\r\n\r\n\tmodule.go = function() {\r\n\t\tif ((module.isEnabled()) && (module.isMatchURL())) {\r\n\t\t\tif (RESUtils.pageType() === 'comments') {\r\n\t\t\t\tif (module.options.estimatePostScore.value || module.options.estimatePostVotes.value) {\r\n\t\t\t\t\testimatePostScoreVotes();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (module.options.colorLinkScore.value !== 'none') {\r\n\t\t\t\tapplyLinkScoreColor();\r\n\t\t\t\tRESUtils.watchForElement('siteTable', applyLinkScoreColor);\r\n\t\t\t}\r\n\t\t\tif (module.options.colorCommentScore.value !== 'none') {\r\n\t\t\t\tapplyCommentScoreColor();\r\n\t\t\t\tRESUtils.watchForElement('newComments', applyCommentScoreColor);\r\n\t\t\t\tRESUtils.watchForElement('siteTable', applyCommentScoreColor);\r\n\t\t\t}\r\n\t\t\tif (module.options.highlightControversial.value) {\r\n\t\t\t\thighlightControversial();\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tfunction estimatePostScoreVotes() {\r\n\t\tvar linkinfoScore = $('.linkinfo .score');\r\n\t\tif (linkinfoScore.length) {\r\n\t\t\tvar points = parseInt(linkinfoScore.find('.number').text().replace(/[^0-9]/g, ''), 10);\r\n\t\t\tvar percentage = parseInt((linkinfoScore.text().match(/([0-9]{1,3})\\s?%/) || [0, 0])[1], 10);\r\n\t\t\tif (points !== 0 && percentage !== 50) { // we can't estimate if percentage equal 50% (i.e. points equal zero) -- It's important to stop don't avoid divide by zero ! edit: if downvote>upvote we can't calculate too\r\n\t\t\t\tvar upvotes = Math.round(points*percentage/(2*percentage - 100));\r\n\t\t\t\tvar downvotes = upvotes-points;\r\n\t\t\t\tif (module.options.estimatePostScore.value) {\r\n\t\t\t\t\tlinkinfoScore.after('<span class=\"upvotes\"><span class=\"number\">' + RESUtils.createElement.commaDelimitedNumber(upvotes) + '</span> <span class=\"word\">' + (upvotes === 1 ? 'upvote' : 'upvotes') + '</span></span> <span class=\"downvotes\"><span class=\"number\">' + RESUtils.createElement.commaDelimitedNumber(downvotes) + '</span> <span class=\"word\">' + (downvotes === 1 ? 'downvote' : 'downvotes') + '</span></span> ');\r\n\t\t\t\t}\r\n\t\t\t\tif (module.options.estimatePostVotes.value) {\r\n\t\t\t\t\tvar totalVotes = upvotes + downvotes;\r\n\t\t\t\t\tlinkinfoScore.after('<span class=\"totalvotes\"><span class=\"number\">' + RESUtils.createElement.commaDelimitedNumber(totalVotes) + '</span> <span class=\"word\">' + (totalVotes === 1 ? 'vote' : 'votes') + '</span></span></span> ');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getLinkScoreColor(score) {\r\n\t\tif (isNaN(score)) {\r\n\t\t\treturn '#c6c6c6';\r\n\t\t}\r\n\r\n\t\tif (module.options.colorLinkScore.value === 'automatic') {\r\n\t\t\treturn 'hsl(' + 180+360*(1-100/(150+score)) + ', 75%,50%)';\r\n\t\t} else {\r\n\t\t\tif (module.options.userDefinedLinkColoration.value.length) {\r\n\t\t\t\tfor (var len = module.options.userDefinedLinkColoration.value.length, i = len-1; i >= 0; i--) {\r\n\t\t\t\t\tif (score >= module.options.userDefinedLinkColoration.value[i][0]) {\r\n\t\t\t\t\t\treturn module.options.userDefinedLinkColoration.value[i][1];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn module.options.userDefinedLinkColoration.value[0][1];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getCommentScoreColor(score) {\r\n\t\tif (isNaN(score)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (module.options.colorCommentScore.value === 'automatic') {\r\n\t\t\treturn 'hsl(' + 180+360*(1-50/(100+score)) + ', 75%,50%)';\r\n\t\t} else {\r\n\t\t\tvar colors = (module.options.colorCommentScore.value === 'user') ? module.options.userDefinedCommentColoration.value : module.options.colorCommentScore.presets[module.options.colorCommentScore.value];\r\n\t\t\tif (colors.length) {\r\n\t\t\t\tfor (var len = colors.length, i = len-1; i >= 0; i--) {\r\n\t\t\t\t\tif (score >= colors[i][0]) {\r\n\t\t\t\t\t\treturn colors[i][1];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn colors[0][1]; // As a comment can have a -9999 score, we use the first color if no threshold have been triggered\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction applyLinkScoreColor(ele) {\r\n\t\tele = ele || document;\r\n\r\n\t\tvar scoreNodes = ele.querySelectorAll('#siteTable .midcol>.score');\r\n\r\n\t\tRESUtils.forEachChunked(scoreNodes, 25, 300, function(node) {\r\n\t\t\tvar score = parseInt(node.textContent, 10);\r\n\r\n\t\t\tvar addBackgroundTo = $(node).closest('.thing').find('.rank')[0];\r\n\t\t\tvar color = getLinkScoreColor(score);\r\n\r\n\t\t\tif (addBackgroundTo && color) {\r\n\t\t\t\taddBackgroundTo.style.background = color;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tfunction applyCommentScoreColor(ele) {\r\n\t\tele = ele || document;\r\n\r\n\t\tvar scoreNodes = ele.querySelectorAll('.tagline>.score');\r\n\r\n\t\tRESUtils.forEachChunked(scoreNodes, 20, 1000, function(node) {\r\n\t\t\tvar score = parseInt(node.textContent, 10);\r\n\r\n\t\t\tvar addBackgroundTo = node;\r\n\t\t\tvar color = getCommentScoreColor(score);\r\n\r\n\t\t\tif (addBackgroundTo && color) {\r\n\t\t\t\taddBackgroundTo.style.color = color;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tfunction highlightControversial() {\r\n\t\tvar color = module.options.highlightControversialColor.value || module.options.highlightControversialColor.default;\r\n\t\tvar style = '.comment.controversial>.entry .score:after { color: ' + color + '; }';\r\n\t\tRESUtils.addCSS(style);\r\n\t}\r\n});\r\n"],"sourceRoot":"/source/"}
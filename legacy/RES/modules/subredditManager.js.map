{"version":3,"sources":["modules/subredditManager.js"],"names":[],"mappings":"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","file":"modules/subredditManager.js","sourcesContent":["addModule('subredditManager', function(module, moduleID) {\r\n\tmodule.moduleName = 'Subreddit Manager';\r\n\tmodule.category = ['Subreddits'];\r\n\tmodule.description = 'Allows you to customize the top bar with your own subreddit shortcuts, including dropdown menus of multi-reddits and more.';\r\n\tmodule.options = {\r\n\t\tsubredditShortcut: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Add +shortcut button in subreddit sidebar for easy addition of shortcuts.'\r\n\t\t},\r\n\t\tshortcutsPerAccount: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Show personalized shortcuts for each account'\r\n\t\t},\r\n\t\talwaysApplySuffixToMulti: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'For multi-subreddit shortcuts like a+b+c/x, show a dropdown like a/x, b/x, c/x'\r\n\t\t},\r\n\t\tdropdownEditButton: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Show \"edit\" and \"delete\" buttons in dropdown menu on subreddit shortcut bar'\r\n\t\t},\r\n\t\tshortcutDropdownDelay: {\r\n\t\t\ttype: 'text',\r\n\t\t\tvalue: 200,\r\n\t\t\tdescription: 'How long (in milliseconds) to wait after moving your mouse over a shortcut to show its dropdown. (This particularly applies for shortcuts to multi-subreddits like sub1+sub2+sub3.)'\r\n\t\t},\r\n\t\tshortcutEditDropdownDelay: {\r\n\t\t\tdependsOn: 'dropdownEditButton',\r\n\t\t\ttype: 'text',\r\n\t\t\tvalue: 3000,\r\n\t\t\tdescription: 'How long (in milliseconds) to wait after moving your mouse over a shortcut to show its dropdown edit buttons. (This particularly applies to just the edit/delete button dropdown.)'\r\n\t\t},\r\n\t\tallowLowercase: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Allow lowercase letters in shortcuts instead of forcing uppercase',\r\n\t\t\tbodyClass: true\r\n\t\t},\r\n\t\tlinkDashboard: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Show \"DASHBOARD\" link in subreddit manager'\r\n\t\t},\r\n\t\tlinkAll: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Show \"ALL\" link in subreddit manager'\r\n\t\t},\r\n\t\tlinkFront: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'show \"FRONT\" link in subreddit manager'\r\n\t\t},\r\n\t\tlinkRandom: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Show \"RANDOM\" link in subreddit manager'\r\n\t\t},\r\n\t\tlinkMyRandom: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Show \"MYRANDOM\" link in subreddit manager (reddit gold only)'\r\n\t\t},\r\n\t\tlinkRandNSFW: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: false,\r\n\t\t\tdescription: 'Show \"RANDNSFW\" link in subreddit manager'\r\n\t\t},\r\n\t\tlinkFriends: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Show \"FRIENDS\" link in subreddit manager'\r\n\t\t},\r\n\t\tlinkMod: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Show \"MOD\" link in subreddit manager'\r\n\t\t},\r\n\t\tlinkModqueue: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Show \"MODQUEUE\" link in subreddit manager'\r\n\t\t},\r\n\t\tbuttonEdit: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Show \"EDIT\" button in subreddit manager'\r\n\t\t},\r\n\t\tlastUpdate: {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tvalue: true,\r\n\t\t\tdescription: 'Show last update information on the front page (work only if you have at least 50/100 subscription, see <a href=\"/r/help/wiki/faq#wiki_some_of_my_subreddits_keep_disappearing.__why.3F\">here</a> for more info).'\r\n\t\t}\r\n\t\t/*\t\tsortingField: {\r\n\t\t\ttype: 'enum',\r\n\t\t\tvalues: [\r\n\t\t\t\t{ name: 'Subreddit Name', value: 'displayName' },\r\n\t\t\t\t{ name: 'Added date', value: 'addedDate' }\r\n\t\t\t],\r\n\t\t\tvalue : 'displayName',\r\n\t\t\tdescription: 'Field to sort subreddit shortcuts by'\r\n\t\t},\r\n\t\tsortingDirection: {\r\n\t\t\ttype: 'enum',\r\n\t\t\tvalues: [\r\n\t\t\t\t{ name: 'Ascending', value: 'asc' },\r\n\t\t\t\t{ name: 'Descending', value: 'desc' }\r\n\t\t\t],\r\n\t\t\tvalue : 'asc',\r\n\t\t\tdescription: 'Field to sort subreddit shortcuts by'\r\n\t\t}\r\n*/\r\n\t};\r\n\r\n\tvar shortCutsContainer, hoveredSubredditShortcut, subredditGroupDropdown, subredditGroupDropdownUL, srList,\r\n\t\teditShortcutDialog, deleteButton, sortMenu, gettingSubreddits, subredditsLastViewed;\r\n\r\n\tmodule.go = function() {\r\n\t\tif ((this.isEnabled()) && (this.isMatchURL())) {\r\n\r\n\t\t\tif (this.options.linkMyRandom.value) {\r\n\t\t\t\tvar originalMyRandom = document.querySelector('#sr-header-area a[href$=\"/r/myrandom/\"]');\r\n\t\t\t\tif (originalMyRandom) {\r\n\t\t\t\t\tthis.myRandomEnabled = true;\r\n\t\t\t\t\tif (originalMyRandom.classList.contains('gold')) {\r\n\t\t\t\t\t\tthis.myRandomGold = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (this.options.lastUpdate.value && document.getElementsByClassName('listing-chooser').length) {\r\n\t\t\t\tlastUpdate();\r\n\t\t\t}\r\n\r\n\t\t\tmanageSubreddits();\r\n\t\t\tif (RESUtils.currentSubreddit() !== null) {\r\n\t\t\t\tsetLastViewtime();\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tfunction manageSubreddits() {\r\n\t\t// This is the init function for Manage Subreddits - it'll get your preferences and redraw the top bar.\r\n\t\tredrawSubredditBar();\r\n\t\t// Listen for subscriptions / unsubscriptions from reddits so we know to reload the JSON string...\r\n\t\t// also, add a +/- shortcut button...\r\n\t\tif (RESUtils.currentSubreddit() && module.options.subredditShortcut.value) {\r\n\t\t\tvar subButtons = document.querySelectorAll('.side .fancy-toggle-button');\r\n\t\t\tArray.prototype.slice.call(subButtons).forEach(function(subButton) {\r\n\t\t\t\tvar thisSubredditFragment, isMulti;\r\n\t\t\t\tif ((RESUtils.currentSubreddit().indexOf('+') === -1) && (RESUtils.currentSubreddit() !== 'mod')) {\r\n\t\t\t\t\tthisSubredditFragment = RESUtils.currentSubreddit();\r\n\t\t\t\t\tisMulti = false;\r\n\t\t\t\t} else if ($(subButton).parent().hasClass('subButtons')) {\r\n\t\t\t\t\tthisSubredditFragment = $(subButton).parent().parent().find('a.title').text();\r\n\t\t\t\t\tisMulti = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthisSubredditFragment = $(subButton).next().text();\r\n\t\t\t\t\tisMulti = true;\r\n\t\t\t\t}\r\n\t\t\t\tif ($('#subButtons-' + thisSubredditFragment).length === 0) {\r\n\t\t\t\t\tvar subButtonsWrapper = $('<div id=\"subButtons-' + thisSubredditFragment + '\" class=\"subButtons\" style=\"margin: 0 !important; top: 0 !important; z-index: 1 !important;\"></div>');\r\n\t\t\t\t\t$(subButton).wrap(subButtonsWrapper);\r\n\t\t\t\t\t// move this wrapper to the end (after any icons that may exist...)\r\n\t\t\t\t\tif (isMulti) {\r\n\t\t\t\t\t\tvar theWrap = $(subButton).parent();\r\n\t\t\t\t\t\t$(theWrap).appendTo($(theWrap).parent());\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tsubButton.addEventListener('click', function() {\r\n\t\t\t\t\t// reset the last checked time for the subreddit list so that we refresh it anew no matter what.\r\n\t\t\t\t\tRESStorage.setItem('RESmodules.subredditManager.subreddits.lastCheck.' + RESUtils.loggedInUser(), 0);\r\n\t\t\t\t}, false);\r\n\t\t\t\tvar theSC = document.createElement('span');\r\n\t\t\t\ttheSC.setAttribute('class', 'res-fancy-toggle-button RESshortcut RESshortcutside');\r\n\t\t\t\ttheSC.setAttribute('data-subreddit', thisSubredditFragment);\r\n\t\t\t\tvar idx = module.mySubredditShortcuts.findIndex(function(shortcut) {\r\n\t\t\t\t\treturn shortcut.subreddit.toLowerCase() === thisSubredditFragment.toLowerCase();\r\n\t\t\t\t});\r\n\t\t\t\tif (idx !== -1) {\r\n\t\t\t\t\ttheSC.textContent = '-shortcut';\r\n\t\t\t\t\ttheSC.setAttribute('title', 'Remove this subreddit from your shortcut bar');\r\n\t\t\t\t\ttheSC.classList.add('remove');\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttheSC.textContent = '+shortcut';\r\n\t\t\t\t\ttheSC.setAttribute('title', 'Add this subreddit to your shortcut bar');\r\n\t\t\t\t}\r\n\t\t\t\ttheSC.addEventListener('click', module.toggleSubredditShortcut, false);\r\n\t\t\t\t// subButton.parentNode.insertBefore(theSC, subButton);\r\n\t\t\t\t// theSubredditLink.appendChild(theSC);\r\n\t\t\t\t$('#subButtons-' + thisSubredditFragment).append(theSC);\r\n\t\t\t\tvar next = $('#subButtons-' + thisSubredditFragment).next();\r\n\t\t\t\tif ($(next).hasClass('title') && (!$('#subButtons-' + thisSubredditFragment).hasClass('swapped'))) {\r\n\t\t\t\t\t$('#subButtons-' + thisSubredditFragment).before($(next));\r\n\t\t\t\t\t$('#subButtons-' + thisSubredditFragment).addClass('swapped');\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// If we're on the reddit-browsing page (/reddits or /subreddits), add +shortcut and -shortcut buttons...\r\n\t\tif (/^https?:\\/\\/www\\.reddit\\.com\\/(?:sub)?reddits\\/?(?:\\?[\\w=&]+)*/.test(location.href)) {\r\n\t\t\tmodule.browsingReddits();\r\n\t\t}\r\n\t}\r\n\r\n\tmodule.browsingReddits = function() {\r\n\t\t$('.subreddit').each(function() {\r\n\t\t\t// Skip subreddit links that already have a shortcut button\r\n\t\t\tif (typeof $(this).data('hasShortcutButton') !== 'undefined' && $(this).data('hasShortcutButton')) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Otherwise, indicate that this link now has a shortcut button\r\n\t\t\t$(this).data('hasShortcutButton', true);\r\n\r\n\t\t\tvar subreddit = $(this).find('a.title').attr('href').match(/^https?:\\/\\/(?:[a-z]+).reddit.com\\/r\\/([\\w]+).*/i)[1],\r\n\t\t\t\t$theSC = $('<span>')\r\n\t\t\t\t\t.css({'margin-right': '0'})\r\n\t\t\t\t\t.addClass('res-fancy-toggle-button')\r\n\t\t\t\t\t.data('subreddit', subreddit),\r\n\t\t\t\tisShortcut = module.mySubredditShortcuts.some(function(shortcut) {\r\n\t\t\t\t\treturn shortcut.subreddit === subreddit;\r\n\t\t\t\t});\r\n\r\n\t\t\tif (isShortcut) {\r\n\t\t\t\t$theSC\r\n\t\t\t\t\t.attr('title', 'Remove this subreddit from your shortcut bar')\r\n\t\t\t\t\t.text('-shortcut')\r\n\t\t\t\t\t.addClass('remove');\r\n\t\t\t} else {\r\n\t\t\t\t$theSC\r\n\t\t\t\t\t.attr('title', 'Add this subreddit to your shortcut bar')\r\n\t\t\t\t\t.text('+shortcut')\r\n\t\t\t\t\t.removeClass('remove');\r\n\t\t\t}\r\n\r\n\t\t\t$theSC\r\n\t\t\t\t.on('click', module.toggleSubredditShortcut)\r\n\t\t\t\t.appendTo($(this).find('.midcol'));\r\n\t\t});\r\n\t};\r\n\r\n\tvar clickedShortcut, clickTimer, hideSubredditGroupDropdownTimer, showSubredditGroupDropdownTimer;\r\n\r\n\tfunction redrawShortcuts() {\r\n\t\tshortCutsContainer.textContent = '';\r\n\t\t// Try Refresh subreddit shortcuts\r\n\t\tif (module.mySubredditShortcuts.length === 0) {\r\n\t\t\tgetLatestShortcuts();\r\n\t\t}\r\n\t\tif (module.mySubredditShortcuts.length > 0) {\r\n\t\t\t// go through the list of shortcuts and print them out...\r\n\t\t\tmodule.mySubredditShortcuts = module.mySubredditShortcuts.map(function(shortcut, i) {\r\n\t\t\t\tif (typeof shortcut === 'string') {\r\n\t\t\t\t\tshortcut = {\r\n\t\t\t\t\t\tsubreddit: shortcut,\r\n\t\t\t\t\t\tdisplayName: shortcut,\r\n\t\t\t\t\t\taddedDate: Date.now()\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar thisShortCut = document.createElement('a');\r\n\t\t\t\tthisShortCut.setAttribute('draggable', 'true');\r\n\t\t\t\tthisShortCut.setAttribute('orderIndex', i);\r\n\t\t\t\tthisShortCut.setAttribute('data-subreddit', shortcut.subreddit);\r\n\t\t\t\tthisShortCut.classList.add('subbarlink');\r\n\r\n\t\t\t\tif ((RESUtils.currentSubreddit() !== null) && (RESUtils.currentSubreddit().toLowerCase() === shortcut.subreddit.toLowerCase())) {\r\n\t\t\t\t\tthisShortCut.classList.add('RESShortcutsCurrentSub');\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthisShortCut.setAttribute('href', '/r/' + shortcut.subreddit);\r\n\t\t\t\tthisShortCut.textContent = shortcut.displayName;\r\n\t\t\t\tthisShortCut.addEventListener('click', function(e) {\r\n\t\t\t\t\tif (e.button !== 0 || e.ctrlKey || e.metaKey || e.altKey || e.shiftKey) {\r\n\t\t\t\t\t\t// open in new tab, let the browser handle it\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t// use to open links in new tabs... work on this later...\r\n\t\t\t\t\t\tclickedShortcut = e.target.getAttribute('href');\r\n\t\t\t\t\t\tif (typeof clickTimer === 'undefined') {\r\n\t\t\t\t\t\t\tclickTimer = setTimeout(followSubredditShortcut, 300);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}, false);\r\n\r\n\t\t\t\tthisShortCut.addEventListener('dblclick', function(e) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tclearTimeout(clickTimer);\r\n\t\t\t\t\tclickTimer = undefined;\r\n\t\t\t\t\thideSubredditGroupDropdown();\r\n\t\t\t\t\teditSubredditShortcut(e.target);\r\n\t\t\t\t}, false);\r\n\r\n\t\t\t\tthisShortCut.addEventListener('mouseover', function(e) {\r\n\t\t\t\t\tclearTimeout(hideSubredditGroupDropdownTimer);\r\n\t\t\t\t\tshowSubredditGroupDropdown(e.target);\r\n\t\t\t\t}, false);\r\n\r\n\t\t\t\tthisShortCut.addEventListener('mouseout', function(e) {\r\n\t\t\t\t\tclearTimeout(showSubredditGroupDropdownTimer);\r\n\t\t\t\t\thideSubredditGroupDropdownTimer = setTimeout(function() {\r\n\t\t\t\t\t\thideSubredditGroupDropdown();\r\n\t\t\t\t\t}, 500);\r\n\t\t\t\t}, false);\r\n\r\n\t\t\t\tthisShortCut.addEventListener('dragstart', subredditDragStart, false);\r\n\t\t\t\tthisShortCut.addEventListener('dragenter', subredditDragEnter, false);\r\n\t\t\t\tthisShortCut.addEventListener('dragover', subredditDragOver, false);\r\n\t\t\t\tthisShortCut.addEventListener('dragleave', subredditDragLeave, false);\r\n\t\t\t\tthisShortCut.addEventListener('drop', subredditDrop, false);\r\n\t\t\t\tthisShortCut.addEventListener('dragend', subredditDragEnd, false);\r\n\t\t\t\tshortCutsContainer.appendChild(thisShortCut);\r\n\r\n\t\t\t\tif (i < module.mySubredditShortcuts.length - 1) {\r\n\t\t\t\t\tvar sep = document.createElement('span');\r\n\t\t\t\t\tsep.setAttribute('class', 'separator');\r\n\t\t\t\t\tsep.textContent = '-';\r\n\t\t\t\t\tshortCutsContainer.appendChild(sep);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn shortcut;\r\n\t\t\t}, this);\r\n\t\t\tif (module.mySubredditShortcuts.length === 0) {\r\n\t\t\t\tshortCutsContainer.style.textTransform = 'none';\r\n\t\t\t\tshortCutsContainer.textContent = 'add shortcuts from the my subreddits menu at left or click the button by the subreddit name, drag and drop to sort';\r\n\t\t\t} else {\r\n\t\t\t\tshortCutsContainer.style.textTransform = '';\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tshortCutsContainer.style.textTransform = 'none';\r\n\t\t\tshortCutsContainer.textContent = 'add shortcuts from the my subreddits menu at left or click the button by the subreddit name, drag and drop to sort';\r\n\t\t\tmodule.mySubredditShortcuts = [];\r\n\t\t}\r\n\t}\r\n\r\n\tfunction showSubredditGroupDropdown(obj) {\r\n\t\tvar subreddits = [];\r\n\t\tvar suffix = '';\r\n\r\n\t\tif ((typeof obj.getAttribute !== 'undefined') && (obj.getAttribute('href').indexOf('+') !== -1)) {\r\n\t\t\tvar cleanSubreddits = obj.getAttribute('href').replace('/r/', '').replace('/r/', '');\r\n\r\n\t\t\tif (cleanSubreddits.indexOf('/') > cleanSubreddits.lastIndexOf('+') || module.options.alwaysApplySuffixToMulti.value) {\r\n\t\t\t\t// for shortcuts like a+b/x, use subreddits=a+b ; suffix = x\r\n\t\t\t\t// for shortcuts like a/x+b/y, just split them a la pre-4.5.0\r\n\t\t\t\tvar pos;\r\n\t\t\t\tif ((pos = cleanSubreddits.lastIndexOf('?')) > cleanSubreddits.lastIndexOf('+')) {\r\n\t\t\t\t\tsuffix = cleanSubreddits.substr(pos);\r\n\t\t\t\t\tcleanSubreddits = cleanSubreddits.substr(0, pos);\r\n\t\t\t\t}\r\n\t\t\t\tif ((pos = cleanSubreddits.lastIndexOf('/')) > cleanSubreddits.lastIndexOf('+')) { // check both existance and correct form (i.e. not foo/new+bar)\r\n\t\t\t\t\tsuffix = cleanSubreddits.substr(pos) + suffix;\r\n\t\t\t\t\tcleanSubreddits = cleanSubreddits.substr(0, pos);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tsubreddits = cleanSubreddits.split('+');\r\n\t\t}\r\n\r\n\t\tif (!(subreddits.length || module.options.dropdownEditButton.value)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar delay;\r\n\r\n\t\tif (subreddits.length) {\r\n\t\t\tdelay = parseInt(module.options.shortcutDropdownDelay.value, 10);\r\n\t\t} else {\r\n\t\t\tdelay = parseInt(module.options.shortcutEditDropdownDelay.value, 10);\r\n\t\t}\r\n\r\n\t\tif (typeof delay !== 'number') {\r\n\t\t\tdelay = parseInt(module.options.subredditShortcutDropdownDelay.default, 10);\r\n\t\t}\r\n\r\n\t\tclearTimeout(showSubredditGroupDropdownTimer);\r\n\t\tshowSubredditGroupDropdownTimer = setTimeout(\r\n\t\t\t_showSubredditGroupDropdown.bind(null, obj, subreddits, suffix),\r\n\t\t\tdelay);\r\n\t}\r\n\r\n\tfunction _showSubredditGroupDropdown(obj, subreddits, suffix) {\r\n\t\thoveredSubredditShortcut = obj;\r\n\r\n\t\t// Show dropdown after an appropriate delay\r\n\t\tif (!subredditGroupDropdown) {\r\n\t\t\tsubredditGroupDropdown = RESUtils.createElement('div', 'RESSubredditGroupDropdown');\r\n\t\t\tsubredditGroupDropdownUL = document.createElement('ul');\r\n\t\t\tsubredditGroupDropdown.appendChild(subredditGroupDropdownUL);\r\n\r\n\t\t\tif (module.options.dropdownEditButton.value) {\r\n\t\t\t\t$('\t\\\r\n\t\t\t\t\t<div class=\"RESShortcutsEditButtons\">\t\\\r\n\t\t\t\t\t\t<a href=\"#\"  class=\"delete res-icon\" title=\"delete\">&#xF056;</a>\t\\\r\n\t\t\t\t\t\t<a href=\"#\" class=\"edit res-icon\" title=\"edit\">&#xF139;</a>\t\\\r\n\t\t\t\t\t</div>\t\\\r\n\t\t\t\t\t').appendTo(subredditGroupDropdown);\r\n\t\t\t}\r\n\t\t\tdocument.body.appendChild(subredditGroupDropdown);\r\n\r\n\t\t\tsubredditGroupDropdown.addEventListener('mouseout', function(e) {\r\n\t\t\t\thideSubredditGroupDropdownTimer = setTimeout(function() {\r\n\t\t\t\t\thideSubredditGroupDropdown();\r\n\t\t\t\t}, 500);\r\n\t\t\t}, false);\r\n\r\n\t\t\tsubredditGroupDropdown.addEventListener('mouseover', function(e) {\r\n\t\t\t\tclearTimeout(hideSubredditGroupDropdownTimer);\r\n\t\t\t}, false);\r\n\r\n\t\t\t$(subredditGroupDropdown).on('click', '.edit', function(e) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\thideSubredditGroupDropdown();\r\n\t\t\t\teditSubredditShortcut(hoveredSubredditShortcut);\r\n\t\t\t});\r\n\r\n\t\t\t$(subredditGroupDropdown).on('click', '.delete', function(e) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\thideSubredditGroupDropdown();\r\n\t\t\t\teditSubredditShortcut(hoveredSubredditShortcut);\r\n\t\t\t\tdeleteButton.click();\r\n\t\t\t});\r\n\r\n\t\t}\r\n\r\n\t\t$(subredditGroupDropdownUL).find('li:not(.RESShortcutsEditButtons)').remove();\r\n\r\n\t\tif (subreddits) {\r\n\t\t\tvar $rows = $();\r\n\t\t\tsubreddits.forEach(function(subreddit) {\r\n\t\t\t\tvar thisLI = $('<li><a href=\"/r/' + subreddit + suffix + '\">' + subreddit + '<span class=\"shortcutSuffix\">' + suffix + '</span>' + '</a></li>');\r\n\t\t\t\t$rows = $rows.add(thisLI);\r\n\t\t\t\tif (RESUtils.currentSubreddit() === subreddit) {\r\n\t\t\t\t\tthisLI.addClass('RESShortcutsCurrentSub');\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$(subredditGroupDropdownUL).prepend($rows);\r\n\r\n\t\t}\r\n\r\n\t\tvar thisXY = RESUtils.getXYpos(obj);\r\n\t\tsubredditGroupDropdown.style.top = (thisXY.y + 16) + 'px';\r\n\t\t// if fixed, override y to just be the height of the subreddit bar...\r\n\t\t// subredditGroupDropdown.style.position = 'fixed';\r\n\t\t// subredditGroupDropdown.style.top = '20px';\r\n\t\tsubredditGroupDropdown.style.left = thisXY.x + 'px';\r\n\t\tsubredditGroupDropdown.style.display = 'block';\r\n\r\n\t\tmodules['styleTweaks'].setSRStyleToggleVisibility(false, 'subredditGroupDropdown');\r\n\t}\r\n\r\n\tfunction hideSubredditGroupDropdown() {\r\n\t\thideSubredditGroupDropdownTimer = undefined;\r\n\t\tif (subredditGroupDropdown) {\r\n\t\t\tsubredditGroupDropdown.style.display = 'none';\r\n\t\t\tmodules['styleTweaks'].setSRStyleToggleVisibility(true, 'subredditGroupDropdown');\r\n\t\t}\r\n\t}\r\n\r\n\tfunction editSubredditShortcut(ele) {\r\n\t\tvar subreddit = ele.getAttribute('href').slice(3);\r\n\r\n\t\tvar idx = module.mySubredditShortcuts.findIndex(function(shortcut) {\r\n\t\t\treturn shortcut.subreddit === subreddit;\r\n\t\t});\r\n\r\n\t\tif (!editShortcutDialog) {\r\n\t\t\teditShortcutDialog = RESUtils.createElement('div', 'editShortcutDialog');\r\n\t\t\tdocument.body.appendChild(editShortcutDialog);\r\n\t\t}\r\n\r\n\t\tvar thisForm = '<form name=\"editSubredditShortcut\"> \\\r\n\t\t\t<h3>Edit Shortcut</h3> \\\r\n\t\t\t<div id=\"editShortcutClose\" class=\"RESCloseButton\">&times;</div> \\\r\n\t\t\t<div class=\"RESFormItem\"> \\\r\n\t\t\t\t<label for=\"subreddit\">Subreddit:</label> \\\r\n\t\t\t\t<div class=\"RESFieldItem\"> \\\r\n\t\t\t\t\t<button type=\"submit\" id=\"sortButton\" title=\"Sort subreddits\">A-Z</button><!-- no whitespace \\\r\n\t\t\t\t\t--><input type=\"text\" name=\"subreddit\" value=\"' + subreddit + '\" id=\"shortcut-subreddit\"> \\\r\n\t\t\t\t\t<div class=\"RESDescription\">Put a + between subreddits to make a drop-down menu.</div> \\\r\n\t\t\t\t</div> \\\r\n\t\t\t</div> \\\r\n\t\t\t<div class=\"RESFormItem\"> \\\r\n\t\t\t\t<label for=\"displayName\">Display Name:</label> \\\r\n\t\t\t\t<div class=\"RESFieldItem\"> \\\r\n\t\t\t\t\t<input type=\"text\" name=\"displayName\" value=\"' + ele.textContent + '\" id=\"shortcut-displayname\"> \\\r\n\t\t\t\t</div> \\\r\n\t\t\t</div> \\\r\n\t\t\t<input type=\"hidden\" name=\"idx\" value=\"' + idx + '\"> \\\r\n\t\t\t<button type=\"button\" name=\"shortcut-save\" id=\"shortcut-save\">save</button> \\\r\n\t\t\t<button type=\"button\" name=\"shortcut-delete\" id=\"shortcut-delete\">delete</button> \\\r\n\t\t</form>';\r\n\t\t$(editShortcutDialog).html(thisForm);\r\n\r\n\t\tvar subredditInput = editShortcutDialog.querySelector('input[name=subreddit]');\r\n\t\tvar displayNameInput = editShortcutDialog.querySelector('input[name=displayName]');\r\n\r\n\t\tvar subredditForm = editShortcutDialog.querySelector('FORM');\r\n\t\tsubredditForm.addEventListener('submit', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t}, false);\r\n\r\n\t\tvar saveButton = editShortcutDialog.querySelector('button[name=shortcut-save]');\r\n\t\tsaveButton.addEventListener('click', function(e) {\r\n\t\t\tvar idx = editShortcutDialog.querySelector('input[name=idx]').value;\r\n\t\t\tvar subreddit = editShortcutDialog.querySelector('input[name=subreddit]').value;\r\n\t\t\tvar displayName = editShortcutDialog.querySelector('input[name=displayName]').value;\r\n\r\n\t\t\tsaveSubredditShortcut(subreddit, displayName, idx);\r\n\t\t\teditShortcutDialog.style.display = 'none';\r\n\t\t}, false);\r\n\r\n\t\tdeleteButton = editShortcutDialog.querySelector('button[name=shortcut-delete]');\r\n\t\tdeleteButton.addEventListener('click', function(e) {\r\n\t\t\tvar idx = editShortcutDialog.querySelector('input[name=idx]').value;\r\n\r\n\t\t\tif (confirm('Are you sure you want to delete this shortcut?')) {\r\n\t\t\t\tsaveSubredditShortcut('', '', idx);\r\n\t\t\t\teditShortcutDialog.style.display = 'none';\r\n\t\t\t}\r\n\t\t}, false);\r\n\r\n\t\t// Allow the shortcut dropdown menu to be sorted\r\n\t\tfunction sortSubmenu(e) {\r\n\t\t\tvar inputEl = editShortcutDialog.querySelector('input[name=subreddit]');\r\n\t\t\tvar currStr = inputEl.value;\r\n\t\t\tvar ascStr, descStr, ascArr, descArr;\r\n\t\t\t// sort ASC\r\n\t\t\tascArr = currStr.split('+');\r\n\t\t\tascArr.sort();\r\n\t\t\tascStr = ascArr.join('+');\r\n\t\t\t// sort DESC\r\n\t\t\tdescArr = ascArr;\r\n\t\t\tdescArr.reverse();\r\n\t\t\tdescStr = descArr.join('+');\r\n\t\t\tvar btnTxt = $('#sortButton').text();\r\n\t\t\tif (e.target.type === 'submit') {\r\n\t\t\t\t// if sorted ASC, sort DESC. If unsorted or sorted DESC, sort ASC\r\n\t\t\t\tinputEl.value = (currStr === ascStr ? descStr : ascStr);\r\n\t\t\t\tbtnTxt = (currStr === ascStr ? 'A-Z' : 'Z-A');\r\n\t\t\t} else {\r\n\t\t\t\tbtnTxt = (currStr === ascStr ? 'Z-A' : 'A-Z');\r\n\t\t\t}\r\n\t\t\t$('#sortButton').text(btnTxt);\r\n\t\t}\r\n\r\n\t\t// handle the sort button\r\n\t\tvar sortButton = editShortcutDialog.querySelector('#sortButton');\r\n\t\tsortButton.addEventListener('click', function(e) {\r\n\t\t\tsortSubmenu(e);\r\n\t\t}, false);\r\n\r\n\t\t// handle the subreddit textfield\r\n\t\tvar inputSubreddit = editShortcutDialog.querySelector('input[name=subreddit]');\r\n\t\tinputSubreddit.addEventListener('change', function(e) {\r\n\t\t\tsortSubmenu(e);\r\n\t\t});\r\n\r\n\t\t// handle enter and escape keys in the dialog box...\r\n\t\tsubredditInput.addEventListener('keydown', function(e) {\r\n\t\t\tif (e.keyCode === 13) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t}\r\n\t\t});\r\n\t\tsubredditInput.addEventListener('keyup', function(e) {\r\n\t\t\tif (e.keyCode === 27) {\r\n\t\t\t\teditShortcutDialog.style.display = 'none';\r\n\t\t\t\teditShortcutDialog.blur();\r\n\t\t\t} else if (e.keyCode === 13) {\r\n\t\t\t\tRESUtils.click(saveButton);\r\n\t\t\t}\r\n\t\t}, false);\r\n\t\tdisplayNameInput.addEventListener('keyup', function(e) {\r\n\t\t\tif (e.keyCode === 27) {\r\n\t\t\t\teditShortcutDialog.style.display = 'none';\r\n\t\t\t\teditShortcutDialog.blur();\r\n\t\t\t} else if (e.keyCode === 13) {\r\n\t\t\t\tRESUtils.click(saveButton);\r\n\t\t\t}\r\n\t\t}, false);\r\n\r\n\t\tvar cancelButton = editShortcutDialog.querySelector('#editShortcutClose');\r\n\t\tcancelButton.addEventListener('click', function(e) {\r\n\t\t\teditShortcutDialog.style.display = 'none';\r\n\t\t}, false);\r\n\r\n\t\teditShortcutDialog.style.display = 'block';\r\n\t\t// add 20px to compensate for scrollbar\r\n\t\tvar thisLeft = Math.min(RESUtils.mouseX, window.innerWidth - (editShortcutDialog.offsetWidth + 20));\r\n\t\teditShortcutDialog.style.left = thisLeft + 'px';\r\n\r\n\t\tsetTimeout(function() {\r\n\t\t\tsubredditInput.focus();\r\n\t\t}, 200);\r\n\t}\r\n\r\n\tfunction saveSubredditShortcut(subreddit, displayName, idx) {\r\n\t\tif (subreddit === '' || displayName === '') {\r\n\t\t\t// module.mySubredditShortcuts.splice(idx,1);\r\n\t\t\tsubreddit = module.mySubredditShortcuts[idx].subreddit;\r\n\t\t\tremoveSubredditShortcut(subreddit);\r\n\t\t} else {\r\n\t\t\tmodule.mySubredditShortcuts[idx] = {\r\n\t\t\t\tsubreddit: subreddit,\r\n\t\t\t\tdisplayName: displayName,\r\n\t\t\t\taddedDate: Date.now()\r\n\t\t\t};\r\n\r\n\t\t\tsaveLatestShortcuts();\r\n\r\n\t\t\tif (RESUtils.proEnabled()) {\r\n\t\t\t\tmodules['RESPro'].saveModuleData('subredditManager');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tredrawShortcuts();\r\n\t\tpopulateSubredditDropdown();\r\n\t}\r\n\r\n\tfunction followSubredditShortcut() {\r\n\t\tif (BrowserDetect.isFirefox()) {\r\n\t\t\t// stupid firefox... sigh...\r\n\t\t\tlocation.href = location.protocol + '//' + location.hostname + clickedShortcut;\r\n\t\t} else {\r\n\t\t\tlocation.href = clickedShortcut;\r\n\t\t}\r\n\t}\r\n\r\n\tvar dragSrcEl, srDataTransfer;\r\n\r\n\tfunction subredditDragStart(e) {\r\n\t\tclearTimeout(clickTimer);\r\n\t\t// Target (this) element is the source node.\r\n\t\tthis.style.opacity = '0.4';\r\n\t\tmodule.shortCutsTrash.style.display = 'block';\r\n\t\tdragSrcEl = this;\r\n\r\n\t\te.dataTransfer.effectAllowed = 'move';\r\n\t\t// because Safari is stupid, we have to do this.\r\n\t\tsrDataTransfer = this.getAttribute('orderIndex') + ',' + $(this).data('subreddit');\r\n\t}\r\n\r\n\tfunction subredditDragEnter(e) {\r\n\t\tthis.classList.add('srOver');\r\n\t\treturn false;\r\n\t}\r\n\r\n\tfunction subredditDragOver(e) {\r\n\t\tif (e.preventDefault) {\r\n\t\t\te.preventDefault(); // Necessary. Allows us to drop.\r\n\t\t}\r\n\r\n\t\t// See the section on the DataTransfer object.\r\n\t\te.dataTransfer.dropEffect = 'move';\r\n\t\treturn false;\r\n\t}\r\n\r\n\tfunction subredditDragLeave(e) {\r\n\t\tthis.classList.remove('srOver');\r\n\t\treturn false;\r\n\t}\r\n\r\n\tfunction subredditDrop(e) {\r\n\t\t// this/e.target is current target element.\r\n\t\tif (e.stopPropagation) {\r\n\t\t\te.stopPropagation(); // Stops some browsers from redirecting.\r\n\t\t}\r\n\r\n\t\t// Stops other browsers from redirecting.\r\n\t\te.preventDefault();\r\n\r\n\t\tmodule.shortCutsTrash.style.display = 'none';\r\n\t\t// Don't do anything if dropping the same column we're dragging.\r\n\t\tif (dragSrcEl !== this) {\r\n\t\t\tvar theData, srcOrderIndex, srcSubreddit;\r\n\t\t\tif (e.target.getAttribute('id') !== 'RESShortcutsTrash') {\r\n\t\t\t\t// get the order index of the src and destination to swap...\r\n\t\t\t\t// var theData = e.dataTransfer.getData('text/html').split(',');\r\n\t\t\t\ttheData = srDataTransfer.split(',');\r\n\t\t\t\tsrcOrderIndex = parseInt(theData[0], 10);\r\n\t\t\t\tsrcSubreddit = module.mySubredditShortcuts[srcOrderIndex];\r\n\t\t\t\tvar destOrderIndex = parseInt(this.getAttribute('orderIndex'), 10);\r\n\t\t\t\tvar destSubreddit = module.mySubredditShortcuts[destOrderIndex];\r\n\t\t\t\tvar rearranged = [];\r\n\t\t\t\tvar rearrangedI = 0;\r\n\r\n\t\t\t\tmodule.mySubredditShortcuts.forEach(function(shortcut, i) {\r\n\t\t\t\t\tif ((i !== srcOrderIndex) && (i !== destOrderIndex)) {\r\n\t\t\t\t\t\trearranged[rearrangedI] = shortcut;\r\n\t\t\t\t\t\trearrangedI++;\r\n\t\t\t\t\t} else if (i === destOrderIndex) {\r\n\t\t\t\t\t\tif (destOrderIndex > srcOrderIndex) {\r\n\t\t\t\t\t\t\t// if dragging right, order dest first, src next.\r\n\t\t\t\t\t\t\trearranged[rearrangedI] = destSubreddit;\r\n\t\t\t\t\t\t\trearrangedI++;\r\n\t\t\t\t\t\t\trearranged[rearrangedI] = srcSubreddit;\r\n\t\t\t\t\t\t\trearrangedI++;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// if dragging left, order src first, dest next.\r\n\t\t\t\t\t\t\trearranged[rearrangedI] = srcSubreddit;\r\n\t\t\t\t\t\t\trearrangedI++;\r\n\t\t\t\t\t\t\trearranged[rearrangedI] = destSubreddit;\r\n\t\t\t\t\t\t\trearrangedI++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// save the updated order...\r\n\t\t\t\tmodule.mySubredditShortcuts = rearranged;\r\n\t\t\t\tsaveLatestShortcuts();\r\n\t\t\t\t// redraw the shortcut bar...\r\n\t\t\t\tredrawShortcuts();\r\n\t\t\t\tthis.classList.remove('srOver');\r\n\t\t\t} else {\r\n\t\t\t\ttheData = srDataTransfer.split(',');\r\n\t\t\t\tsrcOrderIndex = parseInt(theData[0], 10);\r\n\t\t\t\tsrcSubreddit = theData[1];\r\n\t\t\t\tremoveSubredditShortcut(srcSubreddit);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tfunction subredditDragEnd(e) {\r\n\t\tmodule.shortCutsTrash.style.display = 'none';\r\n\t\tthis.style.opacity = '1';\r\n\t\treturn false;\r\n\t}\r\n\r\n\tfunction redrawSubredditBar() {\r\n\t\tvar headerContents = document.querySelector('#sr-header-area');\r\n\t\tif (headerContents) {\r\n\t\t\t// Clear out the existing stuff in the top bar first, we'll replace it with our own stuff.\r\n\t\t\t$(headerContents).html('');\r\n\r\n\t\t\tvar srLeftContainer = RESUtils.createElement('div', 'srLeftContainer');\r\n\t\t\tsrLeftContainer.setAttribute('class', 'sr-bar');\r\n\r\n\t\t\tvar srDropdown = RESUtils.createElement('div', 'srDropdown');\r\n\t\t\tvar srDropdownContainer = RESUtils.createElement('div', 'srDropdownContainer');\r\n\t\t\t$(srDropdownContainer).html('<a href=\"javascript:void 0\">My Subreddits</a>');\r\n\t\t\tsrDropdownContainer.addEventListener('click', toggleSubredditDropdown, false);\r\n\t\t\tsrDropdown.appendChild(srDropdownContainer);\r\n\r\n\t\t\tsrList = RESUtils.createElement('table', 'srList');\r\n\t\t\tvar maxHeight = $(window).height() - 40;\r\n\t\t\t$(srList).css('max-height', maxHeight + 'px');\r\n\t\t\t// srDropdownContainer.appendChild(srList);\r\n\t\t\tdocument.body.appendChild(srList);\r\n\r\n\t\t\tsrLeftContainer.appendChild(srDropdown);\r\n\t\t\tvar sep = document.createElement('span');\r\n\t\t\tsep.setAttribute('class', 'srSep');\r\n\t\t\tsep.textContent = '|';\r\n\t\t\tsrLeftContainer.appendChild(sep);\r\n\r\n\t\t\t// now put in the shortcuts...\r\n\t\t\tvar staticShortCutsContainer = document.createElement('div');\r\n\t\t\tstaticShortCutsContainer.setAttribute('id', 'RESStaticShortcuts');\r\n\t\t\t/* this probably isn't the best way to give the option, since the mechanic is drag/drop for other stuff..  but it's much easier for now... */\r\n\t\t\t$(staticShortCutsContainer).html('');\r\n\t\t\tvar specialButtonSelected = {};\r\n\t\t\tvar subLower = (RESUtils.currentSubreddit()) ? RESUtils.currentSubreddit().toLowerCase() : 'home';\r\n\t\t\tspecialButtonSelected[subLower] = 'RESShortcutsCurrentSub';\r\n\r\n\t\t\tvar shortCutsHTML = '';\r\n\r\n\t\t\tif (module.options.linkDashboard.value) shortCutsHTML += '<span class=\"separator\">-</span><a id=\"RESDashboardLink\" class=\"subbarlink ' + specialButtonSelected['dashboard'] + '\" href=\"/r/Dashboard/\">Dashboard</a>';\r\n\t\t\tif (module.options.linkFront.value) shortCutsHTML += '<span class=\"separator\">-</span><a class=\"subbarlink ' + specialButtonSelected['home'] + '\" href=\"/\">Front</a>';\r\n\t\t\tif (module.options.linkAll.value) shortCutsHTML += '<span class=\"separator\">-</span><a class=\"subbarlink ' + specialButtonSelected['all'] + '\" href=\"/r/all/\">All</a>';\r\n\t\t\tif (module.options.linkRandom.value) shortCutsHTML += '<span class=\"separator\">-</span><a class=\"subbarlink\" href=\"/r/random/\">Random</a>';\r\n\t\t\tif (module.options.linkMyRandom.value && module.myRandomEnabled) shortCutsHTML += '<span class=\"separator\">-</span><a class=\"subbarlink ' + (module.myRandomGold ? 'gold' : '') + '\" href=\"/r/myrandom/\">MyRandom</a>';\r\n\t\t\tif (module.options.linkRandNSFW.value) shortCutsHTML += '<span class=\"separator over18\">-</span><a class=\"subbarlink over18\" href=\"/r/randnsfw/\">RandNSFW</a>';\r\n\r\n\t\t\tif (RESUtils.loggedInUser()) {\r\n\t\t\t\tif (module.options.linkFriends.value) shortCutsHTML += '<span class=\"separator\">-</span><a class=\"subbarlink ' + specialButtonSelected['friends'] + '\" href=\"/r/friends/\">Friends</a>';\r\n\r\n\t\t\t\tif (RESUtils.isModeratorAnywhere()) {\r\n\t\t\t\t\tif (module.options.linkMod.value) shortCutsHTML += '<span class=\"separator\">-</span><a class=\"subbarlink ' + specialButtonSelected['mod'] + '\" href=\"/r/mod/\">Mod</a>';\r\n\t\t\t\t\tif (module.options.linkModqueue.value) shortCutsHTML += '<span class=\"separator\">-</span><a class=\"subbarlink\" href=\"/r/mod/about/modqueue\">Modqueue</a>';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (module.options.buttonEdit.value) shortCutsHTML += '<span class=\"separator\">-</span>' + modules['settingsNavigation'].makeUrlHashLink('subredditManager', '', 'edit', 'subbarlink');\r\n\r\n\t\t\t$(staticShortCutsContainer).append(shortCutsHTML);\r\n\r\n\t\t\tsrLeftContainer.appendChild(staticShortCutsContainer);\r\n\t\t\tsrLeftContainer.appendChild(sep);\r\n\t\t\theaderContents.appendChild(srLeftContainer);\r\n\r\n\t\t\tvar shortCutsViewport = document.createElement('div');\r\n\t\t\tshortCutsViewport.setAttribute('id', 'RESShortcutsViewport');\r\n\t\t\theaderContents.appendChild(shortCutsViewport);\r\n\r\n\t\t\tshortCutsContainer = document.createElement('div');\r\n\t\t\tshortCutsContainer.setAttribute('id', 'RESShortcuts');\r\n\t\t\tshortCutsContainer.setAttribute('class', 'sr-bar');\r\n\t\t\tshortCutsViewport.appendChild(shortCutsContainer);\r\n\r\n\t\t\tvar shortCutsEditContainer = document.createElement('div');\r\n\t\t\tshortCutsEditContainer.setAttribute('id', 'RESShortcutsEditContainer');\r\n\t\t\theaderContents.appendChild(shortCutsEditContainer);\r\n\r\n\t\t\t// Add shortcut sorting arrow\r\n\t\t\tmodule.sortShortcutsButton = document.createElement('div');\r\n\t\t\tmodule.sortShortcutsButton.setAttribute('id', 'RESShortcutsSort');\r\n\t\t\tmodule.sortShortcutsButton.setAttribute('title', 'sort subreddit shortcuts');\r\n\t\t\tmodule.sortShortcutsButton.innerHTML = '&uarr;&darr;';\r\n\t\t\tmodule.sortShortcutsButton.addEventListener('click', showSortMenu, false);\r\n\t\t\tshortCutsEditContainer.appendChild(module.sortShortcutsButton);\r\n\r\n\t\t\t// add right scroll arrow...\r\n\t\t\tvar shortCutsRight = document.createElement('div');\r\n\t\t\tshortCutsRight.setAttribute('id', 'RESShortcutsRight');\r\n\t\t\tshortCutsRight.textContent = '>';\r\n\t\t\tshortCutsRight.addEventListener('click', function(e) {\r\n\t\t\t\tvar marginLeft = shortCutsContainer.firstChild.style.marginLeft;\r\n\t\t\t\tmarginLeft = parseInt(marginLeft.replace('px', ''), 10);\r\n\r\n\t\t\t\tif (isNaN(marginLeft)) marginLeft = 0;\r\n\r\n\t\t\t\tvar shiftWidth = $('#RESShortcutsViewport').width() - 80;\r\n\t\t\t\tif (shortCutsContainer.offsetWidth > (shiftWidth)) {\r\n\t\t\t\t\tmarginLeft -= shiftWidth;\r\n\t\t\t\t\tshortCutsContainer.firstChild.style.marginLeft = marginLeft + 'px';\r\n\t\t\t\t}\r\n\t\t\t}, false);\r\n\t\t\tshortCutsEditContainer.appendChild(shortCutsRight);\r\n\r\n\t\t\t// add an \"add shortcut\" button...\r\n\t\t\tvar shortCutsAdd = RESUtils.createElement('div', 'RESShortcutsAdd', 'res-icon');\r\n\t\t\tshortCutsAdd.innerHTML = '&#xF139;';\r\n\t\t\tshortCutsAdd.title = 'add shortcut';\r\n\t\t\tvar shortCutsAddFormContainer = document.createElement('div');\r\n\t\t\tshortCutsAddFormContainer.setAttribute('id', 'RESShortcutsAddFormContainer');\r\n\t\t\tshortCutsAddFormContainer.style.display = 'none';\r\n\t\t\tvar thisForm = ' \\\r\n\t\t\t\t<form id=\"shortCutsAddForm\"> \\\r\n\t\t\t\t\t<div>Add shortcut or multi-reddit (i.e. foo+bar+baz):</div> \\\r\n\t\t\t\t\t<label for=\"newShortcut\">Subreddit:</label> <input type=\"text\" id=\"newShortcut\"><br> \\\r\n\t\t\t\t\t<label for=\"displayName\">Display Name:</label> <input type=\"text\" id=\"displayName\"><br> \\\r\n\t\t\t\t\t<input type=\"submit\" name=\"submit\" value=\"add\" id=\"addSubreddit\"> \\\r\n\t\t\t\t\t<div style=\"clear: both; float: right; margin-top: 5px;\"><a style=\"font-size: 9px;\" href=\"/subreddits/\">Edit frontpage subscriptions</a></div> \\\r\n\t\t\t\t</form> \\\r\n\t\t\t';\r\n\t\t\t$(shortCutsAddFormContainer).html(thisForm);\r\n\t\t\tvar shortCutsAddFormField = shortCutsAddFormContainer.querySelector('#newShortcut');\r\n\t\t\tvar shortCutsAddFormFieldDisplayName = shortCutsAddFormContainer.querySelector('#displayName');\r\n\r\n\t\t\tshortCutsAddFormField.addEventListener('keyup', function(e) {\r\n\t\t\t\tif (e.keyCode === 27) {\r\n\t\t\t\t\tshortCutsAddFormContainer.style.display = 'none';\r\n\t\t\t\t\tshortCutsAddFormField.blur();\r\n\t\t\t\t}\r\n\t\t\t}, false);\r\n\r\n\t\t\tshortCutsAddFormFieldDisplayName.addEventListener('keyup', function(e) {\r\n\t\t\t\tif (e.keyCode === 27) {\r\n\t\t\t\t\tshortCutsAddFormContainer.style.display = 'none';\r\n\t\t\t\t\tshortCutsAddFormFieldDisplayName.blur();\r\n\t\t\t\t}\r\n\t\t\t}, false);\r\n\r\n\t\t\t// add the \"add shortcut\" form...\r\n\t\t\tvar shortCutsAddForm = shortCutsAddFormContainer.querySelector('#shortCutsAddForm');\r\n\t\t\tshortCutsAddForm.addEventListener('submit', function(e) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tvar subreddit = shortCutsAddFormField.value;\r\n\t\t\t\tvar displayname = shortCutsAddFormFieldDisplayName.value;\r\n\t\t\t\tif (displayname === '') displayname = subreddit;\r\n\r\n\t\t\t\tvar rMatchRegex = /^(\\/r\\/|r\\/)(.*)/i;\r\n\t\t\t\tif (rMatchRegex.test(subreddit)) {\r\n\t\t\t\t\tsubreddit = subreddit.match(rMatchRegex)[2];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tshortCutsAddFormField.value = '';\r\n\t\t\t\tshortCutsAddFormFieldDisplayName.value = '';\r\n\t\t\t\tshortCutsAddFormContainer.style.display = 'none';\r\n\r\n\t\t\t\tif (subreddit) {\r\n\t\t\t\t\taddSubredditShortcut(subreddit, displayname);\r\n\t\t\t\t}\r\n\t\t\t}, false);\r\n\t\t\tshortCutsAdd.addEventListener('click', function(e) {\r\n\t\t\t\tif (shortCutsAddFormContainer.style.display === 'none') {\r\n\t\t\t\t\tshortCutsAddFormContainer.style.display = 'block';\r\n\t\t\t\t\tshortCutsAddFormField.focus();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tshortCutsAddFormContainer.style.display = 'none';\r\n\t\t\t\t\tshortCutsAddFormField.blur();\r\n\t\t\t\t}\r\n\t\t\t}, false);\r\n\t\t\tshortCutsEditContainer.appendChild(shortCutsAdd);\r\n\t\t\tdocument.body.appendChild(shortCutsAddFormContainer);\r\n\r\n\t\t\t// add the \"trash bin\"...\r\n\t\t\tmodule.shortCutsTrash = RESUtils.createElement('div', 'RESShortcutsTrash', 'res-icon');\r\n\t\t\tmodule.shortCutsTrash.innerHTML = '&#xF056;';\r\n\t\t\tmodule.shortCutsTrash.addEventListener('dragenter', subredditDragEnter, false);\r\n\t\t\tmodule.shortCutsTrash.addEventListener('dragleave', subredditDragLeave, false);\r\n\t\t\tmodule.shortCutsTrash.addEventListener('dragover', subredditDragOver, false);\r\n\t\t\tmodule.shortCutsTrash.addEventListener('drop', subredditDrop, false);\r\n\t\t\tshortCutsEditContainer.appendChild(module.shortCutsTrash);\r\n\r\n\t\t\t// add left scroll arrow...\r\n\t\t\tvar shortCutsLeft = document.createElement('div');\r\n\t\t\tshortCutsLeft.setAttribute('id', 'RESShortcutsLeft');\r\n\t\t\tshortCutsLeft.textContent = '<';\r\n\t\t\tshortCutsLeft.addEventListener('click', function(e) {\r\n\t\t\t\tvar marginLeft = shortCutsContainer.firstChild.style.marginLeft;\r\n\t\t\t\tmarginLeft = parseInt(marginLeft.replace('px', ''), 10);\r\n\r\n\t\t\t\tif (isNaN(marginLeft)) marginLeft = 0;\r\n\r\n\t\t\t\tvar shiftWidth = $('#RESShortcutsViewport').width() - 80;\r\n\t\t\t\tmarginLeft += shiftWidth;\r\n\t\t\t\tif (marginLeft <= 0) {\r\n\t\t\t\t\tshortCutsContainer.firstChild.style.marginLeft = marginLeft + 'px';\r\n\t\t\t\t}\r\n\t\t\t}, false);\r\n\t\t\tshortCutsEditContainer.appendChild(shortCutsLeft);\r\n\r\n\t\t\tredrawShortcuts();\r\n\t\t}\r\n\t}\r\n\r\n\tfunction showSortMenu() {\r\n\t\t// Add shortcut sorting menu if it doesn't exist in the DOM yet...\r\n\t\tif (!sortMenu) {\r\n\t\t\tsortMenu =\r\n\t\t\t\t$('<div id=\"sort-menu\" class=\"drop-choices\">' +\r\n\t\t\t\t\t'<p>&nbsp;sort by:</p>' +\r\n\t\t\t\t\t'<a class=\"choice\" data-field=\"displayName\" href=\"javascript:void 0\">display name</a>' +\r\n\t\t\t\t\t'<a class=\"choice\" data-field=\"addedDate\" href=\"javascript:void 0\">added date</a>' +\r\n\t\t\t\t\t'</div>');\r\n\r\n\t\t\t$(sortMenu).find('a').click(sortShortcuts);\r\n\r\n\t\t\t$(document.body).append(sortMenu);\r\n\t\t}\r\n\t\tvar menu = sortMenu;\r\n\t\tif ($(menu).is(':visible')) {\r\n\t\t\t$(menu).hide();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar thisXY = $(module.sortShortcutsButton).offset();\r\n\t\tthisXY.left = thisXY.left - $(menu).width() + $(module.sortShortcutsButton).width();\r\n\t\tvar thisHeight = $(module.sortShortcutsButton).height();\r\n\r\n\t\t$(menu).css({\r\n\t\t\ttop: thisXY.top + thisHeight,\r\n\t\t\tleft: thisXY.left\r\n\t\t}).show();\r\n\t}\r\n\r\n\tfunction hideSortMenu() {\r\n\t\t$(sortMenu).hide();\r\n\t}\r\n\r\n\tvar currentSort;\r\n\r\n\tfunction sortShortcuts(e) {\r\n\t\thideSortMenu();\r\n\r\n\t\tvar sortingField = $(this).data('field');\r\n\t\tvar asc = !currentSort;\r\n\t\t// toggle sort method...\r\n\t\tcurrentSort = !currentSort;\r\n\t\t// Make sure we have a valid list of shortucts\r\n\t\tif (!module.mySubredditShortcuts) {\r\n\t\t\tgetLatestShortcuts();\r\n\t\t}\r\n\r\n\t\tmodule.mySubredditShortcuts.sort(function(a, b) {\r\n\t\t\t// var sortingField = field; // module.options.sortingField.value;\r\n\t\t\t// var asc = order === 'asc'; // (module.options.sortingDirection.value === 'asc');\r\n\t\t\tvar aField = a[sortingField];\r\n\t\t\tvar bField = b[sortingField];\r\n\t\t\tif (typeof aField === 'string' && typeof bField === 'string') {\r\n\t\t\t\taField = aField.toLowerCase();\r\n\t\t\t\tbField = bField.toLowerCase();\r\n\t\t\t}\r\n\r\n\t\t\tif (aField === bField) {\r\n\t\t\t\treturn 0;\r\n\t\t\t} else if (aField > bField) {\r\n\t\t\t\treturn (asc) ? 1 : -1;\r\n\t\t\t} else {\r\n\t\t\t\treturn (asc) ? -1 : 1;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// Save shortcuts sort order\r\n\t\tsaveLatestShortcuts();\r\n\r\n\t\t// Refresh shortcuts\r\n\t\tredrawShortcuts();\r\n\t}\r\n\r\n\tvar subredditPagesLoaded;\r\n\r\n\tfunction toggleSubredditDropdown(e) {\r\n\t\te.stopPropagation();\r\n\t\tif (srList.style.display === 'block') {\r\n\t\t\tsrList.style.display = 'none';\r\n\t\t\tdocument.body.removeEventListener('click', toggleSubredditDropdown, false);\r\n\t\t} else {\r\n\t\t\tif (RESUtils.loggedInUser()) {\r\n\t\t\t\t$(srList).html('<tr><td width=\"360\">Loading subreddits (may take a moment)...<div id=\"subredditPagesLoaded\"></div></td></tr>');\r\n\t\t\t\tif (!subredditPagesLoaded) {\r\n\t\t\t\t\tsubredditPagesLoaded = srList.querySelector('#subredditPagesLoaded');\r\n\t\t\t\t}\r\n\t\t\t\tsrList.style.display = 'block';\r\n\t\t\t\tgetSubreddits();\r\n\t\t\t} else {\r\n\t\t\t\t$(srList).html('<tr><td width=\"360\">You must be logged in to load your own list of subreddits. <a style=\"display: inline; float: left;\" href=\"/subreddits/\">browse them all</a></td></tr>');\r\n\t\t\t\tsrList.style.display = 'block';\r\n\t\t\t}\r\n\t\t\tsrList.addEventListener('click', stopDropDownPropagation, false);\r\n\t\t\tdocument.body.addEventListener('click', toggleSubredditDropdown, false);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction stopDropDownPropagation(e) {\r\n\t\te.stopPropagation();\r\n\t}\r\n\r\n\tmodule.mySubreddits = [];\r\n\tmodule.mySubredditShortcuts = [];\r\n\r\n\tfunction getSubredditJSON(after) {\r\n\t\tvar jsonURL = location.protocol + '//' + location.hostname + '/subreddits/mine/.json?app=res';\r\n\t\tif (after) jsonURL += '&after=' + after;\r\n\t\tRESEnvironment.ajax({\r\n\t\t\tmethod: 'GET',\r\n\t\t\turl: jsonURL,\r\n\t\t\tonload: function(response) {\r\n\t\t\t\tvar thisResponse = JSON.parse(response.responseText);\r\n\t\t\t\tif ((typeof thisResponse.data !== 'undefined') && (typeof thisResponse.data.children !== 'undefined')) {\r\n\t\t\t\t\tif (subredditPagesLoaded.innerHTML === '') {\r\n\t\t\t\t\t\tsubredditPagesLoaded.textContent = 'Pages loaded: 1';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar pages = subredditPagesLoaded.innerHTML.match(/:\\ ([\\d]+)/);\r\n\t\t\t\t\t\tsubredditPagesLoaded.textContent = 'Pages loaded: ' + (parseInt(pages[1], 10) + 1);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar now = Date.now();\r\n\t\t\t\t\tRESStorage.setItem('RESmodules.subredditManager.subreddits.lastCheck.' + RESUtils.loggedInUser(), now);\r\n\r\n\t\t\t\t\tvar subreddits = thisResponse.data.children;\r\n\t\t\t\t\tfor (var i = 0, len = subreddits.length; i < len; i++) {\r\n\t\t\t\t\t\tvar srObj = {\r\n\t\t\t\t\t\t\tdisplay_name: subreddits[i].data.display_name,\r\n\t\t\t\t\t\t\turl: subreddits[i].data.url,\r\n\t\t\t\t\t\t\tover18: subreddits[i].data.over18,\r\n\t\t\t\t\t\t\tid: subreddits[i].data.id,\r\n\t\t\t\t\t\t\tcreated: subreddits[i].data.created,\r\n\t\t\t\t\t\t\tdescription: subreddits[i].data.description\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tmodule.mySubreddits.push(srObj);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (thisResponse.data.after) {\r\n\t\t\t\t\t\tgetSubredditJSON(thisResponse.data.after);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmodule.mySubreddits.sort(function(a, b) {\r\n\t\t\t\t\t\t\tvar adisp = a.display_name.toLowerCase();\r\n\t\t\t\t\t\t\tvar bdisp = b.display_name.toLowerCase();\r\n\t\t\t\t\t\t\tif (adisp > bdisp) return 1;\r\n\t\t\t\t\t\t\tif (adisp === bdisp) return 0;\r\n\t\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// Remove duplicate subreddits\r\n\t\t\t\t\t\t(function() {\r\n\t\t\t\t\t\t\tvar id = {};\r\n\t\t\t\t\t\t\tmodule.mySubreddits = module.mySubreddits.filter(function(sr) {\r\n\t\t\t\t\t\t\t\tif (id[sr.id]) return false;\r\n\t\t\t\t\t\t\t\tid[sr.id] = true;\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t})();\r\n\r\n\t\t\t\t\t\tRESStorage.setItem('RESmodules.subredditManager.subreddits.' + RESUtils.loggedInUser(), JSON.stringify(module.mySubreddits));\r\n\t\t\t\t\t\tgettingSubreddits = false;\r\n\t\t\t\t\t\tpopulateSubredditDropdown();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// User is probably not logged in.. no subreddits found.\r\n\t\t\t\t\tpopulateSubredditDropdown(null, true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tfunction getSubreddits() {\r\n\t\tmodule.mySubreddits = [];\r\n\t\tvar lastCheck = parseInt(RESStorage.getItem('RESmodules.subredditManager.subreddits.lastCheck.' + RESUtils.loggedInUser()), 10) || 0;\r\n\t\tvar now = Date.now();\r\n\t\tvar check = RESStorage.getItem('RESmodules.subredditManager.subreddits.' + RESUtils.loggedInUser());\r\n\r\n\t\t// 86400000 = 1 day\r\n\t\tif (((now - lastCheck) > 86400000) || !check || (check.length === 0)) {\r\n\t\t\tif (!gettingSubreddits) {\r\n\t\t\t\tgettingSubreddits = true;\r\n\t\t\t\tgetSubredditJSON();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tmodule.mySubreddits = safeJSON.parse(check, 'RESmodules.subredditManager.subreddits.' + RESUtils.loggedInUser());\r\n\t\t\tpopulateSubredditDropdown();\r\n\t\t}\r\n\t}\r\n\r\n\t// if badJSON is true, then getSubredditJSON ran into an error...\r\n\tfunction populateSubredditDropdown(sortBy, badJSON) {\r\n\t\tmodule.sortBy = sortBy || 'subreddit';\r\n\t\t$(srList).html('');\r\n\t\t// NOTE WE NEED TO CHECK LAST TIME THEY UPDATED THEIR SUBREDDIT LIST AND REPOPULATE...\r\n\r\n\t\tvar tableHead = document.createElement('thead');\r\n\t\tvar tableRow = document.createElement('tr');\r\n\r\n\t\tvar srHeader = document.createElement('td');\r\n\t\tsrHeader.addEventListener('click', function() {\r\n\t\t\tif (module.sortBy === 'subreddit') {\r\n\t\t\t\tpopulateSubredditDropdown('subredditDesc');\r\n\t\t\t} else {\r\n\t\t\t\tpopulateSubredditDropdown('subreddit');\r\n\t\t\t}\r\n\t\t}, false);\r\n\t\tsrHeader.textContent = 'subreddit';\r\n\t\tsrHeader.setAttribute('width', '200');\r\n\r\n\t\tvar lvHeader = document.createElement('td');\r\n\t\tlvHeader.addEventListener('click', function() {\r\n\t\t\tif (module.sortBy === 'lastVisited') {\r\n\t\t\t\tpopulateSubredditDropdown('lastVisitedAsc');\r\n\t\t\t} else {\r\n\t\t\t\tpopulateSubredditDropdown('lastVisited');\r\n\t\t\t}\r\n\t\t}, false);\r\n\t\tlvHeader.textContent = 'Last Visited';\r\n\t\tlvHeader.setAttribute('width', '120');\r\n\r\n\t\tvar scHeader = document.createElement('td');\r\n\t\t$(scHeader).width(50);\r\n\t\t$(scHeader).html('<a style=\"float: right;\" href=\"/subreddits/\">View all &raquo;</a>');\r\n\t\ttableRow.appendChild(srHeader);\r\n\t\ttableRow.appendChild(lvHeader);\r\n\t\ttableRow.appendChild(scHeader);\r\n\t\ttableHead.appendChild(tableRow);\r\n\t\tsrList.appendChild(tableHead);\r\n\r\n\t\tvar theBody = document.createElement('tbody');\r\n\t\tif (!badJSON) {\r\n\t\t\tvar subredditCount = module.mySubreddits.length;\r\n\r\n\t\t\tif (typeof subredditsLastViewed === 'undefined') {\r\n\t\t\t\tvar check = RESStorage.getItem('RESmodules.subredditManager.subredditsLastViewed.' + RESUtils.loggedInUser());\r\n\t\t\t\tif (check) {\r\n\t\t\t\t\tsubredditsLastViewed = safeJSON.parse(check, 'RESmodules.subredditManager.subredditsLastViewed.' + RESUtils.loggedInUser());\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsubredditsLastViewed = {};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// copy module.mySubreddits to a placeholder array so we can sort without modifying it...\r\n\t\t\tvar sortableSubreddits = module.mySubreddits;\r\n\t\t\tif (sortBy === 'lastVisited') {\r\n\t\t\t\t$(lvHeader).html('Last Visited <div class=\"sortAsc\"></div>');\r\n\t\t\t\tsrHeader.textContent = 'subreddit';\r\n\r\n\t\t\t\tsortableSubreddits.sort(function(a, b) {\r\n\t\t\t\t\tvar adisp = a.display_name.toLowerCase();\r\n\t\t\t\t\tvar bdisp = b.display_name.toLowerCase();\r\n\r\n\t\t\t\t\tvar alv = (typeof subredditsLastViewed[adisp] === 'undefined') ? 0 : parseInt(subredditsLastViewed[adisp].last_visited, 10);\r\n\t\t\t\t\tvar blv = (typeof subredditsLastViewed[bdisp] === 'undefined') ? 0 : parseInt(subredditsLastViewed[bdisp].last_visited, 10);\r\n\r\n\t\t\t\t\tif (alv < blv) return 1;\r\n\t\t\t\t\tif (alv === blv) {\r\n\t\t\t\t\t\tif (adisp > bdisp) return 1;\r\n\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t});\r\n\t\t\t} else if (sortBy === 'lastVisitedAsc') {\r\n\t\t\t\t$(lvHeader).html('Last Visited <div class=\"sortDesc\"></div>');\r\n\t\t\t\tsrHeader.textContent = 'subreddit';\r\n\r\n\t\t\t\tsortableSubreddits.sort(function(a, b) {\r\n\t\t\t\t\tvar adisp = a.display_name.toLowerCase();\r\n\t\t\t\t\tvar bdisp = b.display_name.toLowerCase();\r\n\r\n\t\t\t\t\tvar alv = (typeof subredditsLastViewed[adisp] === 'undefined') ? 0 : parseInt(subredditsLastViewed[adisp].last_visited, 10);\r\n\t\t\t\t\tvar blv = (typeof subredditsLastViewed[bdisp] === 'undefined') ? 0 : parseInt(subredditsLastViewed[bdisp].last_visited, 10);\r\n\r\n\t\t\t\t\tif (alv > blv) return 1;\r\n\t\t\t\t\tif (alv === blv) {\r\n\t\t\t\t\t\tif (adisp > bdisp) return 1;\r\n\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t});\r\n\t\t\t} else if (sortBy === 'subredditDesc') {\r\n\t\t\t\tlvHeader.textContent = 'Last Visited';\r\n\t\t\t\t$(srHeader).html('subreddit <div class=\"sortDesc\"></div>');\r\n\r\n\t\t\t\tsortableSubreddits.sort(function(a, b) {\r\n\t\t\t\t\tvar adisp = a.display_name.toLowerCase();\r\n\t\t\t\t\tvar bdisp = b.display_name.toLowerCase();\r\n\r\n\t\t\t\t\tif (adisp < bdisp) return 1;\r\n\t\t\t\t\tif (adisp === bdisp) return 0;\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tlvHeader.textContent = 'Last Visited';\r\n\t\t\t\t$(srHeader).html('subreddit <div class=\"sortAsc\"></div>');\r\n\r\n\t\t\t\tsortableSubreddits.sort(function(a, b) {\r\n\t\t\t\t\tvar adisp = a.display_name.toLowerCase();\r\n\t\t\t\t\tvar bdisp = b.display_name.toLowerCase();\r\n\r\n\t\t\t\t\tif (adisp > bdisp) return 1;\r\n\t\t\t\t\tif (adisp === bdisp) return 0;\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < subredditCount; i++) {\r\n\t\t\t\tvar dateString = 'Never';\r\n\t\t\t\tvar thisReddit = sortableSubreddits[i].display_name.toLowerCase();\r\n\t\t\t\tif (typeof subredditsLastViewed[thisReddit] !== 'undefined') {\r\n\t\t\t\t\tvar ts = parseInt(subredditsLastViewed[thisReddit].last_visited, 10);\r\n\t\t\t\t\tvar dateVisited = new Date(ts);\r\n\t\t\t\t\tdateString = RESUtils.niceDate(dateVisited);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar theRow = document.createElement('tr');\r\n\t\t\t\tvar theSR = document.createElement('td');\r\n\t\t\t\t$(theSR).html('<a href=\"' + escapeHTML(module.mySubreddits[i].url) + '\">' + escapeHTML(module.mySubreddits[i].display_name) + '</a>');\r\n\t\t\t\ttheRow.appendChild(theSR);\r\n\r\n\t\t\t\tvar theLV = document.createElement('td');\r\n\t\t\t\ttheLV.textContent = dateString;\r\n\t\t\t\ttheLV.setAttribute('class', 'RESvisited');\r\n\t\t\t\ttheRow.appendChild(theLV);\r\n\r\n\t\t\t\tvar theSC = document.createElement('td');\r\n\t\t\t\ttheSC.setAttribute('class', 'RESshortcut');\r\n\t\t\t\ttheSC.setAttribute('data-subreddit', module.mySubreddits[i].display_name);\r\n\r\n\t\t\t\tvar idx = module.mySubredditShortcuts.findIndex(function(shortcut) {\r\n\t\t\t\t\treturn shortcut.subreddit === shortcut.display_name;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (idx !== -1) {\r\n\t\t\t\t\ttheSC.addEventListener('click', function(e) {\r\n\t\t\t\t\t\tif (e.stopPropagation) {\r\n\t\t\t\t\t\t\te.stopPropagation(); // Stops from triggering the click on the bigger box, which toggles this window closed...\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar subreddit = $(e.target).data('subreddit');\r\n\t\t\t\t\t\tremoveSubredditShortcut(subreddit);\r\n\t\t\t\t\t}, false);\r\n\r\n\t\t\t\t\ttheSC.textContent = '-shortcut';\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttheSC.addEventListener('click', function(e) {\r\n\t\t\t\t\t\tif (e.stopPropagation) {\r\n\t\t\t\t\t\t\te.stopPropagation(); // Stops from triggering the click on the bigger box, which toggles this window closed...\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar subreddit = $(e.target).data('subreddit');\r\n\t\t\t\t\t\taddSubredditShortcut(subreddit);\r\n\t\t\t\t\t}, false);\r\n\r\n\t\t\t\t\ttheSC.textContent = '+shortcut';\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttheRow.appendChild(theSC);\r\n\t\t\t\ttheBody.appendChild(theRow);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar errorTD = document.createElement('td');\r\n\t\t\terrorTD.textContent = 'There was an error getting your subreddits. You may have third party cookies disabled by your browser. For this function to work, you\\'ll need to add an exception for cookies from reddit.com';\r\n\t\t\terrorTD.setAttribute('colspan', '3');\r\n\r\n\t\t\tvar errorRow = document.createElement('tr');\r\n\t\t\terrorRow.appendChild(errorTD);\r\n\t\t\ttheBody.appendChild(errorRow);\r\n\t\t}\r\n\r\n\t\tsrList.appendChild(theBody);\r\n\t}\r\n\r\n\tmodule.toggleSubredditShortcut = function(e) {\r\n\t\te.stopPropagation(); // Stops from triggering the click on the bigger box, which toggles this window closed...\r\n\r\n\t\tvar isShortcut = module.mySubredditShortcuts.some(function(shortcut) {\r\n\t\t\treturn shortcut.subreddit.toLowerCase() === $(this).data('subreddit').toLowerCase();\r\n\t\t}, this);\r\n\r\n\t\tif (isShortcut) {\r\n\t\t\tremoveSubredditShortcut($(this).data('subreddit'));\r\n\t\t\t$(this)\r\n\t\t\t\t.attr('title', 'Add this subreddit to your shortcut bar')\r\n\t\t\t\t.text('+shortcut')\r\n\t\t\t\t.removeClass('remove');\r\n\t\t} else {\r\n\t\t\taddSubredditShortcut($(this).data('subreddit'));\r\n\t\t\t$(this)\r\n\t\t\t\t.attr('title', 'Remove this subreddit from your shortcut bar')\r\n\t\t\t\t.text('-shortcut')\r\n\t\t\t\t.addClass('remove');\r\n\t\t}\r\n\r\n\t\tredrawShortcuts();\r\n\t};\r\n\r\n\tfunction getShortcutsStorageKey() {\r\n\t\tvar username = module.options.shortcutsPerAccount.value ? RESUtils.loggedInUser() : null;\r\n\t\tvar key = 'RESmodules.subredditManager.subredditShortcuts.' + username;\r\n\t\treturn key;\r\n\t}\r\n\r\n\tfunction getLatestShortcuts() {\r\n\t\t// re-retreive the latest data to ensure we're not losing info between tab changes...\r\n\t\tvar key = getShortcutsStorageKey();\r\n\t\tvar shortCuts = RESStorage.getItem(key);\r\n\t\tif (!shortCuts) {\r\n\t\t\tshortCuts = '[]';\r\n\t\t}\r\n\r\n\t\tmodule.mySubredditShortcuts = safeJSON.parse(shortCuts, key);\r\n\t\tparseDates();\r\n\t}\r\n\r\n\t// JSON specification doesn't specify what to do with dates - so unstringify here\r\n\tfunction parseDates() {\r\n\t\tfor (var i = 0, len = module.mySubredditShortcuts.length; i < len; i++) {\r\n\t\t\tmodule.mySubredditShortcuts[i].addedDate = module.mySubredditShortcuts[i].addedDate ? new Date(module.mySubredditShortcuts[i].addedDate) : new Date(0);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction saveLatestShortcuts() {\r\n\t\t// Retreive the latest data to ensure we're not losing info\r\n\t\tif (!module.mySubredditShortcuts) {\r\n\t\t\tmodule.mySubredditShortcuts = [];\r\n\t\t}\r\n\r\n\t\tvar key = getShortcutsStorageKey();\r\n\t\tRESStorage.setItem(key, JSON.stringify(module.mySubredditShortcuts));\r\n\t}\r\n\r\n\tfunction addSubredditShortcut(subreddit, displayname) {\r\n\t\tgetLatestShortcuts();\r\n\r\n\t\tvar idx = module.mySubredditShortcuts.findIndex(function(shortcut) {\r\n\t\t\treturn shortcut.subreddit.toLowerCase() === subreddit.toLowerCase();\r\n\t\t});\r\n\r\n\t\tif (idx !== -1) {\r\n\t\t\talert('Whoops, you already have a shortcut for that subreddit');\r\n\t\t} else {\r\n\t\t\tdisplayname = displayname || subreddit;\r\n\t\t\tvar subredditObj = {\r\n\t\t\t\tsubreddit: subreddit,\r\n\t\t\t\tdisplayName: displayname.toLowerCase(),\r\n\t\t\t\taddedDate: Date.now()\r\n\t\t\t};\r\n\r\n\t\t\tmodule.mySubredditShortcuts.push(subredditObj);\r\n\r\n\t\t\tsaveLatestShortcuts();\r\n\t\t\tredrawShortcuts();\r\n\t\t\tpopulateSubredditDropdown();\r\n\r\n\t\t\tmodules['notifications'].showNotification({\r\n\t\t\t\tmoduleID: 'subredditManager',\r\n\t\t\t\tmessage: 'Subreddit shortcut added. You can edit by double clicking, or trash by dragging to the trash can.'\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tfunction removeSubredditShortcut(subreddit) {\r\n\t\tgetLatestShortcuts();\r\n\r\n\t\tvar idx = module.mySubredditShortcuts.findIndex(function(shortcut) {\r\n\t\t\treturn shortcut.subreddit.toLowerCase() === subreddit.toLowerCase();\r\n\t\t});\r\n\r\n\t\tif (idx !== -1) {\r\n\t\t\tmodule.mySubredditShortcuts.splice(idx, 1);\r\n\r\n\t\t\tsaveLatestShortcuts();\r\n\t\t\tredrawShortcuts();\r\n\t\t\tpopulateSubredditDropdown();\r\n\t\t}\r\n\t}\r\n\r\n\tfunction setLastViewtime() {\r\n\t\tvar check = RESStorage.getItem('RESmodules.subredditManager.subredditsLastViewed.' + RESUtils.loggedInUser());\r\n\r\n\t\tif (!check) {\r\n\t\t\tsubredditsLastViewed = {};\r\n\t\t} else {\r\n\t\t\tsubredditsLastViewed = safeJSON.parse(check, 'RESmodules.subredditManager.subredditsLastViewed.' + RESUtils.loggedInUser());\r\n\t\t}\r\n\r\n\t\tvar now = Date.now();\r\n\t\tvar thisReddit = RESUtils.currentSubreddit().toLowerCase();\r\n\t\tsubredditsLastViewed[thisReddit] = {\r\n\t\t\tlast_visited: now\r\n\t\t};\r\n\r\n\t\tRESStorage.setItem('RESmodules.subredditManager.subredditsLastViewed.' + RESUtils.loggedInUser(), JSON.stringify(subredditsLastViewed));\r\n\t}\r\n\r\n\tmodule.subscribeToSubreddit = function(subredditName, subscribe) {\r\n\t\t// subredditName should look like t5_123asd\r\n\t\tsubscribe = subscribe !== false; // default to true\r\n\t\tvar userHash = RESUtils.loggedInUserHash();\r\n\r\n\t\tvar formData = new FormData();\r\n\t\tformData.append('sr', subredditName);\r\n\t\tformData.append('action', subscribe ? 'sub' : 'unsub');\r\n\t\tformData.append('uh', userHash);\r\n\r\n\t\tRESEnvironment.ajax({\r\n\t\t\tmethod: 'POST',\r\n\t\t\turl: location.protocol + '//' + location.hostname + '/api/subscribe?app=res',\r\n\t\t\tdata: formData\r\n\t\t});\r\n\t};\r\n\r\n\tfunction lastUpdate() {\r\n\t\tvar mySubredditList = $('.drop-choices.srdrop a').map(function(){return this.textContent;}).toArray().join();\r\n\t\tvar mySubredditListCachedObject = RESStorage.getItem('RESmodules.subredditManager.mySubredditList');\r\n\t\tif (mySubredditListCachedObject) {\r\n\t\t\tmySubredditListCachedObject = JSON.parse(mySubredditListCachedObject); // contain last saved subreddit list + time for each user\r\n\t\t} else {\r\n\t\t\tmySubredditListCachedObject = {};\r\n\t\t}\r\n\t\tvar mySubredditListCached = mySubredditListCachedObject[RESUtils.loggedInUser()], // last saved subreddit lsit + time for current user\r\n\t\t\t_lastUpdate;\r\n\t\tif (mySubredditListCached && mySubredditListCached.list === mySubredditList) {\r\n\t\t\t_lastUpdate = parseInt((new Date().getTime() - mySubredditListCached.time)/60000, 10);\r\n\t\t\tif (_lastUpdate > 31) {\r\n\t\t\t\t_lastUpdate = false; // the user have probably less than 50/100 subscription, this module doesn't concern him\r\n\t\t\t\tmySubredditListCached.time = new Date().getTime()-32*60000; // we change time to avoid deleting it just after (to don't show him again the last update)\r\n\t\t\t} else {\r\n\t\t\t\t_lastUpdate += _lastUpdate > 1 ? ' minutes ago' : ' minute ago';\r\n\t\t\t}\r\n\t\t} else { // the mySubreddit list is different than the cached version, subreddit have reloaded them. We reset the cache. (Or there is no cached version)\r\n\t\t\tmySubredditListCachedObject[RESUtils.loggedInUser()] = {\r\n\t\t\t\tlist: mySubredditList,\r\n\t\t\t\ttime: new Date().getTime()\r\n\t\t\t};\r\n\t\t\t_lastUpdate = 'just now';\r\n\t\t}\r\n\t\tif (_lastUpdate !== false && mySubredditListCached !== null) { // Show only if there is cached version and the user have enough subscription\r\n\t\t\t$('.listing-chooser a:first .description').after('<br /><span class=\"description\"><b>last update:</b><br />' + _lastUpdate + '</span>');\r\n\t\t}\r\n\t\t// we now remove inactive user\r\n\t\tvar inactiveThreshold = new Date().getTime() - 2592000000; // one month\r\n\t\tfor (var user in mySubredditListCachedObject) {\r\n\t\t\tif (mySubredditListCachedObject[user].time < inactiveThreshold) {\r\n\t\t\t\tdelete mySubredditListCachedObject[user];\r\n\t\t\t}\r\n\t\t}\r\n\t\tRESStorage.setItem('RESmodules.subredditManager.mySubredditList', JSON.stringify(mySubredditListCachedObject));\r\n\t}\r\n});\r\n"],"sourceRoot":"/source/"}
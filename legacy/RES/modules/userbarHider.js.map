{"version":3,"sources":["modules/userbarHider.js"],"names":[],"mappings":"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","file":"modules/userbarHider.js","sourcesContent":["addModule('userbarHider', function(module, moduleID) {\r\n\tmodule.moduleName = 'User Bar Hider';\r\n\tmodule.description = 'Add a toggle button to show or hide the user bar.';\r\n\tmodule.category = ['My account'];\r\n\r\n\tmodule.options['userbarState'] = {\r\n\t\ttype: 'enum',\r\n\t\tvalues: [{\r\n\t\t\tname: 'Visible',\r\n\t\t\tvalue: 'visible'\r\n\t\t}, {\r\n\t\t\tname: 'Hidden',\r\n\t\t\tvalue: 'hidden'\r\n\t\t}],\r\n\t\tvalue: 'visible',\r\n\t\tdescription: 'User bar',\r\n\t\tbodyClass: true\r\n\t};\r\n\r\n\tmodule.options['toggleButtonState'] = {\r\n\t\ttype: 'enum',\r\n\t\tvalues: [{\r\n\t\t\tname: 'Visible',\r\n\t\t\tvalue: 'visible'\r\n\t\t}, {\r\n\t\t\tname: 'Hidden',\r\n\t\t\tvalue: 'hidden'\r\n\t\t}],\r\n\t\tvalue: 'visible',\r\n\t\tdescription: 'Toggle button',\r\n\t\tadvanced: true,\r\n\t\tbodyClass: true\r\n\t};\r\n\r\n\tvar userbar;\r\n\tvar userbarToggle;\r\n\r\n\tmodule.beforeLoad = function() {\r\n\t\t// Migrate from previous version\r\n\t\tvar userbarState = RESStorage.getItem('RESmodules.styleTweaks.userbarState');\r\n\t\tif (userbarState) {\r\n\t\t\tRESUtils.options.setOption(moduleID, 'userbarState', userbarState);\r\n\r\n\t\t\tRESStorage.removeItem('RESmodules.styleTweaks.userbarState');\r\n\t\t}\r\n\t};\r\n\r\n\tmodule.go = function() {\r\n\t\tif ((this.isEnabled()) && (this.isMatchURL())) {\r\n\t\t\tuserbarHider();\r\n\t\t}\r\n\t};\r\n\r\n\tfunction userbarHider() {\r\n\t\tuserbar = document.getElementById('header-bottom-right');\r\n\t\tif (userbar) {\r\n\t\t\tif (module.options['toggleButtonState'].value === 'visible' || module.options['userbarState'].value === 'hidden') {\r\n\t\t\t\taddToggleButton();\r\n\t\t\t}\r\n\t\t\tif (module.options['userbarState'].value === 'hidden') {\r\n\t\t\t\tupdateUserBar();\r\n\t\t\t\tmodules['notifications'].showNotification({\r\n\t\t\t\t\tmoduleID: moduleID,\r\n\t\t\t\t\toptionKey: 'userbarState',\r\n\t\t\t\t\tcooldown: 24 * 60 * 60 * 1000,\r\n\t\t\t\t\theader: 'User Bar Hidden',\r\n\t\t\t\t\tmessage: 'Your username, karma, preferences, <span class=\"gearIcon\"></span> RES gear, and so on are hidden. You can show them again by clicking the &laquo; button in the top right corner.'\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction toggleUserBar() {\r\n\t\tvar userbarHidden = (module.options['userbarState'].value == 'hidden');\r\n\t\tupdateUserbarStateOption(!userbarHidden);\r\n\t\tupdateUserBar();\r\n\t}\r\n\r\n\tfunction updateUserBar() {\r\n\t\tvar userbarHidden = (module.options['userbarState'].value == 'hidden');\r\n\r\n\t\tupdateToggleButton(userbarHidden);\r\n\t\ttoggleUserbarElementsDisplay(userbarHidden);\r\n\t}\r\n\r\n\tfunction addToggleButton() {\r\n\t\tuserbarToggle = RESUtils.createElement('div', 'userbarToggle');\r\n\t\tuserbarToggle.setAttribute('title', 'Toggle Userbar');\r\n\t\tdocument.querySelector('#header-bottom-right').classList.add('res-userbar-toggle');\r\n\t\tuserbarToggle.addEventListener('click', function(e) {\r\n\t\t\ttoggleUserBar();\r\n\t\t}, false);\r\n\t\tuserbar.insertBefore(userbarToggle, userbar.firstChild);\r\n\r\n\t\tupdateToggleButton(false);\r\n\t}\r\n\r\n\tfunction updateToggleButton(userbarHidden) {\r\n\t\tvar button = $(userbarToggle);\r\n\r\n\t\tbutton.toggleClass('userbarHide', !userbarHidden);\r\n\t\tbutton.toggleClass('userbarShow', userbarHidden);\r\n\t\tbutton.html(userbarHidden ? '&laquo;' : '&raquo;');\r\n\t}\r\n\r\n\tfunction toggleUserbarElementsDisplay(userbarHidden) {\r\n\t\tvar elements = $(userbar).children().not(userbarToggle);\r\n\r\n\t\tif (userbarHidden) {\r\n\t\t\tmodules['accountSwitcher'].closeAccountMenu();\r\n\t\t\telements.css('display', 'none');\r\n\t\t} else {\r\n\t\t\tvar inlineElements = elements.filter(function(ele) {\r\n\t\t\t\treturn ((/mail/.test(ele.className)) || (ele.id === 'openRESPrefs'));\r\n\t\t\t});\r\n\t\t\tinlineElements.css('display', 'inline');\r\n\t\t\telements.not(inlineElements).css('display', 'inline-block');\r\n\t\t}\r\n\t}\r\n\r\n\tfunction updateUserbarStateOption(userbarHidden) {\r\n\t\tRESUtils.options.setOption(moduleID, 'userbarState', userbarHidden ? 'hidden' : 'visible');\r\n\t}\r\n});\r\n"],"sourceRoot":"/source/"}